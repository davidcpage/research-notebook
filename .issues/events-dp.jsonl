{"ts":"2025-12-15T13:41:44Z","type":"created","id":"dp-001","title":"Session parser - parse Claude Code JSONL transcripts","issue_type":"task","priority":2,"description":"Parse Claude Code session JSONL files (~/.claude/projects/{project}/{session}.jsonl) into structured format for display.\n\n**Design doc:** dev/planning/features/session-card-type.md (see 'Session File Format Analysis' section)\n\n**Deliverables:**\n- parseSessionFile(jsonlContent) function\n- Handle message types: summary, user, assistant, file-history-snapshot\n- Extract metadata: session_id, timestamps, model, token counts\n- Parse tool_use and tool_result blocks within messages\n\nThis is foundational work for the session card type feature.","labels":["enhancement"]}
{"ts":"2025-12-15T13:42:00Z","type":"created","id":"dp-002","title":"Session template and layouts","issue_type":"task","priority":2,"description":"Add session template with schema and layout definitions for card/viewer display.\n\n**Design doc:** dev/planning/features/session-card-type.md (see 'Template Design' section)\n\n**Deliverables:**\n- Add 'session' to getDefaultTemplates()\n- Add .session.json extension mapping\n- Define schema: title, summary, session_id, project, started, ended, git_branch, model, total_tokens, transcript, tags\n- Card layout: summary + message count + tokens + date\n- Viewer layout: hierarchical message display shell (actual rendering in separate issue)","depends_on":["dp-001"],"labels":["enhancement"]}
{"ts":"2025-12-15T13:42:11Z","type":"created","id":"dp-003","title":"Session viewer - TUI-styled message renderer","issue_type":"task","priority":2,"description":"Render session messages with TUI aesthetic and collapsible detail levels.\n\n**Design doc:** dev/planning/features/session-card-type.md (see 'UI Design: Message Display' section)\n\n**Deliverables:**\n- renderUserMessage(msg, collapsed)\n- renderAssistantMessage(msg, collapsed)\n- renderToolCall(tool, collapsed)\n- renderToolResult(result, collapsed)\n- CSS for TUI aesthetic (dark bg, monospace, box-drawing chars)\n- Click handlers for expand/collapse\n- Three detail levels: summary view, message view, tool detail","depends_on":["dp-002"],"labels":["enhancement"]}
{"ts":"2025-12-15T13:42:20Z","type":"created","id":"dp-004","title":"Session import mechanism","issue_type":"task","priority":2,"description":"Allow importing Claude Code session files into the notebook.\n\n**Design doc:** dev/planning/features/session-card-type.md (see 'Phase 4: Import Mechanism' section)\n\n**Deliverables:**\n- 'Import Session' button (in toolbar or section menu)\n- File picker for .jsonl files\n- Parse using session parser and save as .session.json\n- Place in user-selected section\n\n**Future consideration:** Session browser modal showing available sessions from ~/.claude/projects/","depends_on":["dp-002"],"labels":["enhancement"]}
{"ts":"2025-12-15T13:42:31Z","type":"created","id":"dp-005","title":"Session cards - integrate with sessions skill summaries","issue_type":"feature","priority":3,"description":"Optionally integrate session cards with the sessions skill from https://github.com/davidcpage/skill-issues if available.\n\n**Concept:** The sessions skill stores curated summaries in .memory/sessions.jsonl with learnings, open questions, and next actions. Session cards could display these summaries as a high-level overview, with the ability to drill down into full transcript logs.\n\n**Two-tier approach:**\n- Sessions skill: curated learnings and summaries (what we learned)\n- Session cards: full conversation archives (what was said)\n\n**Implementation ideas:**\n- Detect if .memory/sessions.jsonl exists\n- Match session cards to session summaries by date/topic\n- Show summary prominently in card/viewer if available\n- Link between session summary and full transcript","depends_on":["dp-002"],"labels":["enhancement"]}
{"ts":"2025-12-15T13:43:02Z","type":"created","id":"dp-006","title":"Tag search and filtering","issue_type":"feature","priority":2,"description":"Add ability to filter cards by tag.\n\n**Design doc:** dev/planning/features/tags-future.md (see 'Search by Tag' section)\n\n**Deliverables:**\n- Filter cards by tag in search/filter UI\n- Keyboard shortcut for tag filter (e.g., `t:ongoing`)\n- Tag facets in sidebar or filter dropdown\n\n**Related future work:**\n- Tag configuration in settings (custom colors/icons)\n- Multi-tag display improvements (limit display with '+X more')","labels":["enhancement"]}
{"ts":"2025-12-15T13:43:24Z","type":"created","id":"dp-007","title":"Code file inference for repository exploration","issue_type":"feature","priority":2,"description":"Display arbitrary code files (.py, .js, .ts, etc.) as syntax-highlighted cards without requiring frontmatter.\n\n**Design doc:** dev/planning/features/code-repo-exploration.md (see 'Gaps to Fill' section)\n\n**Context:** Enables using the notebook to explore code repositories alongside Claude Code, without polluting repo source files with frontmatter.\n\n**Deliverables:**\n- Infer title from filename\n- Display content as syntax-highlighted code (read-only)\n- No frontmatter injection\n\n**Related work:**\n- Readonly sections flag (prevent accidental edits)\n- Deeper section paths (path: 'cloned-repo/src/components')","labels":["enhancement"]}
{"ts":"2025-12-15T13:43:34Z","type":"created","id":"dp-008","title":"Media library modal","issue_type":"feature","priority":3,"description":"Grid view modal for browsing and managing images in assets/ directory.\n\n**Design doc:** dev/planning/architecture/filesystem-simplification.md (see 'Phase 4: Assets as First-Class Citizens - Deferred' section)\n\n**Deliverables:**\n- Modal showing grid of images from assets/ directory\n- Drag-drop upload to add new images\n- Click to copy reference/insert into editor\n\n**Related work:**\n- 'Insert image' button in markdown editor","labels":["enhancement"]}
{"ts":"2025-12-15T14:04:36Z","type":"created","id":"dp-009","title":"Code cell split-pane scrolling bug","issue_type":"bug","priority":2,"description":"In code cells in preview mode (split-pane layout), scrolling acts on input and output panes together. If the input code is long, the output gets positioned badly in the left pane.\n\n**Expected behavior:** Output pane should probably not scroll (or scroll independently).\n\n**Current behavior:** Both panes scroll together, causing output to be displaced when input is long.\n\n**Location:** Split-pane layout CSS/JS in research_notebook.html (likely in HTML_HEAD or RENDER_FUNCTIONS sections)"}
{"ts":"2025-12-15T14:06:23Z","type":"closed","id":"dp-009","reason":"Fixed - added height: 100% to both split panes and changed left pane alignment to flex-start so output stays pinned at top"}
{"ts":"2025-12-15T14:10:57Z","type":"note","id":"dp-009","content":"Actual fix required multiple CSS changes: (1) viewer-split-pane: height: 100%, (2) viewer-split-left: overflow: hidden + align-items: flex-start, (3) viewer-content:has(.viewer-split-pane): overflow: hidden, (4) viewer-split-right: max-height: calc(90vh - 120px). Key learning: height: 100% chains don't resolve in flex contexts - viewport-based max-height is more reliable."}
{"ts":"2025-12-15T14:22:24Z","type":"created","id":"dp-010","title":"Review claude-mem repo for session card inspiration","issue_type":"task","priority":3,"description":"Review https://github.com/thedotmack/claude-mem for features that might inform our session cards work. The repo appears to have nice UI for summarising, displaying and searching past sessions. Much of it may be overkill but could provide useful ideas for: session summaries, search over past sessions, session display/UI patterns.","labels":["research","sessions"]}
{"ts":"2025-12-15T14:23:14Z","type":"updated","id":"dp-010","priority":1,"reason":"Could inform design of session cards feature - better to review before implementation"}
{"ts":"2025-12-15T14:24:27Z","type":"note","id":"dp-010","content":"Reviewed README. Key features that might inform session cards:\n\n**Relevant patterns:**\n1. **Auto-generated summaries** - Summaries created at session end via lifecycle hooks\n2. **Multi-concept tagging** - Tags like: discovery, problem-solution, pattern, decision, bugfix, feature, refactor\n3. **File reference tracking** - Links observations to specific files touched\n4. **Progressive disclosure** - Layered retrieval showing token costs for context decisions\n5. **Hybrid search** - Keyword (FTS5) + semantic (Chroma vector) search\n6. **Web viewer UI** - Real-time visualization at localhost:37777\n\n**Likely overkill for us:**\n- Lifecycle hooks intercepting every tool use\n- Full SQLite + vector DB infrastructure\n- MCP integration\n- Endless Mode (context compression)\n\n**Architecture:** TypeScript/Bun worker service on port 37777, SQLite with FTS5 for storage, Chroma for semantic search, Claude Agent SDK for extracting learnings from tool outputs."}
{"ts":"2025-12-15T14:27:25Z","type":"note","id":"dp-010","content":"UI Code Review - Key patterns:\n\n**Summary Card (SummaryCard.tsx)**\n- Structured sections: Investigated, Learned, Completed, Next Steps (each with icon)\n- Request/title at top, project badge, session ID and timestamp in footer\n- Amber/gold color scheme to distinguish from other card types\n\n**Observation Card (ObservationCard.tsx)**\n- Progressive disclosure via toggle buttons: subtitle (default) \u2192 facts (bullet list) \u2192 narrative (full text)\n- Type badge (decision, bugfix, feature, refactor, etc.)\n- Metadata: concepts as small badges, files read/modified\n- Toggle buttons in header: 'facts' and 'narrative' - only one active at a time\n\n**Feed (Feed.tsx)**\n- Simple chronological feed combining observations, summaries, prompts\n- Sorted by created_at_epoch descending\n- Infinite scroll via IntersectionObserver\n\n**Color coding by card type:**\n- Summary: amber/gold (--color-bg-summary, --color-border-summary)\n- Prompt: purple \n- Observation: blue\n\n**CSS patterns:**\n- Comprehensive CSS variable system (light + dark themes)\n- Cards expand in-place with toggles (no modal viewer)\n- Type badges: uppercase, small, colored background\n\n**Data model (types.ts):**\n- Observation: type, title, subtitle, narrative, facts (JSON array), concepts (JSON array), files_read, files_modified\n- Summary: request, investigated, learned, completed, next_steps\n- Both have: id, project, created_at_epoch"}
{"ts":"2025-12-15T14:33:50Z","type":"note","id":"dp-010","content":"Design Implications for Sessions Skill / Session Cards:\n\n**Current sessions skill structure:**\n- learnings (array) \u2713 maps to 'learned'\n- open_questions (array) - unique to our skill\n- next_actions (array) \u2713 maps to 'next_steps'\n- issues_worked (array) - could inform 'completed'\n\n**Claude-mem summary structure:**\n- investigated - what was explored\n- learned - key discoveries\n- completed - what got done\n- next_steps - follow-up items\n\n**Gap analysis:**\n1. We lack 'investigated' - what areas/files were explored\n2. We lack explicit 'completed' - issues_worked is indirect\n3. We have open_questions which they don't (valuable, keep)\n\n**Two approaches for session cards:**\n\nA) **Full transcripts** (current design doc approach)\n- Import raw Claude Code JSONL\n- Complex hierarchical viewer with expand/collapse\n- Large files, rich detail but hard to scan\n\nB) **Structured summaries** (claude-mem inspired)\n- Use sessions skill to capture structured data as we go\n- Cards display sections: Explored | Learned | Completed | Next Steps | Open Questions\n- Smaller, scannable, but loses transcript detail\n\n**Hybrid approach:**\n- Session cards store BOTH structured summary AND raw transcript\n- Card preview shows structured summary (scannable)\n- Viewer offers 'Full Transcript' tab for drill-down\n- Sessions skill evolves to capture richer structure during session\n\n**Possible sessions skill field additions:**\n- explored/investigated: files/areas touched\n- completed: tasks finished (derive from issues closed?)\n- decisions: key choices made (currently mixed into learnings)"}
{"ts":"2025-12-15T14:34:30Z","type":"closed","id":"dp-010","reason":"Done - Reviewed claude-mem repo and extracted design lessons:\n\n1. Added 'Structured Summaries' section to dev/planning/features/session-card-type.md\n2. Key pattern: Structured sections (Explored/Learned/Completed/Next Steps) instead of raw transcripts\n3. Proposed hybrid approach: structured summary for cards + optional transcript for drill-down\n4. Identified sessions skill evolution: add 'explored', 'completed', 'decisions' fields\n5. Progressive disclosure UI pattern from claude-mem (toggle buttons)\n\nReference: Issue notes contain full review findings from README and UI code analysis."}
{"ts":"2025-12-15T14:38:06Z","type":"note","id":"dp-005","content":"REVISED: This should be the PRIMARY approach for session cards, not a secondary integration.\n\nWith the hybrid approach from claude-mem review (#010):\n1. Sessions skill already captures: learnings, open_questions, next_actions, issues_worked\n2. This maps directly to card sections: Learned, Open Questions, Next Steps, Completed\n3. Only gap is 'explored' - but learnings often implicitly cover this\n\nProposed change: Make this issue the foundation, unblock from #002, and have #002 depend on THIS instead.\n\nCard structure:\n- Card preview shows structured sections from .memory/sessions.jsonl\n- Optional: link to full transcript for drill-down (via #001, #003)"}
{"ts":"2025-12-15T14:38:12Z","type":"updated","id":"dp-005","depends_on":[],"reason":"Removed blockers: 002"}
{"ts":"2025-12-15T14:40:00Z","type":"updated","id":"dp-005","priority":1,"reason":"Elevating to primary approach for session cards based on claude-mem review (#010). Structured summaries from sessions skill are the foundation, not an optional integration."}
{"ts":"2025-12-15T14:40:01Z","type":"note","id":"dp-001","content":"REVISED ROLE: Now optional for full transcript drill-down only.\n\nWith hybrid approach (#005 as primary), this parser is only needed if we want to offer 'View Full Transcript' in the session viewer. Not blocking for MVP session cards.\n\nConsider: Move to backlog (priority 4) until structured summaries are working."}
{"ts":"2025-12-15T14:40:02Z","type":"note","id":"dp-002","content":"REVISED: Should depend on #005 (sessions skill integration), not #001 (JSONL parser).\n\nNew schema should follow hybrid approach from design doc:\n- Primary: structured fields (learnings, completed, next_steps, open_questions)\n- Optional: transcript field for full drill-down\n\nSee dev/planning/features/session-card-type.md 'Alternative: Structured Summaries' section."}
{"ts":"2025-12-15T14:40:03Z","type":"note","id":"dp-003","content":"REVISED ROLE: Now optional for full transcript drill-down only.\n\nWith hybrid approach, the primary viewer shows structured sections (Learned, Completed, etc.). The TUI message renderer is only needed for optional 'Full Transcript' tab.\n\nConsider: Move to backlog (priority 4) until structured summaries are working."}
{"ts":"2025-12-15T14:40:04Z","type":"note","id":"dp-004","content":"REVISED ROLE: Optional mechanism to import historical sessions.\n\nWith hybrid approach, new sessions are captured via sessions skill automatically. This import mechanism is only needed to:\n1. Import old sessions before we had the skill\n2. Archive sessions from other projects\n\nConsider: Move to backlog (priority 4) until structured summaries are working."}
{"ts":"2025-12-15T14:41:00Z","type":"updated","id":"dp-002","depends_on":["dp-005"],"reason":"Now depends on #005 (sessions skill integration) instead of #001 (JSONL parser). Structured summaries are the foundation."}
{"ts":"2025-12-15T14:41:01Z","type":"updated","id":"dp-001","priority":4,"reason":"Moved to backlog - only needed for optional full transcript drill-down, not for MVP session cards"}
{"ts":"2025-12-15T14:41:02Z","type":"updated","id":"dp-003","priority":4,"depends_on":[],"reason":"Moved to backlog and unblocked - only needed for optional full transcript viewer, not for MVP session cards"}
{"ts":"2025-12-15T14:41:03Z","type":"updated","id":"dp-004","priority":4,"depends_on":[],"reason":"Moved to backlog and unblocked - only needed for importing historical sessions, not for MVP using sessions skill"}
{"ts":"2025-12-15T16:08:57Z","type":"created","id":"dp-011","title":"Consolidate markdown typography CSS","issue_type":"task","priority":2,"description":"The markdown content styles are duplicated between .preview-content (card previews) and .viewer-markdown (viewer modal). These share the same typography rules (h1-h6, lists, tables, code blocks, blockquotes) but are defined separately. Consolidating into shared classes could reduce CSS by ~15-20% and improve maintainability. Low risk refactor - purely cosmetic change."}
{"ts":"2025-12-15T16:14:09Z","type":"note","id":"dp-011","content":"Expanded scope: markdown typography is duplicated in THREE places, not two: .preview-content (card), .viewer-markdown (viewer), and .viewer-description (bookmark descriptions). Also identified: (1) code block styling duplicated between .preview-code and .viewer-code-only, (2) split pane layouts duplicated between preview-split-* and viewer-split-*. Suggested approach: create shared base classes (.md-content, .code-block) with context-specific overrides only where needed."}
{"ts":"2025-12-15T16:50:04Z","type":"note","id":"dp-011","content":"Expanded scope: CSS architecture refactor using cascade layers. Design doc: dev/planning/architecture/css-layers-design.md. Three phases: (1) Add layer infrastructure and inline hljs theme, (2) Organize existing CSS into layers, (3) Consolidate shared patterns like .md-content. Primary benefit: theme.css can override any style without !important."}
{"ts":"2025-12-15T16:55:28Z","type":"created","id":"dp-012","title":"CSS layers phase 1: Infrastructure","issue_type":"task","priority":2,"description":"Add @layer declarations, inline highlight.js atom-one-dark theme in vendors layer, remove CDN link for CSS (keep JS), remove !important from hljs overrides."}
{"ts":"2025-12-15T16:55:28Z","type":"created","id":"dp-013","title":"CSS layers phase 2: Organize into layers","issue_type":"task","priority":2,"description":"Wrap existing CSS in appropriate layer blocks: reset, base, components, templates. Creates clear mental model of where styles belong."}
{"ts":"2025-12-15T16:55:28Z","type":"created","id":"dp-014","title":"CSS layers phase 3: Consolidate patterns","issue_type":"task","priority":2,"description":"Create shared .md-content class for markdown typography. Update render functions to use it. Remove duplicate rules from .preview-content, .viewer-markdown, .viewer-description."}
{"ts":"2025-12-15T16:55:35Z","type":"updated","id":"dp-011","depends_on":["dp-012","dp-013","dp-014"],"reason":"Added blockers: 012, 013, 014"}
{"ts":"2025-12-15T16:55:35Z","type":"updated","id":"dp-013","depends_on":["dp-012"],"reason":"Added blockers: 012"}
{"ts":"2025-12-15T16:55:35Z","type":"updated","id":"dp-014","depends_on":["dp-013"],"reason":"Added blockers: 013"}
{"ts":"2025-12-15T17:08:03Z","type":"closed","id":"dp-012","reason":"Completed: Added @layer declarations, inlined hljs atom-one-dark theme in vendors layer, removed CDN CSS link, removed !important from hljs overrides, added padding:0 overrides for code elements."}
{"ts":"2025-12-15T17:21:21Z","type":"closed","id":"dp-013","reason":"Completed: Organized CSS into layer blocks (reset, base, components, templates). Print styles remain unlayered."}
{"ts":"2025-12-15T17:21:49Z","type":"updated","id":"dp-014","depends_on":[],"reason":"Removed blockers: 013"}
{"ts":"2025-12-15T17:37:33Z","type":"closed","id":"dp-014","reason":"Implemented shared .md-content class for markdown typography. Reduced duplicate CSS by 21 lines."}
{"ts":"2025-12-15T17:38:46Z","type":"closed","id":"dp-011","reason":"All three phases completed: (1) Layer infrastructure with inlined hljs theme, (2) CSS organized into layer blocks, (3) .md-content shared class. Net reduction of ~40 lines while improving maintainability."}
{"ts":"2025-12-15T18:46:55Z","type":"created","id":"dp-015","title":"Issue card template and layouts","issue_type":"feature","priority":2,"description":"Add issue card type to display items from .issues/events.jsonl.\n\n**Design doc:** dev/planning/features/session-card-type.md (see 'Issue Cards: Kanban Integration' section)\n\n**Deliverables:**\n- Add 'issue' template to getDefaultTemplates()\n- Parse .issues/events.jsonl into card data\n- Define schema: id, title, issue_type, priority, description, status, blocked_by, labels, notes\n- Card layout: title, description preview, priority/type badges, blocked-by links\n- Viewer layout: full description, notes timeline, blocked-by/blocking relationships\n\n**Related:** Session cards (#005) - shares JSONL parsing patterns","labels":["enhancement","skill-integration"]}
{"ts":"2025-12-15T18:47:08Z","type":"created","id":"dp-016","title":"Kanban board view for issues section","issue_type":"feature","priority":3,"description":"Add kanban board view as alternative display mode for issues.\n\n**Design doc:** dev/planning/features/session-card-type.md (see 'Kanban Board View' section)\n\n**Columns:**\n- Ready (open, not blocked)\n- In Progress (optional - could track via labels)\n- Blocked (open, has open blockers)\n- Closed\n\n**Deliverables:**\n- Kanban board component with drag-drop columns\n- Toggle button in section header: Cards / Kanban\n- Settings option for default issue display mode\n- Visual indicators for priority and issue type\n\n**Depends on:** Issue card template (#015)","depends_on":["dp-015"],"labels":["enhancement","skill-integration"]}
{"ts":"2025-12-15T18:47:08Z","type":"created","id":"dp-017","title":"Wiki links for issues and sessions","issue_type":"feature","priority":2,"description":"Extend wiki-link syntax to support cross-references between cards, issues, and sessions.\n\n**Design doc:** dev/planning/features/session-card-type.md (see 'Wiki Links' section)\n\n**Syntax:**\n- \\[\\[#005\\]\\] \u2192 Issue by ID\n- \\[\\[session:topic-name\\]\\] \u2192 Session by topic\n- \\[\\[session:2025-12-15\\]\\] \u2192 Sessions by date\n\n**Deliverables:**\n- Parse issue links in markdown content\n- Parse session links in markdown content\n- Render as badge-style clickable links\n- Show title on hover\n- Click opens viewer for linked item\n- Bidirectional link tracking (show 'Referenced by' in viewers)\n\n**Related:** Session cards (#005), Issue cards (#015)","labels":["enhancement","skill-integration"]}
{"ts":"2025-12-15T18:52:47Z","type":"note","id":"dp-005","content":"MVP implementation complete on feature/skill-integration branch:\n\n**Added:**\n- Session template with schema (learnings, open_questions, next_actions, issues_worked)\n- renderSessionPreview() - shows learnings (truncated), issue badges, section counts\n- renderViewerSession() - full display of all sections\n- Load sessions from .memory/sessions.jsonl in loadFromFilesystem()\n- getSystemSubdir() handles .memory/ path\n- CSS styles for card and viewer (TUI-inspired dark theme)\n\n**Sessions appear:** In System section under .memory/ subdirectory\n\n**Not yet implemented:**\n- Wiki links for [[#005]] issue references (tracked in #017)\n- Session editing/saving (sessions are read-only from skill)\n- Linking to full transcript drill-down (backlog items #001, #003)"}
{"ts":"2025-12-15T19:18:20Z","type":"note","id":"dp-005","content":"Implementation complete on feature/skill-integration branch but blocked on skill config question.\n\n**Issue:** research-notebook is a special case - it develops the notebook app, not a notebook of content. The dev/ folder is the natural notebook for development work, so sessions/issues should appear there (dev/.issues/, dev/.memory/) not at repo root.\n\n**Problem:** Skills use symlinked directories, so we can't shadow with local config.yaml inside the skill folder. Putting config outside the skill folder feels hacky and breaks self-containment.\n\n**Options explored:**\n1. Environment variable - unclear when/how it gets set\n2. Config file next to symlink (outside skill dir) - breaks self-containment\n3. Command-line args with CLAUDE.md coordination - error-prone\n4. Copy skill instead of symlink - loses auto-updates\n\n**Decision:** Needs more thought. Parking this to discuss skill configuration patterns."}
{"ts":"2025-12-15T20:20:41Z","type":"created","id":"dp-018","title":"Notebook root auto-discovery","issue_type":"feature","priority":2,"description":"Auto-detect .notebook/ in subdirectories when opening parent. See dev/planning/features/repo-dev-companion.md"}
{"ts":"2025-12-15T20:20:53Z","type":"note","id":"dp-018","content":"Problem: File System Access API grants permissions per directory tree. Opening subdirectory (dev/) doesn't grant access to parent resources (.memory/, .issues/).\n\nSolution: Open parent for permissions, auto-detect subdirectories with .notebook/, prompt user to select which notebook to open.\n\nBonus: Enables switching between multiple notebooks in a monorepo.\n\nUnblocks: Session cards (#005) working in dev notebook scenario.\n\nDesign doc: dev/planning/features/repo-dev-companion.md (Option A)"}
{"ts":"2025-12-15T20:20:59Z","type":"note","id":"dp-005","content":"Created issue #018 (Notebook root auto-discovery) to address the permission scope limitation blocking session cards in dev notebook. This is the clean architectural fix rather than a workaround."}
{"ts":"2025-12-16T10:31:48Z","type":"closed","id":"dp-001","reason":"Abandoned: Sessions are process logs, not notebook artifacts. Decision recorded in repo-dev-companion.md"}
{"ts":"2025-12-16T10:31:48Z","type":"closed","id":"dp-002","reason":"Abandoned: Sessions are process logs, not notebook artifacts. Decision recorded in repo-dev-companion.md"}
{"ts":"2025-12-16T10:31:48Z","type":"closed","id":"dp-003","reason":"Abandoned: Sessions are process logs, not notebook artifacts. Decision recorded in repo-dev-companion.md"}
{"ts":"2025-12-16T10:31:48Z","type":"closed","id":"dp-004","reason":"Abandoned: Sessions are process logs, not notebook artifacts. Decision recorded in repo-dev-companion.md"}
{"ts":"2025-12-16T10:31:48Z","type":"closed","id":"dp-005","reason":"Abandoned: Sessions are process logs, not notebook artifacts. Notebook is for lasting artifacts (notes, design docs), not transient process tracking. TUI may be better tool for sessions/issues. Decision recorded in repo-dev-companion.md"}
{"ts":"2025-12-16T10:31:55Z","type":"closed","id":"dp-015","reason":"Abandoned: Issues are process logs, not notebook artifacts. Decision recorded in repo-dev-companion.md"}
{"ts":"2025-12-16T10:31:55Z","type":"closed","id":"dp-016","reason":"Abandoned: Kanban view depended on issue cards (#015), which are no longer planned"}
{"ts":"2025-12-16T10:31:55Z","type":"closed","id":"dp-017","reason":"Abandoned: Wiki links for issues/sessions no longer needed as skill cards are not being implemented"}
{"ts":"2025-12-16T10:31:56Z","type":"closed","id":"dp-018","reason":"Abandoned: Permission scope auto-discovery was needed for skill card integration, which is no longer planned"}
{"ts":"2025-12-26T11:30:00Z","type":"created","id":"dp-019","title":"Multi-file architecture: Directory structure","issue_type":"task","priority":1,"description":"Create directory structure for multi-file architecture and convert themes to ES modules.\n\n**ADR:** dev/planning/architecture/multi-file-architecture.md\n\n**Deliverables:**\n- Create directory structure: css/, js/, defaults/, defaults/templates/\n- Convert themes/*.css to themes/*.js (export CSS as default string)\n- Create themes/index.js registry listing available themes\n- Verify ES module imports work with file:// protocol\n\n**Branch:** refactor/multi-file-architecture","labels":["architecture","refactor"]}
{"ts":"2025-12-26T11:30:01Z","type":"created","id":"dp-020","title":"Multi-file architecture: Extract CSS","issue_type":"task","priority":1,"description":"Extract all CSS from research_notebook.html to css/app.css.\n\n**ADR:** dev/planning/architecture/multi-file-architecture.md (Phase 2)\n\n**Deliverables:**\n- Create css/app.css with all styles from HTML_HEAD section\n- Create index.html with link to stylesheet\n- Verify all styling works correctly\n- Keep @layer structure intact\n\n**Branch:** refactor/multi-file-architecture","depends_on":["dp-019"],"labels":["architecture","refactor"]}
{"ts":"2025-12-26T11:30:02Z","type":"created","id":"dp-021","title":"Multi-file architecture: Extract JavaScript","issue_type":"task","priority":1,"description":"Extract JavaScript from research_notebook.html to ES modules in js/.\n\n**ADR:** dev/planning/architecture/multi-file-architecture.md (Phase 3)\n\n**Deliverables:**\n- Create js/app.js as entry point\n- Extract sections to modules: state.js, render.js, editor.js, filesystem.js, templates.js, pyodide.js, codemirror.js\n- Convert to ES module exports/imports\n- Maintain single source of truth for state\n- Update index.html with script type=\"module\"\n\n**Note:** This is the largest phase. May need to be broken into sub-tasks.\n\n**Branch:** refactor/multi-file-architecture","depends_on":["dp-020"],"labels":["architecture","refactor"]}
{"ts":"2025-12-26T11:30:03Z","type":"created","id":"dp-022","title":"Multi-file architecture: Defaults as ES modules","issue_type":"task","priority":1,"description":"Convert embedded defaults (templates, theme, CLAUDE.md, README.md) to ES modules.\n\n**ADR:** dev/planning/architecture/multi-file-architecture.md (Phase 4)\n\n**Deliverables:**\n- Create defaults/templates/note.js, code.js, bookmark.js (export YAML strings)\n- Create defaults/theme.js (export default CSS)\n- Create defaults/claude-md.js and readme.js\n- Update app to import defaults instead of using inline strings\n- Implement lazy/copy-on-write: defaults load from app, write to notebook on edit\n\n**Branch:** refactor/multi-file-architecture","depends_on":["dp-021"],"labels":["architecture","refactor"]}
{"ts":"2025-12-26T11:30:04Z","type":"created","id":"dp-023","title":"Multi-file architecture: Theme picker UI","issue_type":"feature","priority":2,"description":"Add theme picker to settings for browsing and applying themes.\n\n**ADR:** dev/planning/architecture/multi-file-architecture.md (Phase 5)\n\n**Deliverables:**\n- Add 'Theme' section to settings modal\n- List available themes from themes/index.js registry\n- Show theme name and description\n- Preview button (optional: live preview without saving)\n- Apply button writes selected theme to notebook's .notebook/theme.css\n- Current theme indicator\n\n**Branch:** refactor/multi-file-architecture","depends_on":["dp-022"],"labels":["enhancement","themes"]}
{"ts":"2025-12-26T11:30:05Z","type":"created","id":"dp-024","title":"Multi-file architecture: Cleanup and documentation","issue_type":"task","priority":2,"description":"Final cleanup after multi-file migration.\n\n**ADR:** dev/planning/architecture/multi-file-architecture.md (Phase 6)\n\n**Deliverables:**\n- Remove old research_notebook.html (or keep as legacy reference)\n- Update CLAUDE.md for new structure (navigation, section markers no longer needed)\n- Update README.md with new usage instructions\n- Evaluate generate_index.py - update or remove\n- Update example notebooks if needed\n- Merge to main\n\n**Branch:** refactor/multi-file-architecture","depends_on":["dp-023"],"labels":["documentation","refactor"]}
{"ts":"2025-12-26T11:30:06Z","type":"created","id":"dp-025","title":"Decision: CLAUDE.md initialization for notebooks","issue_type":"task","priority":2,"description":"Decide how notebooks get CLAUDE.md for Claude Code integration.\n\n**ADR:** dev/planning/architecture/multi-file-architecture.md (Open Question 1)\n\n**Options:**\na. CLI initializer: python scripts/init_notebook.py /path/to/notebook\nb. App button: 'Initialize for Claude Code' in toolbar/settings\nc. Documentation only: 'Copy defaults/CLAUDE.md to your notebook'\nd. Auto-create on first save: ensure CLAUDE.md exists when any card is saved\n\n**Considerations:**\n- Claude Code needs CLAUDE.md in notebook directory to work\n- Users may not realize this requirement\n- Option (b) provides discoverability\n- Option (d) is most seamless but may create files unexpectedly\n\n**Outcome:** Document decision in ADR","labels":["decision","architecture"]}
{"ts":"2025-12-26T14:16:22Z","type":"note","id":"dp-025","content":"DECIDED: Use example notebooks as templates. See ADR multi-file-architecture.md Open Question #1. Different use cases (research, tutor, dev) get tailored CLAUDE.md, theme, and README. Card templates only included if customized from defaults."}
{"ts":"2025-12-26T14:16:28Z","type":"closed","id":"dp-025","reason":"Decided: example notebooks as templates. Creating implementation issue."}
{"ts":"2025-12-26T14:18:02Z","type":"created","id":"dp-026","title":"Create example notebook templates","issue_type":"task","priority":2,"description":"Create example notebooks for different use cases, each with tailored CLAUDE.md, theme, and README.\n\n**ADR:** dev/planning/architecture/multi-file-architecture.md (Open Question #1 - DECIDED)\n\n**Deliverables:**\n\n1. **research-notebook/** - Standard research use\n   - CLAUDE.md with research-focused instructions\n   - theme.css pointing to manuscript theme\n   - README.md explaining the template\n\n2. **tutor-notebook/** - AI tutoring collaboration\n   - CLAUDE.md with student collaboration guidelines\n   - theme.css with accessible, friendly theme\n   - README.md explaining the use case\n\n3. **dev-notebook/** - Development/coding focus\n   - CLAUDE.md with code-focused instructions\n   - theme.css pointing to terminal theme\n   - README.md explaining the template\n\n4. **Optional: scripts/new-notebook.py** - CLI helper to list and copy examples\n\n**Principle:** Only include .notebook/templates/*.yaml if genuinely customized for that use case. Standard types inherit from app defaults via lazy/copy-on-write.\n\n**Note:** Existing demo-notebook can be kept or refactored into one of these.","labels":["architecture","examples"]}
{"ts":"2025-12-26T14:18:08Z","type":"updated","id":"dp-026","depends_on":["dp-022"],"reason":"Added dependencies: dp-022"}
{"ts":"2025-12-26T14:21:13Z","type":"note","id":"dp-022","content":"Updated: Remove defaults/claude-md.js and defaults/readme.js from deliverables. These files now live only in example notebooks (see dp-026). defaults/ only contains templates/*.js and theme.js."}
{"ts":"2025-12-26T14:21:13Z","type":"updated","id":"dp-024","depends_on":["dp-023","dp-026"],"reason":"Added dependencies: dp-026"}
{"ts":"2025-12-26T14:28:27Z","type":"note","id":"dp-019","content":"Completed all deliverables:\n- Created directory structure: css/, js/, defaults/, defaults/templates/\n- Converted 4 themes (manuscript, minimal, terminal, handwritten) to ES modules\n- Created themes/index.js registry with loadTheme() and getThemeCSS() helpers\n- Created test-es-modules.html for browser verification\n- Updated themes/README.md with ES module documentation\n\nNode.js testing confirms modules work correctly. Browser testing with file:// protocol should be done manually by opening test-es-modules.html in Chrome/Edge."}
{"ts":"2025-12-26T14:28:35Z","type":"closed","id":"dp-019","reason":"Done - Created multi-file architecture directory structure and converted themes to ES modules. See test-es-modules.html for browser verification."}
{"ts":"2025-12-26T14:34:27Z","type":"note","id":"dp-020","content":"Completed extraction:\n- Created css/app.css with all 2266 lines of CSS\n- Created index.html (6752 lines) linking to css/app.css\n- @layer structure preserved: reset, vendors, base, components, templates, theme\n- Print styles remain unlayered (as intended for proper precedence)\n\nFiles:\n- index.html: 306KB (replaces inline styles with <link> tag)\n- css/app.css: 49KB (extracted CSS)\n- research_notebook.html: 371KB (original, kept for reference during migration)\n\nNeeds manual verification: open index.html in browser to confirm styling works."}
{"ts":"2025-12-26T14:38:44Z","type":"closed","id":"dp-020","reason":"Done - Extracted CSS to css/app.css, created index.html with stylesheet link. Styling verified working."}
{"ts":"2025-12-26T14:59:24Z","type":"note","id":"dp-021","content":"Phase 3 extraction complete: JS extracted to js/app.js (246KB). index.html now 210 lines. Follow-up needed: split app.js into ES modules (state.js, templates.js, etc.)"}
{"ts":"2025-12-26T14:59:36Z","type":"created","id":"dp-027","title":"Multi-file architecture: Split app.js into ES modules","issue_type":"task","priority":2,"description":"Split js/app.js (~6500 lines) into ES modules:\n\n- state.js: Global state variables\n- utilities.js: Helper functions (escapeHtml, formatDate, etc.)\n- templates.js: TEMPLATE_SYSTEM section (~2200 lines)\n- filesystem.js: FILESYSTEM_STORAGE + DATA_PERSISTENCE (~1500 lines)\n- editor.js: GENERIC_EDITOR section (~1350 lines)\n- pyodide.js: PYODIDE_RUNTIME section\n- render.js: RENDER_FUNCTIONS section\n- links.js: INTERNAL_LINKING section\n- thumbnails.js: THUMBNAIL_GENERATION section\n- modals.js: UI modals and small sections\n\nKey challenges:\n- Circular dependencies between templates/filesystem/editor\n- HTML onclick handlers need functions on window object\n- Use late-binding pattern for cross-module deps\n\n**Branch:** refactor/multi-file-architecture","depends_on":["dp-021"],"labels":["architecture","refactor"]}
{"ts":"2025-12-26T15:01:15Z","type":"closed","id":"dp-021","reason":"JS extracted to js/app.js. ES module splitting tracked in dp-027."}
{"ts":"2025-12-26T15:01:54Z","type":"note","id":"dp-027","content":"Learnings from attempted all-in-one refactor:\n\n1. **Circular deps are real**: templates.js \u2194 filesystem.js \u2194 editor.js all call each other\n2. **State vars need setters**: 'let' vars (data, pyodide, etc.) can't be reassigned from other modules - need 'setData()' pattern\n3. **HTML onclick handlers**: Functions like openEditor(), closeViewer() must be exposed on window object\n4. **Late binding pattern**: Import modules at top, but only call cross-module functions inside other functions (not at load time)\n5. **Consider app.js as coordinator**: Import all modules, wire up cross-deps via registration functions, expose onclick handlers on window"}
{"ts":"2025-12-26T15:10:55Z","type":"note","id":"dp-027","content":"Extracted 2 modules: utilities.js (61 lines) and pyodide.js (239 lines). App now uses ES module loading. Internal-linking extraction deferred due to data/viewer dependencies."}
{"ts":"2025-12-26T15:14:06Z","type":"note","id":"dp-027","content":"Fixed: Using regular script loading instead of ES modules for file:// protocol compatibility. Scripts load in order: utilities.js \u2192 pyodide.js \u2192 app.js"}
{"ts":"2025-12-26T15:17:18Z","type":"closed","id":"dp-027","reason":"Abandoned: ES modules require server (incompatible with file:// protocol). Regular script splitting provides no real encapsulation benefit. Single app.js with section markers + generate_index.py is cleaner for this use case."}
{"ts":"2025-12-26T16:26:17Z","type":"closed","id":"dp-022","reason":"Abandoned: ES modules rejected - requires server (incompatible with file:// protocol design goal). Templates/themes can be embedded in js/app.js or loaded differently in the future. See ADR multi-file-architecture.md for full rationale."}
{"ts":"2025-12-26T16:26:24Z","type":"updated","id":"dp-026","depends_on":[],"reason":"Removed dependencies: dp-022"}
{"ts":"2025-12-26T16:26:30Z","type":"updated","id":"dp-023","depends_on":[],"reason":"Removed dependencies: dp-022"}
{"ts":"2025-12-26T16:26:37Z","type":"note","id":"dp-024","content":"Partial completion: research_notebook.html and test-es-modules.html removed. CLAUDE.md and README.md updated for multi-file structure. generate_index.py updated to point at js/app.js. Remaining: merge to main after example notebooks (dp-026) complete."}
{"ts":"2025-12-26T16:29:02Z","type":"note","id":"dp-026","content":"Created 3 example notebooks: research-notebook (manuscript theme), dev-notebook (terminal theme), tutor-notebook (friendly theme). Each has CLAUDE.md, README.md, .notebook/settings.yaml, and .notebook/theme.css. Kept existing demo-notebook as full-featured reference."}
{"ts":"2025-12-26T16:29:07Z","type":"closed","id":"dp-026","reason":"Completed: Created research-notebook, dev-notebook, and tutor-notebook examples. Each has tailored CLAUDE.md, theme.css, README.md, and settings.yaml. Demo-notebook kept as full-featured reference."}
{"ts":"2025-12-26T16:38:59Z","type":"created","id":"dp-028","title":"Remove auto-creation of default Research section","issue_type":"bug","priority":2,"description":"When opening an empty notebook folder, the app automatically creates a 'Research' section (js/app.js:5151-5159). This is unwanted - users should start with an empty notebook and add their first section via the Add Section button.\n\n**Current behavior:**\n- New notebook auto-creates 'Research' section directory\n- settings.yaml includes this section\n\n**Desired behavior:**\n- New notebook starts empty (no sections)\n- User clicks Add Section to create their first section\n- settings.yaml has empty sections array\n\n**Location:** `linkFilesystem()` function around line 5150 in js/app.js\n\n**Note:** Also update `getDefaultSettingsContent()` (line 673) to default to empty sections array."}
{"ts":"2025-12-26T16:39:44Z","type":"closed","id":"dp-028","reason":"Fixed: Removed auto-creation of Research section. New notebooks now start empty. Updated linkFilesystem() and SETTINGS_SCHEMA defaults."}
{"ts":"2025-12-26T16:45:37Z","type":"updated","id":"dp-024","depends_on":["dp-026"],"reason":"Removed dependencies: dp-023"}
{"ts":"2025-12-26T16:45:42Z","type":"updated","id":"dp-024","depends_on":[],"reason":"Removed dependencies: dp-026"}
{"ts":"2025-12-26T16:45:50Z","type":"closed","id":"dp-024","reason":"Completed: Removed old HTML files, updated CLAUDE.md and README.md for multi-file structure, updated generate_index.py for js/app.js, created 3 example notebooks. Theme picker (dp-023) is a separate future feature. Ready for merge to main."}
{"ts":"2025-12-26T17:18:56Z","type":"created","id":"dp-029","title":"Create package.json and Node.js CLI server","issue_type":"task","priority":1,"description":"Foundation for server-based architecture. Create package.json with bin entry for 'notebook' command, and cli.js that serves static files and auto-opens browser. See dev/planning/architecture/multi-file-architecture.md for details.","labels":["architecture"]}
{"ts":"2025-12-26T17:19:05Z","type":"created","id":"dp-030","title":"Convert themes/*.js to real CSS files","issue_type":"task","priority":2,"description":"Extract CSS from themes/manuscript.js, minimal.js, terminal.js, handwritten.js into real .css files. Create themes/index.json registry with id, name, description for each theme. Delete the .js theme files after extraction.","depends_on":["dp-029"],"labels":["themes"]}
{"ts":"2025-12-26T17:19:14Z","type":"created","id":"dp-031","title":"Extract templates from app.js to YAML files","issue_type":"task","priority":2,"description":"Extract templates from getDefaultTemplates() in app.js to defaults/templates/*.yaml (note.yaml, code.yaml, bookmark.yaml, image.yaml, theme.yaml, settings.yaml). Remove getDefaultTemplates() function and embedded strings after extraction.","depends_on":["dp-029"],"labels":["templates"]}
{"ts":"2025-12-26T17:19:24Z","type":"created","id":"dp-032","title":"Update app.js to fetch templates and themes dynamically","issue_type":"task","priority":1,"description":"Modify app.js to load templates via fetch('/defaults/templates/*.yaml') instead of embedded strings. Load theme registry via fetch('/themes/index.json'). Update loadThemeCss() to support loading from /themes/ directory. Remove getDefaultThemeContent() embedded strings.","depends_on":["dp-030","dp-031"],"labels":["architecture"]}
{"ts":"2025-12-26T17:19:34Z","type":"created","id":"dp-033","title":"Add file:// protocol detection with friendly error","issue_type":"task","priority":2,"description":"Detect window.location.protocol === 'file:' on app startup. Show friendly error message with install instructions (npm link, notebook command) instead of broken app. Hide main UI, show only error message.","depends_on":["dp-029"],"labels":["ux"]}
{"ts":"2025-12-26T17:19:44Z","type":"created","id":"dp-034","title":"Add theme picker UI to settings modal","issue_type":"feature","priority":2,"description":"Add 'Theme' section to settings modal with dropdown listing themes from /themes/index.json. On selection: fetch theme CSS, write to .notebook/theme.css, reload. Include 'Custom' option that preserves existing theme. Consider live preview before applying.","depends_on":["dp-032"],"labels":["themes","ux"]}
{"ts":"2025-12-26T17:19:52Z","type":"created","id":"dp-035","title":"Clean up orphaned files and embedded strings","issue_type":"task","priority":3,"description":"After migration: delete themes/*.js files, delete themes/index.js, remove getDefaultTemplates() and getDefaultThemeContent() from app.js, delete defaults/templates/.gitkeep, update .gitignore if needed.","depends_on":["dp-032"],"labels":["cleanup"]}
{"ts":"2025-12-26T17:20:01Z","type":"created","id":"dp-036","title":"Update documentation for server-based workflow","issue_type":"task","priority":2,"description":"Update README.md with new install/run instructions (npm link, notebook command). Update CLAUDE.md architecture section. Update themes/README.md to remove ES module claims. Consider renaming repo or clarifying that 'notebook' is the CLI name.","depends_on":["dp-032"],"labels":["documentation"]}
{"ts":"2025-12-26T17:20:10Z","type":"created","id":"dp-037","title":"Create example notebooks for different use cases","issue_type":"task","priority":3,"description":"Create examples/research-notebook/, examples/tutor-notebook/, examples/dev-notebook/ with appropriate CLAUDE.md, README.md, and theme for each use case. Decide fate of existing demo-notebook. Workflow: cp -r examples/research-notebook my-project","depends_on":["dp-034"],"labels":["examples"]}
{"ts":"2025-12-26T17:20:28Z","type":"closed","id":"dp-023","reason":"Superseded by dp-034 which is part of the new server-based architecture plan"}
{"ts":"2025-12-26T17:21:19Z","type":"note","id":"dp-029","content":"Starting implementation"}
{"ts":"2025-12-26T17:23:25Z","type":"closed","id":"dp-029","reason":"Done - package.json and cli.js created. Server serves static files correctly, npm link works, 'notebook' command available globally."}
{"ts":"2025-12-26T17:31:46Z","type":"closed","id":"dp-030","reason":"Converted all 4 themes from JS modules to real CSS files. Created index.json registry."}
{"ts":"2025-12-26T17:34:06Z","type":"closed","id":"dp-031","reason":"Extracted all 7 templates to defaults/templates/*.yaml files (note, code, bookmark, settings, template, theme, image). Also extracted default theme.css. Function removal deferred to dp-032 when dynamic fetching is implemented."}
{"ts":"2025-12-26T17:45:12Z","type":"closed","id":"dp-032","reason":"Implemented dynamic fetching from server. Templates load from /defaults/templates/, theme registry from /themes/index.json. Removed CLAUDE.md and README.md from modified indicator (user provides manually). Replaced embedded template/theme strings with fetch-cached versions."}
{"ts":"2025-12-26T17:58:45Z","type":"closed","id":"dp-035","reason":"All cleanup complete: themes/*.js and index.js were already removed (replaced with .css and index.json). getDefaultTemplates() and getDefaultThemeContent() are now cache wrappers for server-fetched content (no embedded strings). Removed redundant defaults/templates/.gitkeep."}
{"ts":"2025-12-26T17:59:36Z","type":"closed","id":"dp-037","reason":"Duplicate of dp-026 which was completed earlier. All example notebooks (research-notebook, dev-notebook, tutor-notebook) already exist with tailored CLAUDE.md, README.md, theme.css, and settings.yaml."}
{"ts":"2025-12-26T18:01:00Z","type":"closed","id":"dp-033","reason":"Added file:// protocol detection at app startup. Shows friendly error message with install instructions (npm link, notebook command) and hides main UI."}
{"ts":"2025-12-26T18:05:25Z","type":"closed","id":"dp-034","reason":"Implemented theme picker with base theme + customizations architecture:\n- Added 'theme' field type to editor that renders dropdown populated from /themes/index.json\n- Updated settings template to use new 'theme' type with 'Base Theme' label\n- Modified loadThemeCss() to load base theme from /themes/{id}.css first, then layer .notebook/theme.css customizations on top\n- Theme reloads automatically when settings are saved"}
{"ts":"2025-12-26T18:26:55Z","type":"closed","id":"dp-036","reason":"Documentation updated: CLAUDE.md has new architecture/server sections, themes/README.md updated with theme picker instructions and friendly theme. README.md already had correct npm link/notebook instructions."}
{"ts":"2025-12-26T18:55:01Z","type":"created","id":"dp-038","title":"Quiz template definition","issue_type":"feature","priority":2,"description":"Create defaults/templates/quiz.yaml with schema for quiz cards including: title, author, topic, questions array, attempts array. Define card/viewer layout as 'quiz', set extension mapping for .quiz.json","labels":["ai-tutor","phase-1"]}
{"ts":"2025-12-26T18:55:14Z","type":"created","id":"dp-039","title":"Quiz card preview rendering","issue_type":"feature","priority":2,"description":"Implement renderQuizPreview() function. Show quiz title, question count, and progress indicator if attempts exist (e.g., '2/5 correct, 1 pending review'). Visual indicator for quiz state: not started, in progress, completed.","depends_on":["dp-038"],"labels":["ai-tutor","phase-1"]}
{"ts":"2025-12-26T18:55:14Z","type":"created","id":"dp-040","title":"Quiz viewer rendering (read-only)","issue_type":"feature","priority":2,"description":"Implement renderQuizViewer() for displaying quiz questions. Initially read-only - show all question types (multiple_choice, numeric, short_answer, worked, matching, ordering) with their content, hints, and explanations.","depends_on":["dp-038"],"labels":["ai-tutor","phase-1"]}
{"ts":"2025-12-26T18:55:14Z","type":"created","id":"dp-041","title":"Quiz CSS styling","issue_type":"feature","priority":2,"description":"Add CSS styles for quiz components: .quiz-question, .quiz-options, .quiz-option (selected/correct/incorrect states), .quiz-numeric-input, .quiz-short-answer, .quiz-worked-step, .quiz-hint, .quiz-explanation, .quiz-progress, .quiz-submit","depends_on":["dp-038"],"labels":["ai-tutor","phase-1"]}
{"ts":"2025-12-26T18:55:32Z","type":"created","id":"dp-042","title":"Quiz-taking interactive UI","issue_type":"feature","priority":2,"description":"Add interactive quiz-taking mode in viewer. Input controls per question type: radio buttons (multiple_choice), number input (numeric), textarea (short_answer, worked steps), drag-drop/dropdowns (matching, ordering). Hints revealed on request. Submit button.","depends_on":["dp-040","dp-041"],"labels":["ai-tutor","phase-2"]}
{"ts":"2025-12-26T18:55:32Z","type":"created","id":"dp-043","title":"Quiz auto-grading logic","issue_type":"feature","priority":2,"description":"Implement gradeQuizAttempt(quiz, answers) function. Auto-grade: multiple_choice (compare to correct index), numeric (check within tolerance), matching (compare pairs), ordering (compare order). Mark short_answer and worked as pending_review.","depends_on":["dp-042"],"labels":["ai-tutor","phase-2"]}
{"ts":"2025-12-26T18:55:32Z","type":"created","id":"dp-044","title":"Quiz attempt storage","issue_type":"feature","priority":2,"description":"Implement saveQuizAttempt(card, answers). Store attempts array in quiz file with: timestamp, answers (with questionIndex, answer, correct/reviewed status), score (auto count, pending_review count), review field for Claude feedback.","depends_on":["dp-043"],"labels":["ai-tutor","phase-2"]}
{"ts":"2025-12-26T18:55:32Z","type":"created","id":"dp-045","title":"Quiz review mode UI","issue_type":"feature","priority":2,"description":"After submission, show review mode: answers with correct/incorrect indicators, explanations displayed, 'Awaiting Claude review' badge for pending questions. History mode for viewing past attempts with scores.","depends_on":["dp-044"],"labels":["ai-tutor","phase-2"]}
{"ts":"2025-12-26T18:55:44Z","type":"created","id":"dp-046","title":"Tutor notebook CLAUDE.md","issue_type":"feature","priority":2,"description":"Update examples/tutor-notebook/CLAUDE.md with comprehensive tutoring instructions: role definition, tutoring principles, content creation guidelines, quiz workflow (create/review), file organization, common request handling table, session flow.","labels":["ai-tutor","docs"]}
{"ts":"2025-12-26T18:55:44Z","type":"created","id":"dp-047","title":"Tutor notebook README.md","issue_type":"feature","priority":2,"description":"Update examples/tutor-notebook/README.md with user-facing documentation: how it works (Claude terminal + browser app), getting started steps, suggested subjects structure, learning tips.","labels":["ai-tutor","docs"]}
{"ts":"2025-12-26T18:55:44Z","type":"created","id":"dp-048","title":"End-to-end quiz workflow testing","issue_type":"task","priority":2,"description":"Test complete workflow: Claude creates quiz file \u2192 student opens in browser \u2192 takes quiz \u2192 submits \u2192 auto-graded questions scored \u2192 pending review questions marked \u2192 Claude reviews answers \u2192 provides feedback. Document any issues found.","depends_on":["dp-045","dp-046"],"labels":["ai-tutor","phase-3"]}
{"ts":"2025-12-26T18:55:54Z","type":"created","id":"dp-049","title":"Quiz theme integration","issue_type":"feature","priority":3,"description":"Add quiz-specific CSS variables to theme system (--quiz-correct-bg, --quiz-incorrect-bg, --quiz-pending-bg, etc.). Ensure quiz styling works well with all base themes (manuscript, minimal, terminal, friendly, handwritten).","depends_on":["dp-041"],"labels":["ai-tutor","phase-4"]}
{"ts":"2025-12-26T18:55:54Z","type":"created","id":"dp-050","title":"Quiz progress tracking","issue_type":"feature","priority":3,"description":"Enhanced progress tracking: aggregate quiz stats across notebook, show mastery by topic, identify areas needing reinforcement. Optional progress/ section for session logs and analytics.","depends_on":["dp-044"],"labels":["ai-tutor","phase-4"]}
{"ts":"2025-12-26T19:01:24Z","type":"closed","id":"dp-038","reason":"Implemented quiz template with full schema for 6 question types"}
{"ts":"2025-12-26T19:05:57Z","type":"closed","id":"dp-039","reason":"Implemented renderQuizPreview with progress indicators"}
{"ts":"2025-12-26T19:05:57Z","type":"closed","id":"dp-040","reason":"Implemented renderQuizViewer with all 6 question type renderers"}
{"ts":"2025-12-26T19:05:58Z","type":"closed","id":"dp-041","reason":"Added comprehensive CSS for quiz cards and viewer"}
{"ts":"2025-12-26T19:12:59Z","type":"note","id":"dp-042","content":"Design change: Make viewer interactive for quiz-taking rather than separate mode. Viewer shows Take Quiz mode by default, switches to Review Results after submission."}
{"ts":"2025-12-26T19:25:19Z","type":"closed","id":"dp-042","reason":"Implemented interactive quiz-taking UI with input controls for all 6 question types"}
{"ts":"2025-12-26T19:25:25Z","type":"closed","id":"dp-043","reason":"Implemented gradeQuizAttempt() with auto-grading for multiple_choice, numeric, matching, ordering; pending_review for short_answer, worked"}
{"ts":"2025-12-26T19:25:29Z","type":"closed","id":"dp-044","reason":"Implemented saveQuizAttempt() that persists attempts to card and re-renders viewer"}
{"ts":"2025-12-26T19:25:34Z","type":"closed","id":"dp-045","reason":"Review mode implemented: viewer shows results after submission with Retake button, correct/incorrect indicators, and explanations"}
{"ts":"2025-12-26T19:36:58Z","type":"created","id":"dp-051","title":"Retake Quiz button UX issues","issue_type":"bug","priority":2,"description":"Retake Quiz button doesn't update the viewer immediately. Current behavior: clicking Retake appears to do nothing, but closing and reopening the viewer shows the quiz reset to interactive mode.\n\nRoot cause investigation:\n- Fixed selector from '.viewer-body' to '#viewerContent' \n- But getTemplateForCard() function doesn't exist - need to use templateRegistry[card.template || card.type]\n- Even after fix, the re-render may not be working as expected\n\nExpected behavior: Clicking Retake should immediately show the interactive quiz UI without needing to close/reopen the modal.","labels":["ai-tutor","phase-2"]}
{"ts":"2025-12-26T20:19:37Z","type":"closed","id":"dp-051","reason":"Fixed: replaced getTemplateForCard() with templateRegistry[card.template || card.type] in both retakeQuiz and saveQuizAttempt"}
{"ts":"2025-12-26T20:56:45Z","type":"closed","id":"dp-048","reason":"Successfully tested end-to-end: quiz submission, auto-grading, pending review, Claude file edit for review, filesystem observer auto-refresh of viewer"}
{"ts":"2025-12-26T21:00:03Z","type":"created","id":"dp-052","title":"Optional self-review restriction for quiz answers","issue_type":"feature","priority":2,"description":"Add setting to control who can review pending quiz answers in the UI.\n\n**Use case:** In tutoring scenarios, students shouldn't self-mark - only the tutor (Claude or teacher) should review.\n\n**Proposed approach:**\n- Add `quiz_self_review: true|false` setting in .notebook/settings.yaml (default: true)\n- When false, pending_review questions show 'Awaiting review' instead of Mark Correct/Incorrect buttons\n- Claude can always review by editing the file directly (bypasses UI restriction)\n- Teachers could toggle this setting when they want to allow self-review\n\n**Alternative:** Role-based approach with `role: student|teacher` in settings, but this may be over-engineering for the current use case.\n\n**UI when self-review disabled:**\n- Show explanation (if available)\n- Show 'Awaiting review' badge where buttons would be\n- Review feedback still displays once Claude/teacher adds it","labels":["ai-tutor","phase-4"]}
{"ts":"2025-12-26T21:02:21Z","type":"closed","id":"dp-052","reason":"Implemented quiz_self_review setting - when false, shows 'Awaiting review' instead of Mark buttons"}
{"ts":"2025-12-26T21:09:27Z","type":"closed","id":"dp-046","reason":"Comprehensive CLAUDE.md written with: role definition, tutoring principles, quiz system docs (creating/reviewing), question types table, content creation examples, common requests table, session flow, and tips."}
{"ts":"2025-12-26T21:09:28Z","type":"closed","id":"dp-047","reason":"README.md written with: how it works explanation, getting started steps, what you can do examples, organizing learning, quiz types table, and learning tips."}
{"ts":"2025-12-27T17:01:14Z","type":"created","id":"dp-053","title":"quiz-response template and card type","issue_type":"feature","priority":2,"description":"Define the quiz-response template for storing student submissions with grade hierarchy.\n\nSchema fields:\n- studentId (string, e.g., 's001')\n- quizId (reference to quiz card)\n- responseId (Google Forms response ID for export)\n- submittedAt (ISO timestamp)\n- answers[] with questionIndex, answer, autoGrade, claudeGrade, teacherGrade\n- totalScore, maxScore\n- exportedToForms, exportedAt\n\nGrade hierarchy:\n1. autoGrade - computed on import for objective questions (immutable)\n2. claudeGrade - AI-generated suggestion (score, feedback, gradedAt)\n3. teacherGrade - final authority (score, feedback, reviewedAt, reviewer)\n\nTemplate config:\n- card.layout and viewer.layout for displaying responses\n- editor.fields for teacher grade editing\n- Status indicators: pending review, reviewed, exported\n\nLocation: .notebook/templates/quiz-response.yaml (or in getDefaultTemplates())","labels":["phase-1","infrastructure"]}
{"ts":"2025-12-27T17:01:32Z","type":"created","id":"dp-054","title":"External roster management for privacy-by-default","issue_type":"feature","priority":2,"description":"Implement student ID \u2194 name/email mapping stored outside the notebook.\n\nRoster file structure (~/.notebook/rosters/{quiz-id}-roster.yaml):\nstudents:\n  s001:\n    name: 'Alice Smith'\n    email: 'alice@school.edu'\n    responseId: '2_ABaOnud...'\n  s002:\n    name: 'Bob Jones'\n    ...\n\nSettings integration (.notebook/settings.yaml):\ngrading:\n  roster_path: '~/.notebook/rosters/'\n  show_student_names: true  # UI toggle\n\nImplementation:\n- tools/grading/manage_roster.py script\n- Create roster on response import\n- Look up names for browser UI display\n- Look up responseId for grade export\n- CLI commands: create, add-student, lookup, export\n\nBrowser integration:\n- Load roster when rendering response cards (if show_student_names: true)\n- Display 'Alice Smith (s001)' vs 'Student s001'\n- Toggle for blind grading mode","labels":["phase-1","infrastructure","privacy"]}
{"ts":"2025-12-27T17:01:51Z","type":"created","id":"dp-055","title":"Bulk API grading with context caching","issue_type":"feature","priority":1,"description":"Implement tools/grading/grade_responses.py for efficient batch grading.\n\nArchitecture:\n- Uses Anthropic Batch API with prompt caching\n- Each student graded independently (no order effects)\n- Shared context (rubric, model answer, calibration) cached once\n- ~0.75x cost of single-prompt approach\n\nInput format (grading_context.json):\nsystem_instructions: |\n  You are grading student quiz responses. Grade based solely on the rubric...\nquiz:\n  title: 'Photosynthesis Quiz'\nrubric:\n  question_3:\n    max_score: 5\n    criteria: |\n      5 points: Complete explanation...\n    model_answer: |\n      Plants use sunlight...\ncalibration_examples:\n  - answer: '...'\n    score: 2\n    feedback: '...'\n\nInput format (pending_responses.json):\n- studentId \u2192 answer text mapping\n\nOutput format (grades.json):\n- studentId \u2192 {score, feedback}\n\nProvider abstraction:\nPROVIDERS = {\n  'anthropic': AnthropicBatchGrader,\n  'openai': OpenAIBatchGrader,\n  'google': GoogleBatchGrader,\n  'local': OllamaGrader,\n}\n\nCLI: python grade_responses.py --provider anthropic --model claude-sonnet-4-20250514 --context context.json --responses responses.json --output grades.json","labels":["phase-1","infrastructure","grading"]}
{"ts":"2025-12-27T17:04:02Z","type":"created","id":"dp-056","title":"Summary statistics generation","issue_type":"feature","priority":2,"description":"Implement tools/grading/generate_stats.py for class and student analytics.\n\nClass summary output:\n- Total students, submitted count, graded count\n- Score distribution (histogram buckets)\n- Per-question analysis (% correct, average score, common errors)\n- Top performers and needs-support lists (using student IDs)\n\nStudent progress output:\n- Quiz performance over time\n- Topics mastered vs needs review\n- Average and trend\n\nOutput formats:\n- Markdown (for notebook cards)\n- JSON (for further processing)\n- CSV (for spreadsheet export)\n\nCLI:\npython generate_stats.py --quiz-id photosynthesis --format markdown\npython generate_stats.py --student s001 --format json\npython generate_stats.py --quiz-id photosynthesis --format csv --output gradebook.csv\n\nIntegration with roster:\n- Stats use student IDs internally\n- Optional name lookup for exports (--include-names flag)","depends_on":["dp-053"],"labels":["phase-1","infrastructure","analytics"]}
{"ts":"2025-12-27T17:04:18Z","type":"created","id":"dp-057","title":"Google Forms bridge: project setup and structure","issue_type":"task","priority":2,"description":"Set up google-forms-bridge/ directory with Apps Script project.\n\nFiles to create:\n- appsscript.json (manifest with OAuth scopes)\n- Code.gs (main entry points)\n- ExportForm.gs (form structure \u2192 JSON)\n- ImportQuiz.gs (JSON \u2192 form questions)\n- ExportResponses.gs (student answers \u2192 JSON)\n- ImportGrades.gs (grades/feedback \u2192 form)\n- Utils.gs (shared helpers)\n- README.md (clasp setup instructions)\n\nRequired OAuth scopes:\n- https://www.googleapis.com/auth/forms\n- https://www.googleapis.com/auth/forms.responses.readonly\n\nREADME should cover:\n- clasp installation (npm install -g @google/clasp)\n- OAuth login (clasp login)\n- Project creation (clasp create)\n- Deployment (clasp deploy)\n- Testing functions (clasp run)","labels":["phase-2","google-forms"]}
{"ts":"2025-12-27T17:04:32Z","type":"created","id":"dp-058","title":"Google Forms bridge: exportFormToJSON","issue_type":"feature","priority":2,"description":"Implement ExportForm.gs to export Google Form structure to JSON.\n\nFunction signature:\nfunction exportFormToJSON(formId) {\n  // Returns: { title, description, questions[], settings }\n}\n\nQuestion mapping (Google Forms \u2192 our schema):\n- ChoiceQuestion (RADIO) \u2192 multiple_choice\n- ChoiceQuestion (CHECKBOX) \u2192 multiple_choice + allowMultiple\n- ChoiceQuestion (DROP_DOWN) \u2192 multiple_choice + display:'dropdown'\n- TextQuestion (short) \u2192 short_answer\n- TextQuestion (paragraph) \u2192 worked\n- ScaleQuestion \u2192 scale\n- DateQuestion \u2192 date\n- TimeQuestion \u2192 time\n- RatingQuestion \u2192 rating\n- Grid \u2192 grid\n\nFor each question, extract:\n- questionId, title, description\n- type-specific fields (options, correct answer, points)\n- required flag, points value\n\nUsage via clasp:\nclasp run exportFormToJSON -p '[\"FORM_ID\"]' > form.json","depends_on":["dp-057"],"labels":["phase-2","google-forms"]}
{"ts":"2025-12-27T17:04:49Z","type":"created","id":"dp-059","title":"Google Forms bridge: createFormFromJSON","issue_type":"feature","priority":2,"description":"Implement ImportQuiz.gs to create/update Google Forms from quiz JSON.\n\nFunctions:\nfunction createFormFromJSON(quizJSON) {\n  // Creates new Form, returns { formId, editUrl, viewUrl }\n}\n\nfunction updateFormFromJSON(formId, quizJSON) {\n  // Updates existing Form, returns { formId, editUrl, viewUrl }\n}\n\nQuestion mapping (our schema \u2192 Google Forms):\n- multiple_choice \u2192 ChoiceQuestion (RADIO/CHECKBOX/DROP_DOWN based on flags)\n- short_answer \u2192 TextQuestion (short)\n- worked \u2192 TextQuestion (paragraph)\n- numeric \u2192 TextQuestion (with regex validation if possible)\n- scale \u2192 ScaleQuestion\n- grid \u2192 Grid\n- ordering \u2192 SKIP with warning (not supported)\n- matching \u2192 Grid (with semantic mismatch warning)\n\nFor each question, set:\n- title, description, helpText\n- type-specific config (options, correct answer, points)\n- required flag, points value\n\nReturn warnings array for incompatible question types.\n\nUsage via clasp:\nclasp run createFormFromJSON -p '[{...quizJSON}]'","depends_on":["dp-057"],"labels":["phase-2","google-forms"]}
{"ts":"2025-12-27T17:05:02Z","type":"created","id":"dp-060","title":"Google Forms bridge: exportResponsesToJSON","issue_type":"feature","priority":2,"description":"Implement ExportResponses.gs to export student submissions from Google Forms.\n\nFunction signature:\nfunction exportResponsesToJSON(formId) {\n  // Returns: { \n  //   formId,\n  //   responses: [{ \n  //     responseId, \n  //     email, \n  //     name,  // if collected\n  //     submittedAt, \n  //     answers: [{ questionId, answer }] \n  //   }] \n  // }\n}\n\nAnswer formats by question type:\n- Multiple choice: selected option index or indices (array for checkbox)\n- Text: string\n- Scale: number\n- Date/Time: ISO string\n- Grid: array of [row, column] pairs\n- Rating: number\n\nHandle edge cases:\n- Partial submissions\n- Multiple submissions per respondent (take latest)\n- Anonymous vs identified respondents\n\nUsage via clasp:\nclasp run exportResponsesToJSON -p '[\"FORM_ID\"]' > responses.json","depends_on":["dp-057"],"labels":["phase-2","google-forms"]}
{"ts":"2025-12-27T17:05:17Z","type":"created","id":"dp-061","title":"Google Forms bridge: submitGradesToForm","issue_type":"feature","priority":2,"description":"Implement ImportGrades.gs to submit grades and feedback to Google Forms.\n\nFunction signature:\nfunction submitGradesToForm(formId, grades) {\n  // grades: [{ \n  //   responseId, \n  //   scores: [{ questionIndex, score, feedback }],\n  //   totalScore,\n  //   generalFeedback\n  // }]\n  // Returns: { submitted: number, errors: [] }\n}\n\nImplementation:\n- Use Form.submitGrades() or equivalent Apps Script API\n- Set per-question scores and feedback\n- Set overall feedback if provided\n- Handle partial failures gracefully\n\nValidation before submission:\n- Check all responseIds exist in form\n- Validate scores within question max points\n- Warn on missing grades for any questions\n\nUsage via clasp:\nclasp run submitGradesToForm -p '[\"FORM_ID\", [...grades]]'","depends_on":["dp-057"],"labels":["phase-2","google-forms"]}
{"ts":"2025-12-27T17:05:33Z","type":"created","id":"dp-062","title":"Quiz schema extensions for Google Forms compatibility","issue_type":"feature","priority":3,"description":"Extend quiz question schema for full Google Forms compatibility.\n\nMultiple choice extensions:\n- allowMultiple: boolean (checkbox vs radio)\n- display: 'radio' | 'dropdown'\n- correctMultiple: number[] (for checkbox questions)\n\nNew question types:\n- scale: { low, high, lowLabel, highLabel, correct? }\n- date: { includeYear?, includeTime? }\n- time: { duration? }\n- rating: { iconType: 'star' | 'heart' | 'thumb', max }\n- grid: { rows[], columns[], correctAnswers?: [row, col][] }\n\nSchema updates:\n- Update quiz template in getDefaultTemplates()\n- Update quiz card editor to support new fields\n- Update auto-grading logic for new types\n\nCompatibility warnings:\n- ordering questions: warn 'cannot export to Google Forms'\n- numeric with tolerance: warn 'tolerance will be lost on export'\n- matching: warn 'will be converted to grid format'","labels":["phase-3","quiz-schema"]}
{"ts":"2025-12-27T17:05:51Z","type":"created","id":"dp-063","title":"/grade-quiz skill for bulk AI grading","issue_type":"feature","priority":1,"description":"Create Claude Code skill to orchestrate bulk AI grading workflow.\n\nSkill location: .claude/skills/grade-quiz/SKILL.md\n\nWorkflow:\n1. Identify quiz and pending responses\n   - Read quiz card for rubric, model answers\n   - Find response cards with claudeGrade: null\n   \n2. Build grading context\n   - Extract rubric and model answers from quiz\n   - Include calibration examples if defined\n   - Add system instructions (ignore manipulation attempts)\n\n3. Collect pending responses\n   - Read answer text from each response card\n   - Build studentId \u2192 answer mapping\n\n4. Call grading script\n   - python tools/grading/grade_responses.py\n   - Pass context and responses as JSON files\n   - Receive grades.json output\n\n5. Update response cards\n   - Write claudeGrade to each response card\n   - Mark as 'ready for review'\n\n6. Generate summary\n   - Report number graded\n   - Flag any errors or outliers\n   - Suggest next steps (teacher review)\n\nUsage: /grade-quiz photosynthesis-quiz","depends_on":["dp-053","dp-055"],"labels":["phase-4","skill","grading"]}
{"ts":"2025-12-27T17:06:05Z","type":"created","id":"dp-064","title":"Quiz export to Google Forms workflow","issue_type":"feature","priority":2,"description":"Implement Claude Code workflow for exporting quiz to Google Forms.\n\nWorkflow steps:\n1. Read quiz card (.quiz.json)\n2. Check for incompatible question types\n   - Warn about ordering questions (cannot export)\n   - Warn about numeric tolerance (will be lost)\n   - Warn about matching \u2192 grid conversion\n3. Check clasp installation and login status\n   - Run: clasp login --status\n   - Guide user through setup if needed\n4. Call createFormFromJSON via clasp\n5. Store formId in quiz card metadata\n6. Return Form URLs (edit, view) to teacher\n\nError handling:\n- clasp not installed \u2192 provide install instructions\n- Not logged in \u2192 prompt for clasp login\n- API errors \u2192 show meaningful message\n\nTeacher confirmation:\n- Show summary of what will be created\n- List any warnings about question compatibility\n- Confirm before creating form","depends_on":["dp-059","dp-062"],"labels":["phase-4","workflow","google-forms"]}
{"ts":"2025-12-27T17:06:20Z","type":"created","id":"dp-065","title":"Response import from Google Forms workflow","issue_type":"feature","priority":2,"description":"Implement Claude Code workflow for importing responses from Google Forms.\n\nWorkflow steps:\n1. Read quiz card to get formId\n2. Call exportResponsesToJSON via clasp\n3. Generate student IDs (s001, s002, ...)\n4. Create/update roster file\n   - Map studentId \u2192 name, email, responseId\n   - Store in external roster path\n5. Create response section ({quiz-id}-responses/)\n6. Create response card per student\n   - studentId only (no name/email in card)\n   - Store all answers\n   - Auto-grade objective questions immediately\n   - Mark open-ended as pending review\n7. Report summary\n   - Number of responses imported\n   - Number auto-graded vs pending review\n   - Any errors or duplicates\n\nDuplicate handling:\n- If response already exists, update with latest submission\n- Track submittedAt to identify newest\n\nAuto-grading on import:\n- multiple_choice: compare to correct answer\n- numeric: check within tolerance\n- matching/ordering: check sequence\n- short_answer/worked: mark as pending","depends_on":["dp-053","dp-054","dp-060"],"labels":["phase-4","workflow","google-forms"]}
{"ts":"2025-12-27T17:06:33Z","type":"created","id":"dp-066","title":"Grade export to Google Forms workflow","issue_type":"feature","priority":2,"description":"Implement Claude Code workflow for exporting grades to Google Forms.\n\nPre-export validation:\n1. Check all responses have final grades\n   - teacherGrade present, OR\n   - claudeGrade approved by teacher\n2. Warn about unreviewed responses\n3. Require teacher confirmation before export\n\nWorkflow steps:\n1. Read all response cards\n2. Look up responseId from roster file\n3. Build grades array with:\n   - responseId (from roster)\n   - Per-question scores and feedback\n   - Total score\n   - General feedback (if any)\n4. Call submitGradesToForm via clasp\n5. Mark each response as exportedToForms: true, exportedAt: timestamp\n6. Report summary\n   - Number of grades exported\n   - Any errors\n\nSafety checks:\n- Never export without teacher confirmation\n- Show what will be exported before sending\n- Require explicit 'yes' to proceed\n- Log export event for audit trail","depends_on":["dp-054","dp-061"],"labels":["phase-4","workflow","google-forms"]}
{"ts":"2025-12-27T17:06:50Z","type":"created","id":"dp-067","title":"Class summary and analytics generation","issue_type":"feature","priority":3,"description":"Implement class summary view and analytics as notebook cards.\n\nClass summary card (markdown or code):\n- Total students, submitted, graded counts\n- Score distribution histogram\n- Per-question analysis:\n  - % correct (for objective)\n  - Average score (for open-ended)\n  - Common errors identified by Claude\n- Top performers list (by student ID)\n- Needs-support list (by student ID)\n\nGeneration:\n- Claude Code reads response cards\n- Calls generate_stats.py for raw data\n- Generates formatted markdown card\n- Creates/updates summary card in quiz section\n\nVisualizations (for code cards with matplotlib):\n- Score distribution bar chart\n- Question difficulty chart\n- Score trend over time (if multiple quizzes)\n\nTeacher can regenerate summary after grading changes.","depends_on":["dp-053","dp-056"],"labels":["phase-5","analytics"]}
{"ts":"2025-12-27T17:07:05Z","type":"created","id":"dp-068","title":"Student progress tracking across quizzes","issue_type":"feature","priority":3,"description":"Track and visualize individual student progress over time.\n\nData aggregation:\n- Find all response cards for a student ID across quizzes\n- Extract scores, dates, topics\n- Calculate trends and averages\n\nProgress view (per student):\n- Quiz performance timeline\n- Topics mastered vs needs review\n- Average score and trend direction\n- Comparison to class average (optional)\n\nImplementation:\n- generate_stats.py --student s001 --format markdown\n- Creates progress card in appropriate location\n- Updates when new quiz results available\n\nPrivacy consideration:\n- Progress cards use student ID only\n- Teacher can cross-reference with roster for name\n- No PII stored in notebook files","depends_on":["dp-053","dp-056"],"labels":["phase-5","analytics"]}
{"ts":"2025-12-27T17:09:49Z","type":"created","id":"dp-069","title":"Gradebook CSV/spreadsheet export","issue_type":"feature","priority":3,"description":"Export grades to CSV format for external use and school records.\n\nOutput format:\n- Columns: StudentID, Q1, Q2, ..., Total, Percentage\n- Optional: include student names (--include-names flag, requires roster)\n- Compatible with Excel, Google Sheets, school grade systems\n\nCLI:\npython generate_stats.py --quiz-id photosynthesis --format csv --output gradebook.csv\npython generate_stats.py --quiz-id photosynthesis --format csv --include-names --output gradebook.csv\n\nAdditional exports:\n- Per-question breakdown (for item analysis)\n- Feedback export (student, question, feedback text)\n- Multi-quiz gradebook (all quizzes for a class)\n\nIntegration:\n- Claude Code can generate on request\n- Place in notebook root or specified location\n- Not a notebook card (external file for school systems)","depends_on":["dp-054","dp-056"],"labels":["phase-5","analytics","export"]}
{"ts":"2025-12-28T11:24:17Z","type":"created","id":"dp-070","title":"Test fixtures for grading and Google Forms workflows","issue_type":"task","priority":1,"description":"Create sample data and scripts for testing new features without real Google Forms.\n\nFixtures needed:\n1. Sample quiz with multiple question types\n2. Sample responses (20-30 students with varied answers)\n3. Sample roster file for privacy testing\n4. Mock grading context with rubric and calibration examples\n5. Expected grades output for verification\n\nTesting approaches:\n- Unit tests for grade_responses.py (mock API calls)\n- Integration tests using local/mock provider\n- Google Forms bridge: mock clasp responses for offline testing\n- End-to-end: sample notebook in examples/ with pre-populated quiz data\n\nThis enables development without:\n- Real Anthropic API calls during development\n- Real Google Forms account\n- Real student data","labels":["phase-1","testing","infrastructure"]}
{"ts":"2025-12-28T11:35:55Z","type":"closed","id":"dp-053","reason":"Implemented quiz-response template with:\n- Template schema (studentId, quizId, answers with grade hierarchy, status, export tracking)\n- Card preview (student ID, score, status badge)\n- Viewer (question text from quiz, student answers, grade cards for auto/claude/teacher)\n- Teacher grading UI (score input, feedback, approve AI grade button)\n- CSS styling (color-coded statuses, grade hierarchy display)\n- Sample response data (3 students with different grading states)\n- Extension registry (.response.json)\n- Template index registration"}
{"ts":"2025-12-28T17:09:15Z","type":"closed","id":"dp-062","reason":"Implemented quiz type extensions: added scale and grid question types, extended multiple_choice with allowMultiple/correctMultiple/display fields. Added rendering, interaction handlers, grading logic, and CSS for all new types."}
{"ts":"2025-12-28T17:12:43Z","type":"closed","id":"dp-054","reason":"Implemented manage_roster.py with create (from Google Forms export), lookup (by ID or email), and list commands. Stores roster in YAML format externally."}
{"ts":"2025-12-28T17:12:43Z","type":"closed","id":"dp-057","reason":"Created google-forms-bridge/ with appsscript.json, Code.gs, ExportResponses.gs, ImportGrades.gs, and README.md with clasp setup instructions."}
{"ts":"2025-12-28T17:12:43Z","type":"closed","id":"dp-060","reason":"Implemented ExportResponses.gs with getFormMetadata, getQuestions, and exportResponses functions for extracting student submissions from Google Forms."}
{"ts":"2025-12-28T17:12:43Z","type":"closed","id":"dp-061","reason":"Implemented ImportGrades.gs with importFromJSON function for submitting grades and feedback back to Google Forms quiz responses."}
