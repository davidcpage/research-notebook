{"ts":"2025-12-15T13:41:44Z","type":"created","id":"dp-001","title":"Session parser - parse Claude Code JSONL transcripts","issue_type":"task","priority":2,"description":"Parse Claude Code session JSONL files (~/.claude/projects/{project}/{session}.jsonl) into structured format for display.\n\n**Design doc:** dev/planning/features/session-card-type.md (see 'Session File Format Analysis' section)\n\n**Deliverables:**\n- parseSessionFile(jsonlContent) function\n- Handle message types: summary, user, assistant, file-history-snapshot\n- Extract metadata: session_id, timestamps, model, token counts\n- Parse tool_use and tool_result blocks within messages\n\nThis is foundational work for the session card type feature.","labels":["enhancement"]}
{"ts":"2025-12-15T13:42:00Z","type":"created","id":"dp-002","title":"Session template and layouts","issue_type":"task","priority":2,"description":"Add session template with schema and layout definitions for card/viewer display.\n\n**Design doc:** dev/planning/features/session-card-type.md (see 'Template Design' section)\n\n**Deliverables:**\n- Add 'session' to getDefaultTemplates()\n- Add .session.json extension mapping\n- Define schema: title, summary, session_id, project, started, ended, git_branch, model, total_tokens, transcript, tags\n- Card layout: summary + message count + tokens + date\n- Viewer layout: hierarchical message display shell (actual rendering in separate issue)","depends_on":["dp-001"],"labels":["enhancement"]}
{"ts":"2025-12-15T13:42:11Z","type":"created","id":"dp-003","title":"Session viewer - TUI-styled message renderer","issue_type":"task","priority":2,"description":"Render session messages with TUI aesthetic and collapsible detail levels.\n\n**Design doc:** dev/planning/features/session-card-type.md (see 'UI Design: Message Display' section)\n\n**Deliverables:**\n- renderUserMessage(msg, collapsed)\n- renderAssistantMessage(msg, collapsed)\n- renderToolCall(tool, collapsed)\n- renderToolResult(result, collapsed)\n- CSS for TUI aesthetic (dark bg, monospace, box-drawing chars)\n- Click handlers for expand/collapse\n- Three detail levels: summary view, message view, tool detail","depends_on":["dp-002"],"labels":["enhancement"]}
{"ts":"2025-12-15T13:42:20Z","type":"created","id":"dp-004","title":"Session import mechanism","issue_type":"task","priority":2,"description":"Allow importing Claude Code session files into the notebook.\n\n**Design doc:** dev/planning/features/session-card-type.md (see 'Phase 4: Import Mechanism' section)\n\n**Deliverables:**\n- 'Import Session' button (in toolbar or section menu)\n- File picker for .jsonl files\n- Parse using session parser and save as .session.json\n- Place in user-selected section\n\n**Future consideration:** Session browser modal showing available sessions from ~/.claude/projects/","depends_on":["dp-002"],"labels":["enhancement"]}
{"ts":"2025-12-15T13:42:31Z","type":"created","id":"dp-005","title":"Session cards - integrate with sessions skill summaries","issue_type":"feature","priority":3,"description":"Optionally integrate session cards with the sessions skill from https://github.com/davidcpage/skill-issues if available.\n\n**Concept:** The sessions skill stores curated summaries in .memory/sessions.jsonl with learnings, open questions, and next actions. Session cards could display these summaries as a high-level overview, with the ability to drill down into full transcript logs.\n\n**Two-tier approach:**\n- Sessions skill: curated learnings and summaries (what we learned)\n- Session cards: full conversation archives (what was said)\n\n**Implementation ideas:**\n- Detect if .memory/sessions.jsonl exists\n- Match session cards to session summaries by date/topic\n- Show summary prominently in card/viewer if available\n- Link between session summary and full transcript","depends_on":["dp-002"],"labels":["enhancement"]}
{"ts":"2025-12-15T13:43:02Z","type":"created","id":"dp-006","title":"Tag search and filtering","issue_type":"feature","priority":2,"description":"Add ability to filter cards by tag.\n\n**Design doc:** dev/planning/features/tags-future.md (see 'Search by Tag' section)\n\n**Deliverables:**\n- Filter cards by tag in search/filter UI\n- Keyboard shortcut for tag filter (e.g., `t:ongoing`)\n- Tag facets in sidebar or filter dropdown\n\n**Related future work:**\n- Tag configuration in settings (custom colors/icons)\n- Multi-tag display improvements (limit display with '+X more')","labels":["enhancement"]}
{"ts":"2025-12-15T13:43:24Z","type":"created","id":"dp-007","title":"Code file inference for repository exploration","issue_type":"feature","priority":2,"description":"Display arbitrary code files (.py, .js, .ts, etc.) as syntax-highlighted cards without requiring frontmatter.\n\n**Design doc:** dev/planning/features/code-repo-exploration.md (see 'Gaps to Fill' section)\n\n**Context:** Enables using the notebook to explore code repositories alongside Claude Code, without polluting repo source files with frontmatter.\n\n**Deliverables:**\n- Infer title from filename\n- Display content as syntax-highlighted code (read-only)\n- No frontmatter injection\n\n**Related work:**\n- Readonly sections flag (prevent accidental edits)\n- Deeper section paths (path: 'cloned-repo/src/components')","labels":["enhancement"]}
{"ts":"2025-12-15T13:43:34Z","type":"created","id":"dp-008","title":"Media library modal","issue_type":"feature","priority":3,"description":"Grid view modal for browsing and managing images in assets/ directory.\n\n**Design doc:** dev/planning/architecture/filesystem-simplification.md (see 'Phase 4: Assets as First-Class Citizens - Deferred' section)\n\n**Deliverables:**\n- Modal showing grid of images from assets/ directory\n- Drag-drop upload to add new images\n- Click to copy reference/insert into editor\n\n**Related work:**\n- 'Insert image' button in markdown editor","labels":["enhancement"]}
{"ts":"2025-12-15T14:04:36Z","type":"created","id":"dp-009","title":"Code cell split-pane scrolling bug","issue_type":"bug","priority":2,"description":"In code cells in preview mode (split-pane layout), scrolling acts on input and output panes together. If the input code is long, the output gets positioned badly in the left pane.\n\n**Expected behavior:** Output pane should probably not scroll (or scroll independently).\n\n**Current behavior:** Both panes scroll together, causing output to be displaced when input is long.\n\n**Location:** Split-pane layout CSS/JS in research_notebook.html (likely in HTML_HEAD or RENDER_FUNCTIONS sections)"}
{"ts":"2025-12-15T14:06:23Z","type":"closed","id":"dp-009","reason":"Fixed - added height: 100% to both split panes and changed left pane alignment to flex-start so output stays pinned at top"}
{"ts":"2025-12-15T14:10:57Z","type":"note","id":"dp-009","content":"Actual fix required multiple CSS changes: (1) viewer-split-pane: height: 100%, (2) viewer-split-left: overflow: hidden + align-items: flex-start, (3) viewer-content:has(.viewer-split-pane): overflow: hidden, (4) viewer-split-right: max-height: calc(90vh - 120px). Key learning: height: 100% chains don't resolve in flex contexts - viewport-based max-height is more reliable."}
{"ts":"2025-12-15T14:22:24Z","type":"created","id":"dp-010","title":"Review claude-mem repo for session card inspiration","issue_type":"task","priority":3,"description":"Review https://github.com/thedotmack/claude-mem for features that might inform our session cards work. The repo appears to have nice UI for summarising, displaying and searching past sessions. Much of it may be overkill but could provide useful ideas for: session summaries, search over past sessions, session display/UI patterns.","labels":["research","sessions"]}
{"ts":"2025-12-15T14:23:14Z","type":"updated","id":"dp-010","priority":1,"reason":"Could inform design of session cards feature - better to review before implementation"}
{"ts":"2025-12-15T14:24:27Z","type":"note","id":"dp-010","content":"Reviewed README. Key features that might inform session cards:\n\n**Relevant patterns:**\n1. **Auto-generated summaries** - Summaries created at session end via lifecycle hooks\n2. **Multi-concept tagging** - Tags like: discovery, problem-solution, pattern, decision, bugfix, feature, refactor\n3. **File reference tracking** - Links observations to specific files touched\n4. **Progressive disclosure** - Layered retrieval showing token costs for context decisions\n5. **Hybrid search** - Keyword (FTS5) + semantic (Chroma vector) search\n6. **Web viewer UI** - Real-time visualization at localhost:37777\n\n**Likely overkill for us:**\n- Lifecycle hooks intercepting every tool use\n- Full SQLite + vector DB infrastructure\n- MCP integration\n- Endless Mode (context compression)\n\n**Architecture:** TypeScript/Bun worker service on port 37777, SQLite with FTS5 for storage, Chroma for semantic search, Claude Agent SDK for extracting learnings from tool outputs."}
{"ts":"2025-12-15T14:27:25Z","type":"note","id":"dp-010","content":"UI Code Review - Key patterns:\n\n**Summary Card (SummaryCard.tsx)**\n- Structured sections: Investigated, Learned, Completed, Next Steps (each with icon)\n- Request/title at top, project badge, session ID and timestamp in footer\n- Amber/gold color scheme to distinguish from other card types\n\n**Observation Card (ObservationCard.tsx)**\n- Progressive disclosure via toggle buttons: subtitle (default) \u2192 facts (bullet list) \u2192 narrative (full text)\n- Type badge (decision, bugfix, feature, refactor, etc.)\n- Metadata: concepts as small badges, files read/modified\n- Toggle buttons in header: 'facts' and 'narrative' - only one active at a time\n\n**Feed (Feed.tsx)**\n- Simple chronological feed combining observations, summaries, prompts\n- Sorted by created_at_epoch descending\n- Infinite scroll via IntersectionObserver\n\n**Color coding by card type:**\n- Summary: amber/gold (--color-bg-summary, --color-border-summary)\n- Prompt: purple \n- Observation: blue\n\n**CSS patterns:**\n- Comprehensive CSS variable system (light + dark themes)\n- Cards expand in-place with toggles (no modal viewer)\n- Type badges: uppercase, small, colored background\n\n**Data model (types.ts):**\n- Observation: type, title, subtitle, narrative, facts (JSON array), concepts (JSON array), files_read, files_modified\n- Summary: request, investigated, learned, completed, next_steps\n- Both have: id, project, created_at_epoch"}
{"ts":"2025-12-15T14:33:50Z","type":"note","id":"dp-010","content":"Design Implications for Sessions Skill / Session Cards:\n\n**Current sessions skill structure:**\n- learnings (array) \u2713 maps to 'learned'\n- open_questions (array) - unique to our skill\n- next_actions (array) \u2713 maps to 'next_steps'\n- issues_worked (array) - could inform 'completed'\n\n**Claude-mem summary structure:**\n- investigated - what was explored\n- learned - key discoveries\n- completed - what got done\n- next_steps - follow-up items\n\n**Gap analysis:**\n1. We lack 'investigated' - what areas/files were explored\n2. We lack explicit 'completed' - issues_worked is indirect\n3. We have open_questions which they don't (valuable, keep)\n\n**Two approaches for session cards:**\n\nA) **Full transcripts** (current design doc approach)\n- Import raw Claude Code JSONL\n- Complex hierarchical viewer with expand/collapse\n- Large files, rich detail but hard to scan\n\nB) **Structured summaries** (claude-mem inspired)\n- Use sessions skill to capture structured data as we go\n- Cards display sections: Explored | Learned | Completed | Next Steps | Open Questions\n- Smaller, scannable, but loses transcript detail\n\n**Hybrid approach:**\n- Session cards store BOTH structured summary AND raw transcript\n- Card preview shows structured summary (scannable)\n- Viewer offers 'Full Transcript' tab for drill-down\n- Sessions skill evolves to capture richer structure during session\n\n**Possible sessions skill field additions:**\n- explored/investigated: files/areas touched\n- completed: tasks finished (derive from issues closed?)\n- decisions: key choices made (currently mixed into learnings)"}
{"ts":"2025-12-15T14:34:30Z","type":"closed","id":"dp-010","reason":"Done - Reviewed claude-mem repo and extracted design lessons:\n\n1. Added 'Structured Summaries' section to dev/planning/features/session-card-type.md\n2. Key pattern: Structured sections (Explored/Learned/Completed/Next Steps) instead of raw transcripts\n3. Proposed hybrid approach: structured summary for cards + optional transcript for drill-down\n4. Identified sessions skill evolution: add 'explored', 'completed', 'decisions' fields\n5. Progressive disclosure UI pattern from claude-mem (toggle buttons)\n\nReference: Issue notes contain full review findings from README and UI code analysis."}
{"ts":"2025-12-15T14:38:06Z","type":"note","id":"dp-005","content":"REVISED: This should be the PRIMARY approach for session cards, not a secondary integration.\n\nWith the hybrid approach from claude-mem review (#010):\n1. Sessions skill already captures: learnings, open_questions, next_actions, issues_worked\n2. This maps directly to card sections: Learned, Open Questions, Next Steps, Completed\n3. Only gap is 'explored' - but learnings often implicitly cover this\n\nProposed change: Make this issue the foundation, unblock from #002, and have #002 depend on THIS instead.\n\nCard structure:\n- Card preview shows structured sections from .memory/sessions.jsonl\n- Optional: link to full transcript for drill-down (via #001, #003)"}
{"ts":"2025-12-15T14:38:12Z","type":"updated","id":"dp-005","depends_on":[],"reason":"Removed blockers: 002"}
{"ts":"2025-12-15T14:40:00Z","type":"updated","id":"dp-005","priority":1,"reason":"Elevating to primary approach for session cards based on claude-mem review (#010). Structured summaries from sessions skill are the foundation, not an optional integration."}
{"ts":"2025-12-15T14:40:01Z","type":"note","id":"dp-001","content":"REVISED ROLE: Now optional for full transcript drill-down only.\n\nWith hybrid approach (#005 as primary), this parser is only needed if we want to offer 'View Full Transcript' in the session viewer. Not blocking for MVP session cards.\n\nConsider: Move to backlog (priority 4) until structured summaries are working."}
{"ts":"2025-12-15T14:40:02Z","type":"note","id":"dp-002","content":"REVISED: Should depend on #005 (sessions skill integration), not #001 (JSONL parser).\n\nNew schema should follow hybrid approach from design doc:\n- Primary: structured fields (learnings, completed, next_steps, open_questions)\n- Optional: transcript field for full drill-down\n\nSee dev/planning/features/session-card-type.md 'Alternative: Structured Summaries' section."}
{"ts":"2025-12-15T14:40:03Z","type":"note","id":"dp-003","content":"REVISED ROLE: Now optional for full transcript drill-down only.\n\nWith hybrid approach, the primary viewer shows structured sections (Learned, Completed, etc.). The TUI message renderer is only needed for optional 'Full Transcript' tab.\n\nConsider: Move to backlog (priority 4) until structured summaries are working."}
{"ts":"2025-12-15T14:40:04Z","type":"note","id":"dp-004","content":"REVISED ROLE: Optional mechanism to import historical sessions.\n\nWith hybrid approach, new sessions are captured via sessions skill automatically. This import mechanism is only needed to:\n1. Import old sessions before we had the skill\n2. Archive sessions from other projects\n\nConsider: Move to backlog (priority 4) until structured summaries are working."}
{"ts":"2025-12-15T14:41:00Z","type":"updated","id":"dp-002","depends_on":["dp-005"],"reason":"Now depends on #005 (sessions skill integration) instead of #001 (JSONL parser). Structured summaries are the foundation."}
{"ts":"2025-12-15T14:41:01Z","type":"updated","id":"dp-001","priority":4,"reason":"Moved to backlog - only needed for optional full transcript drill-down, not for MVP session cards"}
{"ts":"2025-12-15T14:41:02Z","type":"updated","id":"dp-003","priority":4,"depends_on":[],"reason":"Moved to backlog and unblocked - only needed for optional full transcript viewer, not for MVP session cards"}
{"ts":"2025-12-15T14:41:03Z","type":"updated","id":"dp-004","priority":4,"depends_on":[],"reason":"Moved to backlog and unblocked - only needed for importing historical sessions, not for MVP using sessions skill"}
{"ts":"2025-12-15T16:08:57Z","type":"created","id":"dp-011","title":"Consolidate markdown typography CSS","issue_type":"task","priority":2,"description":"The markdown content styles are duplicated between .preview-content (card previews) and .viewer-markdown (viewer modal). These share the same typography rules (h1-h6, lists, tables, code blocks, blockquotes) but are defined separately. Consolidating into shared classes could reduce CSS by ~15-20% and improve maintainability. Low risk refactor - purely cosmetic change."}
{"ts":"2025-12-15T16:14:09Z","type":"note","id":"dp-011","content":"Expanded scope: markdown typography is duplicated in THREE places, not two: .preview-content (card), .viewer-markdown (viewer), and .viewer-description (bookmark descriptions). Also identified: (1) code block styling duplicated between .preview-code and .viewer-code-only, (2) split pane layouts duplicated between preview-split-* and viewer-split-*. Suggested approach: create shared base classes (.md-content, .code-block) with context-specific overrides only where needed."}
{"ts":"2025-12-15T16:50:04Z","type":"note","id":"dp-011","content":"Expanded scope: CSS architecture refactor using cascade layers. Design doc: dev/planning/architecture/css-layers-design.md. Three phases: (1) Add layer infrastructure and inline hljs theme, (2) Organize existing CSS into layers, (3) Consolidate shared patterns like .md-content. Primary benefit: theme.css can override any style without !important."}
{"ts":"2025-12-15T16:55:28Z","type":"created","id":"dp-012","title":"CSS layers phase 1: Infrastructure","issue_type":"task","priority":2,"description":"Add @layer declarations, inline highlight.js atom-one-dark theme in vendors layer, remove CDN link for CSS (keep JS), remove !important from hljs overrides."}
{"ts":"2025-12-15T16:55:28Z","type":"created","id":"dp-013","title":"CSS layers phase 2: Organize into layers","issue_type":"task","priority":2,"description":"Wrap existing CSS in appropriate layer blocks: reset, base, components, templates. Creates clear mental model of where styles belong."}
{"ts":"2025-12-15T16:55:28Z","type":"created","id":"dp-014","title":"CSS layers phase 3: Consolidate patterns","issue_type":"task","priority":2,"description":"Create shared .md-content class for markdown typography. Update render functions to use it. Remove duplicate rules from .preview-content, .viewer-markdown, .viewer-description."}
{"ts":"2025-12-15T16:55:35Z","type":"updated","id":"dp-011","depends_on":["dp-012","dp-013","dp-014"],"reason":"Added blockers: 012, 013, 014"}
{"ts":"2025-12-15T16:55:35Z","type":"updated","id":"dp-013","depends_on":["dp-012"],"reason":"Added blockers: 012"}
{"ts":"2025-12-15T16:55:35Z","type":"updated","id":"dp-014","depends_on":["dp-013"],"reason":"Added blockers: 013"}
{"ts":"2025-12-15T17:08:03Z","type":"closed","id":"dp-012","reason":"Completed: Added @layer declarations, inlined hljs atom-one-dark theme in vendors layer, removed CDN CSS link, removed !important from hljs overrides, added padding:0 overrides for code elements."}
{"ts":"2025-12-15T17:21:21Z","type":"closed","id":"dp-013","reason":"Completed: Organized CSS into layer blocks (reset, base, components, templates). Print styles remain unlayered."}
{"ts":"2025-12-15T17:21:49Z","type":"updated","id":"dp-014","depends_on":[],"reason":"Removed blockers: 013"}
{"ts":"2025-12-15T17:37:33Z","type":"closed","id":"dp-014","reason":"Implemented shared .md-content class for markdown typography. Reduced duplicate CSS by 21 lines."}
{"ts":"2025-12-15T17:38:46Z","type":"closed","id":"dp-011","reason":"All three phases completed: (1) Layer infrastructure with inlined hljs theme, (2) CSS organized into layer blocks, (3) .md-content shared class. Net reduction of ~40 lines while improving maintainability."}
{"ts":"2025-12-15T18:46:55Z","type":"created","id":"dp-015","title":"Issue card template and layouts","issue_type":"feature","priority":2,"description":"Add issue card type to display items from .issues/events.jsonl.\n\n**Design doc:** dev/planning/features/session-card-type.md (see 'Issue Cards: Kanban Integration' section)\n\n**Deliverables:**\n- Add 'issue' template to getDefaultTemplates()\n- Parse .issues/events.jsonl into card data\n- Define schema: id, title, issue_type, priority, description, status, blocked_by, labels, notes\n- Card layout: title, description preview, priority/type badges, blocked-by links\n- Viewer layout: full description, notes timeline, blocked-by/blocking relationships\n\n**Related:** Session cards (#005) - shares JSONL parsing patterns","labels":["enhancement","skill-integration"]}
{"ts":"2025-12-15T18:47:08Z","type":"created","id":"dp-016","title":"Kanban board view for issues section","issue_type":"feature","priority":3,"description":"Add kanban board view as alternative display mode for issues.\n\n**Design doc:** dev/planning/features/session-card-type.md (see 'Kanban Board View' section)\n\n**Columns:**\n- Ready (open, not blocked)\n- In Progress (optional - could track via labels)\n- Blocked (open, has open blockers)\n- Closed\n\n**Deliverables:**\n- Kanban board component with drag-drop columns\n- Toggle button in section header: Cards / Kanban\n- Settings option for default issue display mode\n- Visual indicators for priority and issue type\n\n**Depends on:** Issue card template (#015)","depends_on":["dp-015"],"labels":["enhancement","skill-integration"]}
{"ts":"2025-12-15T18:47:08Z","type":"created","id":"dp-017","title":"Wiki links for issues and sessions","issue_type":"feature","priority":2,"description":"Extend wiki-link syntax to support cross-references between cards, issues, and sessions.\n\n**Design doc:** dev/planning/features/session-card-type.md (see 'Wiki Links' section)\n\n**Syntax:**\n- \\[\\[#005\\]\\] \u2192 Issue by ID\n- \\[\\[session:topic-name\\]\\] \u2192 Session by topic\n- \\[\\[session:2025-12-15\\]\\] \u2192 Sessions by date\n\n**Deliverables:**\n- Parse issue links in markdown content\n- Parse session links in markdown content\n- Render as badge-style clickable links\n- Show title on hover\n- Click opens viewer for linked item\n- Bidirectional link tracking (show 'Referenced by' in viewers)\n\n**Related:** Session cards (#005), Issue cards (#015)","labels":["enhancement","skill-integration"]}
{"ts":"2025-12-15T18:52:47Z","type":"note","id":"dp-005","content":"MVP implementation complete on feature/skill-integration branch:\n\n**Added:**\n- Session template with schema (learnings, open_questions, next_actions, issues_worked)\n- renderSessionPreview() - shows learnings (truncated), issue badges, section counts\n- renderViewerSession() - full display of all sections\n- Load sessions from .memory/sessions.jsonl in loadFromFilesystem()\n- getSystemSubdir() handles .memory/ path\n- CSS styles for card and viewer (TUI-inspired dark theme)\n\n**Sessions appear:** In System section under .memory/ subdirectory\n\n**Not yet implemented:**\n- Wiki links for [[#005]] issue references (tracked in #017)\n- Session editing/saving (sessions are read-only from skill)\n- Linking to full transcript drill-down (backlog items #001, #003)"}
{"ts":"2025-12-15T19:18:20Z","type":"note","id":"dp-005","content":"Implementation complete on feature/skill-integration branch but blocked on skill config question.\n\n**Issue:** research-notebook is a special case - it develops the notebook app, not a notebook of content. The dev/ folder is the natural notebook for development work, so sessions/issues should appear there (dev/.issues/, dev/.memory/) not at repo root.\n\n**Problem:** Skills use symlinked directories, so we can't shadow with local config.yaml inside the skill folder. Putting config outside the skill folder feels hacky and breaks self-containment.\n\n**Options explored:**\n1. Environment variable - unclear when/how it gets set\n2. Config file next to symlink (outside skill dir) - breaks self-containment\n3. Command-line args with CLAUDE.md coordination - error-prone\n4. Copy skill instead of symlink - loses auto-updates\n\n**Decision:** Needs more thought. Parking this to discuss skill configuration patterns."}
{"ts":"2025-12-15T20:20:41Z","type":"created","id":"dp-018","title":"Notebook root auto-discovery","issue_type":"feature","priority":2,"description":"Auto-detect .notebook/ in subdirectories when opening parent. See dev/planning/features/repo-dev-companion.md"}
{"ts":"2025-12-15T20:20:53Z","type":"note","id":"dp-018","content":"Problem: File System Access API grants permissions per directory tree. Opening subdirectory (dev/) doesn't grant access to parent resources (.memory/, .issues/).\n\nSolution: Open parent for permissions, auto-detect subdirectories with .notebook/, prompt user to select which notebook to open.\n\nBonus: Enables switching between multiple notebooks in a monorepo.\n\nUnblocks: Session cards (#005) working in dev notebook scenario.\n\nDesign doc: dev/planning/features/repo-dev-companion.md (Option A)"}
{"ts":"2025-12-15T20:20:59Z","type":"note","id":"dp-005","content":"Created issue #018 (Notebook root auto-discovery) to address the permission scope limitation blocking session cards in dev notebook. This is the clean architectural fix rather than a workaround."}
{"ts":"2025-12-16T10:31:48Z","type":"closed","id":"dp-001","reason":"Abandoned: Sessions are process logs, not notebook artifacts. Decision recorded in repo-dev-companion.md"}
{"ts":"2025-12-16T10:31:48Z","type":"closed","id":"dp-002","reason":"Abandoned: Sessions are process logs, not notebook artifacts. Decision recorded in repo-dev-companion.md"}
{"ts":"2025-12-16T10:31:48Z","type":"closed","id":"dp-003","reason":"Abandoned: Sessions are process logs, not notebook artifacts. Decision recorded in repo-dev-companion.md"}
{"ts":"2025-12-16T10:31:48Z","type":"closed","id":"dp-004","reason":"Abandoned: Sessions are process logs, not notebook artifacts. Decision recorded in repo-dev-companion.md"}
{"ts":"2025-12-16T10:31:48Z","type":"closed","id":"dp-005","reason":"Abandoned: Sessions are process logs, not notebook artifacts. Notebook is for lasting artifacts (notes, design docs), not transient process tracking. TUI may be better tool for sessions/issues. Decision recorded in repo-dev-companion.md"}
{"ts":"2025-12-16T10:31:55Z","type":"closed","id":"dp-015","reason":"Abandoned: Issues are process logs, not notebook artifacts. Decision recorded in repo-dev-companion.md"}
{"ts":"2025-12-16T10:31:55Z","type":"closed","id":"dp-016","reason":"Abandoned: Kanban view depended on issue cards (#015), which are no longer planned"}
{"ts":"2025-12-16T10:31:55Z","type":"closed","id":"dp-017","reason":"Abandoned: Wiki links for issues/sessions no longer needed as skill cards are not being implemented"}
{"ts":"2025-12-16T10:31:56Z","type":"closed","id":"dp-018","reason":"Abandoned: Permission scope auto-discovery was needed for skill card integration, which is no longer planned"}
{"ts":"2025-12-26T11:30:00Z","type":"created","id":"dp-019","title":"Multi-file architecture: Directory structure","issue_type":"task","priority":1,"description":"Create directory structure for multi-file architecture and convert themes to ES modules.\n\n**ADR:** dev/planning/architecture/multi-file-architecture.md\n\n**Deliverables:**\n- Create directory structure: css/, js/, defaults/, defaults/templates/\n- Convert themes/*.css to themes/*.js (export CSS as default string)\n- Create themes/index.js registry listing available themes\n- Verify ES module imports work with file:// protocol\n\n**Branch:** refactor/multi-file-architecture","labels":["architecture","refactor"]}
{"ts":"2025-12-26T11:30:01Z","type":"created","id":"dp-020","title":"Multi-file architecture: Extract CSS","issue_type":"task","priority":1,"description":"Extract all CSS from research_notebook.html to css/app.css.\n\n**ADR:** dev/planning/architecture/multi-file-architecture.md (Phase 2)\n\n**Deliverables:**\n- Create css/app.css with all styles from HTML_HEAD section\n- Create index.html with link to stylesheet\n- Verify all styling works correctly\n- Keep @layer structure intact\n\n**Branch:** refactor/multi-file-architecture","depends_on":["dp-019"],"labels":["architecture","refactor"]}
{"ts":"2025-12-26T11:30:02Z","type":"created","id":"dp-021","title":"Multi-file architecture: Extract JavaScript","issue_type":"task","priority":1,"description":"Extract JavaScript from research_notebook.html to ES modules in js/.\n\n**ADR:** dev/planning/architecture/multi-file-architecture.md (Phase 3)\n\n**Deliverables:**\n- Create js/app.js as entry point\n- Extract sections to modules: state.js, render.js, editor.js, filesystem.js, templates.js, pyodide.js, codemirror.js\n- Convert to ES module exports/imports\n- Maintain single source of truth for state\n- Update index.html with script type=\"module\"\n\n**Note:** This is the largest phase. May need to be broken into sub-tasks.\n\n**Branch:** refactor/multi-file-architecture","depends_on":["dp-020"],"labels":["architecture","refactor"]}
{"ts":"2025-12-26T11:30:03Z","type":"created","id":"dp-022","title":"Multi-file architecture: Defaults as ES modules","issue_type":"task","priority":1,"description":"Convert embedded defaults (templates, theme, CLAUDE.md, README.md) to ES modules.\n\n**ADR:** dev/planning/architecture/multi-file-architecture.md (Phase 4)\n\n**Deliverables:**\n- Create defaults/templates/note.js, code.js, bookmark.js (export YAML strings)\n- Create defaults/theme.js (export default CSS)\n- Create defaults/claude-md.js and readme.js\n- Update app to import defaults instead of using inline strings\n- Implement lazy/copy-on-write: defaults load from app, write to notebook on edit\n\n**Branch:** refactor/multi-file-architecture","depends_on":["dp-021"],"labels":["architecture","refactor"]}
{"ts":"2025-12-26T11:30:04Z","type":"created","id":"dp-023","title":"Multi-file architecture: Theme picker UI","issue_type":"feature","priority":2,"description":"Add theme picker to settings for browsing and applying themes.\n\n**ADR:** dev/planning/architecture/multi-file-architecture.md (Phase 5)\n\n**Deliverables:**\n- Add 'Theme' section to settings modal\n- List available themes from themes/index.js registry\n- Show theme name and description\n- Preview button (optional: live preview without saving)\n- Apply button writes selected theme to notebook's .notebook/theme.css\n- Current theme indicator\n\n**Branch:** refactor/multi-file-architecture","depends_on":["dp-022"],"labels":["enhancement","themes"]}
{"ts":"2025-12-26T11:30:05Z","type":"created","id":"dp-024","title":"Multi-file architecture: Cleanup and documentation","issue_type":"task","priority":2,"description":"Final cleanup after multi-file migration.\n\n**ADR:** dev/planning/architecture/multi-file-architecture.md (Phase 6)\n\n**Deliverables:**\n- Remove old research_notebook.html (or keep as legacy reference)\n- Update CLAUDE.md for new structure (navigation, section markers no longer needed)\n- Update README.md with new usage instructions\n- Evaluate generate_index.py - update or remove\n- Update example notebooks if needed\n- Merge to main\n\n**Branch:** refactor/multi-file-architecture","depends_on":["dp-023"],"labels":["documentation","refactor"]}
{"ts":"2025-12-26T11:30:06Z","type":"created","id":"dp-025","title":"Decision: CLAUDE.md initialization for notebooks","issue_type":"task","priority":2,"description":"Decide how notebooks get CLAUDE.md for Claude Code integration.\n\n**ADR:** dev/planning/architecture/multi-file-architecture.md (Open Question 1)\n\n**Options:**\na. CLI initializer: python scripts/init_notebook.py /path/to/notebook\nb. App button: 'Initialize for Claude Code' in toolbar/settings\nc. Documentation only: 'Copy defaults/CLAUDE.md to your notebook'\nd. Auto-create on first save: ensure CLAUDE.md exists when any card is saved\n\n**Considerations:**\n- Claude Code needs CLAUDE.md in notebook directory to work\n- Users may not realize this requirement\n- Option (b) provides discoverability\n- Option (d) is most seamless but may create files unexpectedly\n\n**Outcome:** Document decision in ADR","labels":["decision","architecture"]}
{"ts":"2025-12-26T14:16:22Z","type":"note","id":"dp-025","content":"DECIDED: Use example notebooks as templates. See ADR multi-file-architecture.md Open Question #1. Different use cases (research, tutor, dev) get tailored CLAUDE.md, theme, and README. Card templates only included if customized from defaults."}
{"ts":"2025-12-26T14:16:28Z","type":"closed","id":"dp-025","reason":"Decided: example notebooks as templates. Creating implementation issue."}
{"ts":"2025-12-26T14:18:02Z","type":"created","id":"dp-026","title":"Create example notebook templates","issue_type":"task","priority":2,"description":"Create example notebooks for different use cases, each with tailored CLAUDE.md, theme, and README.\n\n**ADR:** dev/planning/architecture/multi-file-architecture.md (Open Question #1 - DECIDED)\n\n**Deliverables:**\n\n1. **research-notebook/** - Standard research use\n   - CLAUDE.md with research-focused instructions\n   - theme.css pointing to manuscript theme\n   - README.md explaining the template\n\n2. **tutor-notebook/** - AI tutoring collaboration\n   - CLAUDE.md with student collaboration guidelines\n   - theme.css with accessible, friendly theme\n   - README.md explaining the use case\n\n3. **dev-notebook/** - Development/coding focus\n   - CLAUDE.md with code-focused instructions\n   - theme.css pointing to terminal theme\n   - README.md explaining the template\n\n4. **Optional: scripts/new-notebook.py** - CLI helper to list and copy examples\n\n**Principle:** Only include .notebook/templates/*.yaml if genuinely customized for that use case. Standard types inherit from app defaults via lazy/copy-on-write.\n\n**Note:** Existing demo-notebook can be kept or refactored into one of these.","labels":["architecture","examples"]}
{"ts":"2025-12-26T14:18:08Z","type":"updated","id":"dp-026","depends_on":["dp-022"],"reason":"Added dependencies: dp-022"}
{"ts":"2025-12-26T14:21:13Z","type":"note","id":"dp-022","content":"Updated: Remove defaults/claude-md.js and defaults/readme.js from deliverables. These files now live only in example notebooks (see dp-026). defaults/ only contains templates/*.js and theme.js."}
{"ts":"2025-12-26T14:21:13Z","type":"updated","id":"dp-024","depends_on":["dp-023","dp-026"],"reason":"Added dependencies: dp-026"}
{"ts":"2025-12-26T14:28:27Z","type":"note","id":"dp-019","content":"Completed all deliverables:\n- Created directory structure: css/, js/, defaults/, defaults/templates/\n- Converted 4 themes (manuscript, minimal, terminal, handwritten) to ES modules\n- Created themes/index.js registry with loadTheme() and getThemeCSS() helpers\n- Created test-es-modules.html for browser verification\n- Updated themes/README.md with ES module documentation\n\nNode.js testing confirms modules work correctly. Browser testing with file:// protocol should be done manually by opening test-es-modules.html in Chrome/Edge."}
{"ts":"2025-12-26T14:28:35Z","type":"closed","id":"dp-019","reason":"Done - Created multi-file architecture directory structure and converted themes to ES modules. See test-es-modules.html for browser verification."}
{"ts":"2025-12-26T14:34:27Z","type":"note","id":"dp-020","content":"Completed extraction:\n- Created css/app.css with all 2266 lines of CSS\n- Created index.html (6752 lines) linking to css/app.css\n- @layer structure preserved: reset, vendors, base, components, templates, theme\n- Print styles remain unlayered (as intended for proper precedence)\n\nFiles:\n- index.html: 306KB (replaces inline styles with <link> tag)\n- css/app.css: 49KB (extracted CSS)\n- research_notebook.html: 371KB (original, kept for reference during migration)\n\nNeeds manual verification: open index.html in browser to confirm styling works."}
{"ts":"2025-12-26T14:38:44Z","type":"closed","id":"dp-020","reason":"Done - Extracted CSS to css/app.css, created index.html with stylesheet link. Styling verified working."}
{"ts":"2025-12-26T14:59:24Z","type":"note","id":"dp-021","content":"Phase 3 extraction complete: JS extracted to js/app.js (246KB). index.html now 210 lines. Follow-up needed: split app.js into ES modules (state.js, templates.js, etc.)"}
{"ts":"2025-12-26T14:59:36Z","type":"created","id":"dp-027","title":"Multi-file architecture: Split app.js into ES modules","issue_type":"task","priority":2,"description":"Split js/app.js (~6500 lines) into ES modules:\n\n- state.js: Global state variables\n- utilities.js: Helper functions (escapeHtml, formatDate, etc.)\n- templates.js: TEMPLATE_SYSTEM section (~2200 lines)\n- filesystem.js: FILESYSTEM_STORAGE + DATA_PERSISTENCE (~1500 lines)\n- editor.js: GENERIC_EDITOR section (~1350 lines)\n- pyodide.js: PYODIDE_RUNTIME section\n- render.js: RENDER_FUNCTIONS section\n- links.js: INTERNAL_LINKING section\n- thumbnails.js: THUMBNAIL_GENERATION section\n- modals.js: UI modals and small sections\n\nKey challenges:\n- Circular dependencies between templates/filesystem/editor\n- HTML onclick handlers need functions on window object\n- Use late-binding pattern for cross-module deps\n\n**Branch:** refactor/multi-file-architecture","depends_on":["dp-021"],"labels":["architecture","refactor"]}
{"ts":"2025-12-26T15:01:15Z","type":"closed","id":"dp-021","reason":"JS extracted to js/app.js. ES module splitting tracked in dp-027."}
{"ts":"2025-12-26T15:01:54Z","type":"note","id":"dp-027","content":"Learnings from attempted all-in-one refactor:\n\n1. **Circular deps are real**: templates.js \u2194 filesystem.js \u2194 editor.js all call each other\n2. **State vars need setters**: 'let' vars (data, pyodide, etc.) can't be reassigned from other modules - need 'setData()' pattern\n3. **HTML onclick handlers**: Functions like openEditor(), closeViewer() must be exposed on window object\n4. **Late binding pattern**: Import modules at top, but only call cross-module functions inside other functions (not at load time)\n5. **Consider app.js as coordinator**: Import all modules, wire up cross-deps via registration functions, expose onclick handlers on window"}
{"ts":"2025-12-26T15:10:55Z","type":"note","id":"dp-027","content":"Extracted 2 modules: utilities.js (61 lines) and pyodide.js (239 lines). App now uses ES module loading. Internal-linking extraction deferred due to data/viewer dependencies."}
{"ts":"2025-12-26T15:14:06Z","type":"note","id":"dp-027","content":"Fixed: Using regular script loading instead of ES modules for file:// protocol compatibility. Scripts load in order: utilities.js \u2192 pyodide.js \u2192 app.js"}
{"ts":"2025-12-26T15:17:18Z","type":"closed","id":"dp-027","reason":"Abandoned: ES modules require server (incompatible with file:// protocol). Regular script splitting provides no real encapsulation benefit. Single app.js with section markers + generate_index.py is cleaner for this use case."}
{"ts":"2025-12-26T16:26:17Z","type":"closed","id":"dp-022","reason":"Abandoned: ES modules rejected - requires server (incompatible with file:// protocol design goal). Templates/themes can be embedded in js/app.js or loaded differently in the future. See ADR multi-file-architecture.md for full rationale."}
{"ts":"2025-12-26T16:26:24Z","type":"updated","id":"dp-026","depends_on":[],"reason":"Removed dependencies: dp-022"}
{"ts":"2025-12-26T16:26:30Z","type":"updated","id":"dp-023","depends_on":[],"reason":"Removed dependencies: dp-022"}
{"ts":"2025-12-26T16:26:37Z","type":"note","id":"dp-024","content":"Partial completion: research_notebook.html and test-es-modules.html removed. CLAUDE.md and README.md updated for multi-file structure. generate_index.py updated to point at js/app.js. Remaining: merge to main after example notebooks (dp-026) complete."}
{"ts":"2025-12-26T16:29:02Z","type":"note","id":"dp-026","content":"Created 3 example notebooks: research-notebook (manuscript theme), dev-notebook (terminal theme), tutor-notebook (friendly theme). Each has CLAUDE.md, README.md, .notebook/settings.yaml, and .notebook/theme.css. Kept existing demo-notebook as full-featured reference."}
{"ts":"2025-12-26T16:29:07Z","type":"closed","id":"dp-026","reason":"Completed: Created research-notebook, dev-notebook, and tutor-notebook examples. Each has tailored CLAUDE.md, theme.css, README.md, and settings.yaml. Demo-notebook kept as full-featured reference."}
{"ts":"2025-12-26T16:38:59Z","type":"created","id":"dp-028","title":"Remove auto-creation of default Research section","issue_type":"bug","priority":2,"description":"When opening an empty notebook folder, the app automatically creates a 'Research' section (js/app.js:5151-5159). This is unwanted - users should start with an empty notebook and add their first section via the Add Section button.\n\n**Current behavior:**\n- New notebook auto-creates 'Research' section directory\n- settings.yaml includes this section\n\n**Desired behavior:**\n- New notebook starts empty (no sections)\n- User clicks Add Section to create their first section\n- settings.yaml has empty sections array\n\n**Location:** `linkFilesystem()` function around line 5150 in js/app.js\n\n**Note:** Also update `getDefaultSettingsContent()` (line 673) to default to empty sections array."}
{"ts":"2025-12-26T16:39:44Z","type":"closed","id":"dp-028","reason":"Fixed: Removed auto-creation of Research section. New notebooks now start empty. Updated linkFilesystem() and SETTINGS_SCHEMA defaults."}
{"ts":"2025-12-26T16:45:37Z","type":"updated","id":"dp-024","depends_on":["dp-026"],"reason":"Removed dependencies: dp-023"}
{"ts":"2025-12-26T16:45:42Z","type":"updated","id":"dp-024","depends_on":[],"reason":"Removed dependencies: dp-026"}
{"ts":"2025-12-26T16:45:50Z","type":"closed","id":"dp-024","reason":"Completed: Removed old HTML files, updated CLAUDE.md and README.md for multi-file structure, updated generate_index.py for js/app.js, created 3 example notebooks. Theme picker (dp-023) is a separate future feature. Ready for merge to main."}
{"ts":"2025-12-26T17:18:56Z","type":"created","id":"dp-029","title":"Create package.json and Node.js CLI server","issue_type":"task","priority":1,"description":"Foundation for server-based architecture. Create package.json with bin entry for 'notebook' command, and cli.js that serves static files and auto-opens browser. See dev/planning/architecture/multi-file-architecture.md for details.","labels":["architecture"]}
{"ts":"2025-12-26T17:19:05Z","type":"created","id":"dp-030","title":"Convert themes/*.js to real CSS files","issue_type":"task","priority":2,"description":"Extract CSS from themes/manuscript.js, minimal.js, terminal.js, handwritten.js into real .css files. Create themes/index.json registry with id, name, description for each theme. Delete the .js theme files after extraction.","depends_on":["dp-029"],"labels":["themes"]}
{"ts":"2025-12-26T17:19:14Z","type":"created","id":"dp-031","title":"Extract templates from app.js to YAML files","issue_type":"task","priority":2,"description":"Extract templates from getDefaultTemplates() in app.js to defaults/templates/*.yaml (note.yaml, code.yaml, bookmark.yaml, image.yaml, theme.yaml, settings.yaml). Remove getDefaultTemplates() function and embedded strings after extraction.","depends_on":["dp-029"],"labels":["templates"]}
{"ts":"2025-12-26T17:19:24Z","type":"created","id":"dp-032","title":"Update app.js to fetch templates and themes dynamically","issue_type":"task","priority":1,"description":"Modify app.js to load templates via fetch('/defaults/templates/*.yaml') instead of embedded strings. Load theme registry via fetch('/themes/index.json'). Update loadThemeCss() to support loading from /themes/ directory. Remove getDefaultThemeContent() embedded strings.","depends_on":["dp-030","dp-031"],"labels":["architecture"]}
{"ts":"2025-12-26T17:19:34Z","type":"created","id":"dp-033","title":"Add file:// protocol detection with friendly error","issue_type":"task","priority":2,"description":"Detect window.location.protocol === 'file:' on app startup. Show friendly error message with install instructions (npm link, notebook command) instead of broken app. Hide main UI, show only error message.","depends_on":["dp-029"],"labels":["ux"]}
{"ts":"2025-12-26T17:19:44Z","type":"created","id":"dp-034","title":"Add theme picker UI to settings modal","issue_type":"feature","priority":2,"description":"Add 'Theme' section to settings modal with dropdown listing themes from /themes/index.json. On selection: fetch theme CSS, write to .notebook/theme.css, reload. Include 'Custom' option that preserves existing theme. Consider live preview before applying.","depends_on":["dp-032"],"labels":["themes","ux"]}
{"ts":"2025-12-26T17:19:52Z","type":"created","id":"dp-035","title":"Clean up orphaned files and embedded strings","issue_type":"task","priority":3,"description":"After migration: delete themes/*.js files, delete themes/index.js, remove getDefaultTemplates() and getDefaultThemeContent() from app.js, delete defaults/templates/.gitkeep, update .gitignore if needed.","depends_on":["dp-032"],"labels":["cleanup"]}
{"ts":"2025-12-26T17:20:01Z","type":"created","id":"dp-036","title":"Update documentation for server-based workflow","issue_type":"task","priority":2,"description":"Update README.md with new install/run instructions (npm link, notebook command). Update CLAUDE.md architecture section. Update themes/README.md to remove ES module claims. Consider renaming repo or clarifying that 'notebook' is the CLI name.","depends_on":["dp-032"],"labels":["documentation"]}
{"ts":"2025-12-26T17:20:10Z","type":"created","id":"dp-037","title":"Create example notebooks for different use cases","issue_type":"task","priority":3,"description":"Create examples/research-notebook/, examples/tutor-notebook/, examples/dev-notebook/ with appropriate CLAUDE.md, README.md, and theme for each use case. Decide fate of existing demo-notebook. Workflow: cp -r examples/research-notebook my-project","depends_on":["dp-034"],"labels":["examples"]}
{"ts":"2025-12-26T17:20:28Z","type":"closed","id":"dp-023","reason":"Superseded by dp-034 which is part of the new server-based architecture plan"}
{"ts":"2025-12-26T17:21:19Z","type":"note","id":"dp-029","content":"Starting implementation"}
{"ts":"2025-12-26T17:23:25Z","type":"closed","id":"dp-029","reason":"Done - package.json and cli.js created. Server serves static files correctly, npm link works, 'notebook' command available globally."}
{"ts":"2025-12-26T17:31:46Z","type":"closed","id":"dp-030","reason":"Converted all 4 themes from JS modules to real CSS files. Created index.json registry."}
{"ts":"2025-12-26T17:34:06Z","type":"closed","id":"dp-031","reason":"Extracted all 7 templates to defaults/templates/*.yaml files (note, code, bookmark, settings, template, theme, image). Also extracted default theme.css. Function removal deferred to dp-032 when dynamic fetching is implemented."}
{"ts":"2025-12-26T17:45:12Z","type":"closed","id":"dp-032","reason":"Implemented dynamic fetching from server. Templates load from /defaults/templates/, theme registry from /themes/index.json. Removed CLAUDE.md and README.md from modified indicator (user provides manually). Replaced embedded template/theme strings with fetch-cached versions."}
{"ts":"2025-12-26T17:58:45Z","type":"closed","id":"dp-035","reason":"All cleanup complete: themes/*.js and index.js were already removed (replaced with .css and index.json). getDefaultTemplates() and getDefaultThemeContent() are now cache wrappers for server-fetched content (no embedded strings). Removed redundant defaults/templates/.gitkeep."}
{"ts":"2025-12-26T17:59:36Z","type":"closed","id":"dp-037","reason":"Duplicate of dp-026 which was completed earlier. All example notebooks (research-notebook, dev-notebook, tutor-notebook) already exist with tailored CLAUDE.md, README.md, theme.css, and settings.yaml."}
{"ts":"2025-12-26T18:01:00Z","type":"closed","id":"dp-033","reason":"Added file:// protocol detection at app startup. Shows friendly error message with install instructions (npm link, notebook command) and hides main UI."}
{"ts":"2025-12-26T18:05:25Z","type":"closed","id":"dp-034","reason":"Implemented theme picker with base theme + customizations architecture:\n- Added 'theme' field type to editor that renders dropdown populated from /themes/index.json\n- Updated settings template to use new 'theme' type with 'Base Theme' label\n- Modified loadThemeCss() to load base theme from /themes/{id}.css first, then layer .notebook/theme.css customizations on top\n- Theme reloads automatically when settings are saved"}
{"ts":"2025-12-26T18:26:55Z","type":"closed","id":"dp-036","reason":"Documentation updated: CLAUDE.md has new architecture/server sections, themes/README.md updated with theme picker instructions and friendly theme. README.md already had correct npm link/notebook instructions."}
{"ts":"2025-12-26T18:55:01Z","type":"created","id":"dp-038","title":"Quiz template definition","issue_type":"feature","priority":2,"description":"Create defaults/templates/quiz.yaml with schema for quiz cards including: title, author, topic, questions array, attempts array. Define card/viewer layout as 'quiz', set extension mapping for .quiz.json","labels":["ai-tutor","phase-1"]}
{"ts":"2025-12-26T18:55:14Z","type":"created","id":"dp-039","title":"Quiz card preview rendering","issue_type":"feature","priority":2,"description":"Implement renderQuizPreview() function. Show quiz title, question count, and progress indicator if attempts exist (e.g., '2/5 correct, 1 pending review'). Visual indicator for quiz state: not started, in progress, completed.","depends_on":["dp-038"],"labels":["ai-tutor","phase-1"]}
{"ts":"2025-12-26T18:55:14Z","type":"created","id":"dp-040","title":"Quiz viewer rendering (read-only)","issue_type":"feature","priority":2,"description":"Implement renderQuizViewer() for displaying quiz questions. Initially read-only - show all question types (multiple_choice, numeric, short_answer, worked, matching, ordering) with their content, hints, and explanations.","depends_on":["dp-038"],"labels":["ai-tutor","phase-1"]}
{"ts":"2025-12-26T18:55:14Z","type":"created","id":"dp-041","title":"Quiz CSS styling","issue_type":"feature","priority":2,"description":"Add CSS styles for quiz components: .quiz-question, .quiz-options, .quiz-option (selected/correct/incorrect states), .quiz-numeric-input, .quiz-short-answer, .quiz-worked-step, .quiz-hint, .quiz-explanation, .quiz-progress, .quiz-submit","depends_on":["dp-038"],"labels":["ai-tutor","phase-1"]}
{"ts":"2025-12-26T18:55:32Z","type":"created","id":"dp-042","title":"Quiz-taking interactive UI","issue_type":"feature","priority":2,"description":"Add interactive quiz-taking mode in viewer. Input controls per question type: radio buttons (multiple_choice), number input (numeric), textarea (short_answer, worked steps), drag-drop/dropdowns (matching, ordering). Hints revealed on request. Submit button.","depends_on":["dp-040","dp-041"],"labels":["ai-tutor","phase-2"]}
{"ts":"2025-12-26T18:55:32Z","type":"created","id":"dp-043","title":"Quiz auto-grading logic","issue_type":"feature","priority":2,"description":"Implement gradeQuizAttempt(quiz, answers) function. Auto-grade: multiple_choice (compare to correct index), numeric (check within tolerance), matching (compare pairs), ordering (compare order). Mark short_answer and worked as pending_review.","depends_on":["dp-042"],"labels":["ai-tutor","phase-2"]}
{"ts":"2025-12-26T18:55:32Z","type":"created","id":"dp-044","title":"Quiz attempt storage","issue_type":"feature","priority":2,"description":"Implement saveQuizAttempt(card, answers). Store attempts array in quiz file with: timestamp, answers (with questionIndex, answer, correct/reviewed status), score (auto count, pending_review count), review field for Claude feedback.","depends_on":["dp-043"],"labels":["ai-tutor","phase-2"]}
{"ts":"2025-12-26T18:55:32Z","type":"created","id":"dp-045","title":"Quiz review mode UI","issue_type":"feature","priority":2,"description":"After submission, show review mode: answers with correct/incorrect indicators, explanations displayed, 'Awaiting Claude review' badge for pending questions. History mode for viewing past attempts with scores.","depends_on":["dp-044"],"labels":["ai-tutor","phase-2"]}
{"ts":"2025-12-26T18:55:44Z","type":"created","id":"dp-046","title":"Tutor notebook CLAUDE.md","issue_type":"feature","priority":2,"description":"Update examples/tutor-notebook/CLAUDE.md with comprehensive tutoring instructions: role definition, tutoring principles, content creation guidelines, quiz workflow (create/review), file organization, common request handling table, session flow.","labels":["ai-tutor","docs"]}
{"ts":"2025-12-26T18:55:44Z","type":"created","id":"dp-047","title":"Tutor notebook README.md","issue_type":"feature","priority":2,"description":"Update examples/tutor-notebook/README.md with user-facing documentation: how it works (Claude terminal + browser app), getting started steps, suggested subjects structure, learning tips.","labels":["ai-tutor","docs"]}
{"ts":"2025-12-26T18:55:44Z","type":"created","id":"dp-048","title":"End-to-end quiz workflow testing","issue_type":"task","priority":2,"description":"Test complete workflow: Claude creates quiz file \u2192 student opens in browser \u2192 takes quiz \u2192 submits \u2192 auto-graded questions scored \u2192 pending review questions marked \u2192 Claude reviews answers \u2192 provides feedback. Document any issues found.","depends_on":["dp-045","dp-046"],"labels":["ai-tutor","phase-3"]}
{"ts":"2025-12-26T18:55:54Z","type":"created","id":"dp-049","title":"Quiz theme integration","issue_type":"feature","priority":3,"description":"Add quiz-specific CSS variables to theme system (--quiz-correct-bg, --quiz-incorrect-bg, --quiz-pending-bg, etc.). Ensure quiz styling works well with all base themes (manuscript, minimal, terminal, friendly, handwritten).","depends_on":["dp-041"],"labels":["ai-tutor","phase-4"]}
{"ts":"2025-12-26T18:55:54Z","type":"created","id":"dp-050","title":"Quiz progress tracking","issue_type":"feature","priority":3,"description":"Enhanced progress tracking: aggregate quiz stats across notebook, show mastery by topic, identify areas needing reinforcement. Optional progress/ section for session logs and analytics.","depends_on":["dp-044"],"labels":["ai-tutor","phase-4"]}
{"ts":"2025-12-26T19:01:24Z","type":"closed","id":"dp-038","reason":"Implemented quiz template with full schema for 6 question types"}
{"ts":"2025-12-26T19:05:57Z","type":"closed","id":"dp-039","reason":"Implemented renderQuizPreview with progress indicators"}
{"ts":"2025-12-26T19:05:57Z","type":"closed","id":"dp-040","reason":"Implemented renderQuizViewer with all 6 question type renderers"}
{"ts":"2025-12-26T19:05:58Z","type":"closed","id":"dp-041","reason":"Added comprehensive CSS for quiz cards and viewer"}
{"ts":"2025-12-26T19:12:59Z","type":"note","id":"dp-042","content":"Design change: Make viewer interactive for quiz-taking rather than separate mode. Viewer shows Take Quiz mode by default, switches to Review Results after submission."}
{"ts":"2025-12-26T19:25:19Z","type":"closed","id":"dp-042","reason":"Implemented interactive quiz-taking UI with input controls for all 6 question types"}
{"ts":"2025-12-26T19:25:25Z","type":"closed","id":"dp-043","reason":"Implemented gradeQuizAttempt() with auto-grading for multiple_choice, numeric, matching, ordering; pending_review for short_answer, worked"}
{"ts":"2025-12-26T19:25:29Z","type":"closed","id":"dp-044","reason":"Implemented saveQuizAttempt() that persists attempts to card and re-renders viewer"}
{"ts":"2025-12-26T19:25:34Z","type":"closed","id":"dp-045","reason":"Review mode implemented: viewer shows results after submission with Retake button, correct/incorrect indicators, and explanations"}
{"ts":"2025-12-26T19:36:58Z","type":"created","id":"dp-051","title":"Retake Quiz button UX issues","issue_type":"bug","priority":2,"description":"Retake Quiz button doesn't update the viewer immediately. Current behavior: clicking Retake appears to do nothing, but closing and reopening the viewer shows the quiz reset to interactive mode.\n\nRoot cause investigation:\n- Fixed selector from '.viewer-body' to '#viewerContent' \n- But getTemplateForCard() function doesn't exist - need to use templateRegistry[card.template || card.type]\n- Even after fix, the re-render may not be working as expected\n\nExpected behavior: Clicking Retake should immediately show the interactive quiz UI without needing to close/reopen the modal.","labels":["ai-tutor","phase-2"]}
{"ts":"2025-12-26T20:19:37Z","type":"closed","id":"dp-051","reason":"Fixed: replaced getTemplateForCard() with templateRegistry[card.template || card.type] in both retakeQuiz and saveQuizAttempt"}
{"ts":"2025-12-26T20:56:45Z","type":"closed","id":"dp-048","reason":"Successfully tested end-to-end: quiz submission, auto-grading, pending review, Claude file edit for review, filesystem observer auto-refresh of viewer"}
{"ts":"2025-12-26T21:00:03Z","type":"created","id":"dp-052","title":"Optional self-review restriction for quiz answers","issue_type":"feature","priority":2,"description":"Add setting to control who can review pending quiz answers in the UI.\n\n**Use case:** In tutoring scenarios, students shouldn't self-mark - only the tutor (Claude or teacher) should review.\n\n**Proposed approach:**\n- Add `quiz_self_review: true|false` setting in .notebook/settings.yaml (default: true)\n- When false, pending_review questions show 'Awaiting review' instead of Mark Correct/Incorrect buttons\n- Claude can always review by editing the file directly (bypasses UI restriction)\n- Teachers could toggle this setting when they want to allow self-review\n\n**Alternative:** Role-based approach with `role: student|teacher` in settings, but this may be over-engineering for the current use case.\n\n**UI when self-review disabled:**\n- Show explanation (if available)\n- Show 'Awaiting review' badge where buttons would be\n- Review feedback still displays once Claude/teacher adds it","labels":["ai-tutor","phase-4"]}
{"ts":"2025-12-26T21:02:21Z","type":"closed","id":"dp-052","reason":"Implemented quiz_self_review setting - when false, shows 'Awaiting review' instead of Mark buttons"}
{"ts":"2025-12-26T21:09:27Z","type":"closed","id":"dp-046","reason":"Comprehensive CLAUDE.md written with: role definition, tutoring principles, quiz system docs (creating/reviewing), question types table, content creation examples, common requests table, session flow, and tips."}
{"ts":"2025-12-26T21:09:28Z","type":"closed","id":"dp-047","reason":"README.md written with: how it works explanation, getting started steps, what you can do examples, organizing learning, quiz types table, and learning tips."}
{"ts":"2025-12-27T17:01:14Z","type":"created","id":"dp-053","title":"quiz-response template and card type","issue_type":"feature","priority":2,"description":"Define the quiz-response template for storing student submissions with grade hierarchy.\n\nSchema fields:\n- studentId (string, e.g., 's001')\n- quizId (reference to quiz card)\n- responseId (Google Forms response ID for export)\n- submittedAt (ISO timestamp)\n- answers[] with questionIndex, answer, autoGrade, claudeGrade, teacherGrade\n- totalScore, maxScore\n- exportedToForms, exportedAt\n\nGrade hierarchy:\n1. autoGrade - computed on import for objective questions (immutable)\n2. claudeGrade - AI-generated suggestion (score, feedback, gradedAt)\n3. teacherGrade - final authority (score, feedback, reviewedAt, reviewer)\n\nTemplate config:\n- card.layout and viewer.layout for displaying responses\n- editor.fields for teacher grade editing\n- Status indicators: pending review, reviewed, exported\n\nLocation: .notebook/templates/quiz-response.yaml (or in getDefaultTemplates())","labels":["phase-1","infrastructure"]}
{"ts":"2025-12-27T17:01:32Z","type":"created","id":"dp-054","title":"External roster management for privacy-by-default","issue_type":"feature","priority":2,"description":"Implement student ID \u2194 name/email mapping stored outside the notebook.\n\nRoster file structure (~/.notebook/rosters/{quiz-id}-roster.yaml):\nstudents:\n  s001:\n    name: 'Alice Smith'\n    email: 'alice@school.edu'\n    responseId: '2_ABaOnud...'\n  s002:\n    name: 'Bob Jones'\n    ...\n\nSettings integration (.notebook/settings.yaml):\ngrading:\n  roster_path: '~/.notebook/rosters/'\n  show_student_names: true  # UI toggle\n\nImplementation:\n- tools/grading/manage_roster.py script\n- Create roster on response import\n- Look up names for browser UI display\n- Look up responseId for grade export\n- CLI commands: create, add-student, lookup, export\n\nBrowser integration:\n- Load roster when rendering response cards (if show_student_names: true)\n- Display 'Alice Smith (s001)' vs 'Student s001'\n- Toggle for blind grading mode","labels":["phase-1","infrastructure","privacy"]}
{"ts":"2025-12-27T17:01:51Z","type":"created","id":"dp-055","title":"Bulk API grading with context caching","issue_type":"feature","priority":1,"description":"Implement tools/grading/grade_responses.py for efficient batch grading.\n\nArchitecture:\n- Uses Anthropic Batch API with prompt caching\n- Each student graded independently (no order effects)\n- Shared context (rubric, model answer, calibration) cached once\n- ~0.75x cost of single-prompt approach\n\nInput format (grading_context.json):\nsystem_instructions: |\n  You are grading student quiz responses. Grade based solely on the rubric...\nquiz:\n  title: 'Photosynthesis Quiz'\nrubric:\n  question_3:\n    max_score: 5\n    criteria: |\n      5 points: Complete explanation...\n    model_answer: |\n      Plants use sunlight...\ncalibration_examples:\n  - answer: '...'\n    score: 2\n    feedback: '...'\n\nInput format (pending_responses.json):\n- studentId \u2192 answer text mapping\n\nOutput format (grades.json):\n- studentId \u2192 {score, feedback}\n\nProvider abstraction:\nPROVIDERS = {\n  'anthropic': AnthropicBatchGrader,\n  'openai': OpenAIBatchGrader,\n  'google': GoogleBatchGrader,\n  'local': OllamaGrader,\n}\n\nCLI: python grade_responses.py --provider anthropic --model claude-sonnet-4-20250514 --context context.json --responses responses.json --output grades.json","labels":["phase-1","infrastructure","grading"]}
{"ts":"2025-12-27T17:04:02Z","type":"created","id":"dp-056","title":"Summary statistics generation","issue_type":"feature","priority":2,"description":"Implement tools/grading/generate_stats.py for class and student analytics.\n\nClass summary output:\n- Total students, submitted count, graded count\n- Score distribution (histogram buckets)\n- Per-question analysis (% correct, average score, common errors)\n- Top performers and needs-support lists (using student IDs)\n\nStudent progress output:\n- Quiz performance over time\n- Topics mastered vs needs review\n- Average and trend\n\nOutput formats:\n- Markdown (for notebook cards)\n- JSON (for further processing)\n- CSV (for spreadsheet export)\n\nCLI:\npython generate_stats.py --quiz-id photosynthesis --format markdown\npython generate_stats.py --student s001 --format json\npython generate_stats.py --quiz-id photosynthesis --format csv --output gradebook.csv\n\nIntegration with roster:\n- Stats use student IDs internally\n- Optional name lookup for exports (--include-names flag)","depends_on":["dp-053"],"labels":["phase-1","infrastructure","analytics"]}
{"ts":"2025-12-27T17:04:18Z","type":"created","id":"dp-057","title":"Google Forms bridge: project setup and structure","issue_type":"task","priority":2,"description":"Set up google-forms-bridge/ directory with Apps Script project.\n\nFiles to create:\n- appsscript.json (manifest with OAuth scopes)\n- Code.gs (main entry points)\n- ExportForm.gs (form structure \u2192 JSON)\n- ImportQuiz.gs (JSON \u2192 form questions)\n- ExportResponses.gs (student answers \u2192 JSON)\n- ImportGrades.gs (grades/feedback \u2192 form)\n- Utils.gs (shared helpers)\n- README.md (clasp setup instructions)\n\nRequired OAuth scopes:\n- https://www.googleapis.com/auth/forms\n- https://www.googleapis.com/auth/forms.responses.readonly\n\nREADME should cover:\n- clasp installation (npm install -g @google/clasp)\n- OAuth login (clasp login)\n- Project creation (clasp create)\n- Deployment (clasp deploy)\n- Testing functions (clasp run)","labels":["phase-2","google-forms"]}
{"ts":"2025-12-27T17:04:32Z","type":"created","id":"dp-058","title":"Google Forms bridge: exportFormToJSON","issue_type":"feature","priority":2,"description":"Implement ExportForm.gs to export Google Form structure to JSON.\n\nFunction signature:\nfunction exportFormToJSON(formId) {\n  // Returns: { title, description, questions[], settings }\n}\n\nQuestion mapping (Google Forms \u2192 our schema):\n- ChoiceQuestion (RADIO) \u2192 multiple_choice\n- ChoiceQuestion (CHECKBOX) \u2192 multiple_choice + allowMultiple\n- ChoiceQuestion (DROP_DOWN) \u2192 multiple_choice + display:'dropdown'\n- TextQuestion (short) \u2192 short_answer\n- TextQuestion (paragraph) \u2192 worked\n- ScaleQuestion \u2192 scale\n- DateQuestion \u2192 date\n- TimeQuestion \u2192 time\n- RatingQuestion \u2192 rating\n- Grid \u2192 grid\n\nFor each question, extract:\n- questionId, title, description\n- type-specific fields (options, correct answer, points)\n- required flag, points value\n\nUsage via clasp:\nclasp run exportFormToJSON -p '[\"FORM_ID\"]' > form.json","depends_on":["dp-057"],"labels":["phase-2","google-forms"]}
{"ts":"2025-12-27T17:04:49Z","type":"created","id":"dp-059","title":"Google Forms bridge: createFormFromJSON","issue_type":"feature","priority":2,"description":"Implement ImportQuiz.gs to create/update Google Forms from quiz JSON.\n\nFunctions:\nfunction createFormFromJSON(quizJSON) {\n  // Creates new Form, returns { formId, editUrl, viewUrl }\n}\n\nfunction updateFormFromJSON(formId, quizJSON) {\n  // Updates existing Form, returns { formId, editUrl, viewUrl }\n}\n\nQuestion mapping (our schema \u2192 Google Forms):\n- multiple_choice \u2192 ChoiceQuestion (RADIO/CHECKBOX/DROP_DOWN based on flags)\n- short_answer \u2192 TextQuestion (short)\n- worked \u2192 TextQuestion (paragraph)\n- numeric \u2192 TextQuestion (with regex validation if possible)\n- scale \u2192 ScaleQuestion\n- grid \u2192 Grid\n- ordering \u2192 SKIP with warning (not supported)\n- matching \u2192 Grid (with semantic mismatch warning)\n\nFor each question, set:\n- title, description, helpText\n- type-specific config (options, correct answer, points)\n- required flag, points value\n\nReturn warnings array for incompatible question types.\n\nUsage via clasp:\nclasp run createFormFromJSON -p '[{...quizJSON}]'","depends_on":["dp-057"],"labels":["phase-2","google-forms"]}
{"ts":"2025-12-27T17:05:02Z","type":"created","id":"dp-060","title":"Google Forms bridge: exportResponsesToJSON","issue_type":"feature","priority":2,"description":"Implement ExportResponses.gs to export student submissions from Google Forms.\n\nFunction signature:\nfunction exportResponsesToJSON(formId) {\n  // Returns: { \n  //   formId,\n  //   responses: [{ \n  //     responseId, \n  //     email, \n  //     name,  // if collected\n  //     submittedAt, \n  //     answers: [{ questionId, answer }] \n  //   }] \n  // }\n}\n\nAnswer formats by question type:\n- Multiple choice: selected option index or indices (array for checkbox)\n- Text: string\n- Scale: number\n- Date/Time: ISO string\n- Grid: array of [row, column] pairs\n- Rating: number\n\nHandle edge cases:\n- Partial submissions\n- Multiple submissions per respondent (take latest)\n- Anonymous vs identified respondents\n\nUsage via clasp:\nclasp run exportResponsesToJSON -p '[\"FORM_ID\"]' > responses.json","depends_on":["dp-057"],"labels":["phase-2","google-forms"]}
{"ts":"2025-12-27T17:05:17Z","type":"created","id":"dp-061","title":"Google Forms bridge: submitGradesToForm","issue_type":"feature","priority":2,"description":"Implement ImportGrades.gs to submit grades and feedback to Google Forms.\n\nFunction signature:\nfunction submitGradesToForm(formId, grades) {\n  // grades: [{ \n  //   responseId, \n  //   scores: [{ questionIndex, score, feedback }],\n  //   totalScore,\n  //   generalFeedback\n  // }]\n  // Returns: { submitted: number, errors: [] }\n}\n\nImplementation:\n- Use Form.submitGrades() or equivalent Apps Script API\n- Set per-question scores and feedback\n- Set overall feedback if provided\n- Handle partial failures gracefully\n\nValidation before submission:\n- Check all responseIds exist in form\n- Validate scores within question max points\n- Warn on missing grades for any questions\n\nUsage via clasp:\nclasp run submitGradesToForm -p '[\"FORM_ID\", [...grades]]'","depends_on":["dp-057"],"labels":["phase-2","google-forms"]}
{"ts":"2025-12-27T17:05:33Z","type":"created","id":"dp-062","title":"Quiz schema extensions for Google Forms compatibility","issue_type":"feature","priority":3,"description":"Extend quiz question schema for full Google Forms compatibility.\n\nMultiple choice extensions:\n- allowMultiple: boolean (checkbox vs radio)\n- display: 'radio' | 'dropdown'\n- correctMultiple: number[] (for checkbox questions)\n\nNew question types:\n- scale: { low, high, lowLabel, highLabel, correct? }\n- date: { includeYear?, includeTime? }\n- time: { duration? }\n- rating: { iconType: 'star' | 'heart' | 'thumb', max }\n- grid: { rows[], columns[], correctAnswers?: [row, col][] }\n\nSchema updates:\n- Update quiz template in getDefaultTemplates()\n- Update quiz card editor to support new fields\n- Update auto-grading logic for new types\n\nCompatibility warnings:\n- ordering questions: warn 'cannot export to Google Forms'\n- numeric with tolerance: warn 'tolerance will be lost on export'\n- matching: warn 'will be converted to grid format'","labels":["phase-3","quiz-schema"]}
{"ts":"2025-12-27T17:05:51Z","type":"created","id":"dp-063","title":"/grade-quiz skill for bulk AI grading","issue_type":"feature","priority":1,"description":"Create Claude Code skill to orchestrate bulk AI grading workflow.\n\nSkill location: .claude/skills/grade-quiz/SKILL.md\n\nWorkflow:\n1. Identify quiz and pending responses\n   - Read quiz card for rubric, model answers\n   - Find response cards with claudeGrade: null\n   \n2. Build grading context\n   - Extract rubric and model answers from quiz\n   - Include calibration examples if defined\n   - Add system instructions (ignore manipulation attempts)\n\n3. Collect pending responses\n   - Read answer text from each response card\n   - Build studentId \u2192 answer mapping\n\n4. Call grading script\n   - python tools/grading/grade_responses.py\n   - Pass context and responses as JSON files\n   - Receive grades.json output\n\n5. Update response cards\n   - Write claudeGrade to each response card\n   - Mark as 'ready for review'\n\n6. Generate summary\n   - Report number graded\n   - Flag any errors or outliers\n   - Suggest next steps (teacher review)\n\nUsage: /grade-quiz photosynthesis-quiz","depends_on":["dp-053","dp-055"],"labels":["phase-4","skill","grading"]}
{"ts":"2025-12-27T17:06:05Z","type":"created","id":"dp-064","title":"Quiz export to Google Forms workflow","issue_type":"feature","priority":2,"description":"Implement Claude Code workflow for exporting quiz to Google Forms.\n\nWorkflow steps:\n1. Read quiz card (.quiz.json)\n2. Check for incompatible question types\n   - Warn about ordering questions (cannot export)\n   - Warn about numeric tolerance (will be lost)\n   - Warn about matching \u2192 grid conversion\n3. Check clasp installation and login status\n   - Run: clasp login --status\n   - Guide user through setup if needed\n4. Call createFormFromJSON via clasp\n5. Store formId in quiz card metadata\n6. Return Form URLs (edit, view) to teacher\n\nError handling:\n- clasp not installed \u2192 provide install instructions\n- Not logged in \u2192 prompt for clasp login\n- API errors \u2192 show meaningful message\n\nTeacher confirmation:\n- Show summary of what will be created\n- List any warnings about question compatibility\n- Confirm before creating form","depends_on":["dp-059","dp-062"],"labels":["phase-4","workflow","google-forms"]}
{"ts":"2025-12-27T17:06:20Z","type":"created","id":"dp-065","title":"Response import from Google Forms workflow","issue_type":"feature","priority":2,"description":"Implement Claude Code workflow for importing responses from Google Forms.\n\nWorkflow steps:\n1. Read quiz card to get formId\n2. Call exportResponsesToJSON via clasp\n3. Generate student IDs (s001, s002, ...)\n4. Create/update roster file\n   - Map studentId \u2192 name, email, responseId\n   - Store in external roster path\n5. Create response section ({quiz-id}-responses/)\n6. Create response card per student\n   - studentId only (no name/email in card)\n   - Store all answers\n   - Auto-grade objective questions immediately\n   - Mark open-ended as pending review\n7. Report summary\n   - Number of responses imported\n   - Number auto-graded vs pending review\n   - Any errors or duplicates\n\nDuplicate handling:\n- If response already exists, update with latest submission\n- Track submittedAt to identify newest\n\nAuto-grading on import:\n- multiple_choice: compare to correct answer\n- numeric: check within tolerance\n- matching/ordering: check sequence\n- short_answer/worked: mark as pending","depends_on":["dp-053","dp-054","dp-060"],"labels":["phase-4","workflow","google-forms"]}
{"ts":"2025-12-27T17:06:33Z","type":"created","id":"dp-066","title":"Grade export to Google Forms workflow","issue_type":"feature","priority":2,"description":"Implement Claude Code workflow for exporting grades to Google Forms.\n\nPre-export validation:\n1. Check all responses have final grades\n   - teacherGrade present, OR\n   - claudeGrade approved by teacher\n2. Warn about unreviewed responses\n3. Require teacher confirmation before export\n\nWorkflow steps:\n1. Read all response cards\n2. Look up responseId from roster file\n3. Build grades array with:\n   - responseId (from roster)\n   - Per-question scores and feedback\n   - Total score\n   - General feedback (if any)\n4. Call submitGradesToForm via clasp\n5. Mark each response as exportedToForms: true, exportedAt: timestamp\n6. Report summary\n   - Number of grades exported\n   - Any errors\n\nSafety checks:\n- Never export without teacher confirmation\n- Show what will be exported before sending\n- Require explicit 'yes' to proceed\n- Log export event for audit trail","depends_on":["dp-054","dp-061"],"labels":["phase-4","workflow","google-forms"]}
{"ts":"2025-12-27T17:06:50Z","type":"created","id":"dp-067","title":"Class summary and analytics generation","issue_type":"feature","priority":3,"description":"Implement class summary view and analytics as notebook cards.\n\nClass summary card (markdown or code):\n- Total students, submitted, graded counts\n- Score distribution histogram\n- Per-question analysis:\n  - % correct (for objective)\n  - Average score (for open-ended)\n  - Common errors identified by Claude\n- Top performers list (by student ID)\n- Needs-support list (by student ID)\n\nGeneration:\n- Claude Code reads response cards\n- Calls generate_stats.py for raw data\n- Generates formatted markdown card\n- Creates/updates summary card in quiz section\n\nVisualizations (for code cards with matplotlib):\n- Score distribution bar chart\n- Question difficulty chart\n- Score trend over time (if multiple quizzes)\n\nTeacher can regenerate summary after grading changes.","depends_on":["dp-053","dp-056"],"labels":["phase-5","analytics"]}
{"ts":"2025-12-27T17:07:05Z","type":"created","id":"dp-068","title":"Student progress tracking across quizzes","issue_type":"feature","priority":3,"description":"Track and visualize individual student progress over time.\n\nData aggregation:\n- Find all response cards for a student ID across quizzes\n- Extract scores, dates, topics\n- Calculate trends and averages\n\nProgress view (per student):\n- Quiz performance timeline\n- Topics mastered vs needs review\n- Average score and trend direction\n- Comparison to class average (optional)\n\nImplementation:\n- generate_stats.py --student s001 --format markdown\n- Creates progress card in appropriate location\n- Updates when new quiz results available\n\nPrivacy consideration:\n- Progress cards use student ID only\n- Teacher can cross-reference with roster for name\n- No PII stored in notebook files","depends_on":["dp-053","dp-056"],"labels":["phase-5","analytics"]}
{"ts":"2025-12-27T17:09:49Z","type":"created","id":"dp-069","title":"Gradebook CSV/spreadsheet export","issue_type":"feature","priority":3,"description":"Export grades to CSV format for external use and school records.\n\nOutput format:\n- Columns: StudentID, Q1, Q2, ..., Total, Percentage\n- Optional: include student names (--include-names flag, requires roster)\n- Compatible with Excel, Google Sheets, school grade systems\n\nCLI:\npython generate_stats.py --quiz-id photosynthesis --format csv --output gradebook.csv\npython generate_stats.py --quiz-id photosynthesis --format csv --include-names --output gradebook.csv\n\nAdditional exports:\n- Per-question breakdown (for item analysis)\n- Feedback export (student, question, feedback text)\n- Multi-quiz gradebook (all quizzes for a class)\n\nIntegration:\n- Claude Code can generate on request\n- Place in notebook root or specified location\n- Not a notebook card (external file for school systems)","depends_on":["dp-054","dp-056"],"labels":["phase-5","analytics","export"]}
{"ts":"2025-12-28T11:24:17Z","type":"created","id":"dp-070","title":"Test fixtures for grading and Google Forms workflows","issue_type":"task","priority":1,"description":"Create sample data and scripts for testing new features without real Google Forms.\n\nFixtures needed:\n1. Sample quiz with multiple question types\n2. Sample responses (20-30 students with varied answers)\n3. Sample roster file for privacy testing\n4. Mock grading context with rubric and calibration examples\n5. Expected grades output for verification\n\nTesting approaches:\n- Unit tests for grade_responses.py (mock API calls)\n- Integration tests using local/mock provider\n- Google Forms bridge: mock clasp responses for offline testing\n- End-to-end: sample notebook in examples/ with pre-populated quiz data\n\nThis enables development without:\n- Real Anthropic API calls during development\n- Real Google Forms account\n- Real student data","labels":["phase-1","testing","infrastructure"]}
{"ts":"2025-12-28T11:35:55Z","type":"closed","id":"dp-053","reason":"Implemented quiz-response template with:\n- Template schema (studentId, quizId, answers with grade hierarchy, status, export tracking)\n- Card preview (student ID, score, status badge)\n- Viewer (question text from quiz, student answers, grade cards for auto/claude/teacher)\n- Teacher grading UI (score input, feedback, approve AI grade button)\n- CSS styling (color-coded statuses, grade hierarchy display)\n- Sample response data (3 students with different grading states)\n- Extension registry (.response.json)\n- Template index registration"}
{"ts":"2025-12-28T17:09:15Z","type":"closed","id":"dp-062","reason":"Implemented quiz type extensions: added scale and grid question types, extended multiple_choice with allowMultiple/correctMultiple/display fields. Added rendering, interaction handlers, grading logic, and CSS for all new types."}
{"ts":"2025-12-28T17:12:43Z","type":"closed","id":"dp-054","reason":"Implemented manage_roster.py with create (from Google Forms export), lookup (by ID or email), and list commands. Stores roster in YAML format externally."}
{"ts":"2025-12-28T17:12:43Z","type":"closed","id":"dp-057","reason":"Created google-forms-bridge/ with appsscript.json, Code.gs, ExportResponses.gs, ImportGrades.gs, and README.md with clasp setup instructions."}
{"ts":"2025-12-28T17:12:43Z","type":"closed","id":"dp-060","reason":"Implemented ExportResponses.gs with getFormMetadata, getQuestions, and exportResponses functions for extracting student submissions from Google Forms."}
{"ts":"2025-12-28T17:12:43Z","type":"closed","id":"dp-061","reason":"Implemented ImportGrades.gs with importFromJSON function for submitting grades and feedback back to Google Forms quiz responses."}
{"ts":"2025-12-28T17:14:42Z","type":"note","id":"dp-055","content":"PARTIAL: grade_responses.py exists with prompt caching and dry-run mode. MISSING: Batch API (uses sequential single requests), provider abstraction (only Anthropic), OpenAI/Google/Ollama providers."}
{"ts":"2025-12-28T17:14:42Z","type":"note","id":"dp-058","content":"NOT STARTED: ExportForm.gs not yet created. ExportResponses.gs exists but handles response export, not form structure export. Need to implement exportFormToJSON for quiz import workflow."}
{"ts":"2025-12-28T17:14:42Z","type":"note","id":"dp-059","content":"NOT STARTED: ImportQuiz.gs not yet created. Need createFormFromJSON and updateFormFromJSON to push quiz definitions to Google Forms."}
{"ts":"2025-12-28T17:48:23Z","type":"created","id":"dp-071","title":"Per-question point values and partial credit scoring","issue_type":"feature","priority":2,"description":"Current quiz scoring uses binary correct/incorrect with simple count (n/N correct). Google Forms supports richer scoring:\n\n**Google Forms scoring model:**\n- Per-question point values (e.g., Q1 worth 5 points, Q2 worth 10 points)\n- Partial credit for some types (e.g., 3/5 points for partial match)\n- Total score as points, not just correct count\n- Percentage calculation\n\n**Current model limitations:**\n- All questions worth equal weight (1 point)\n- Binary correct/incorrect only\n- Score displayed as 'n/N correct'\n\n**Proposed enhancements:**\n1. Add optional `points` field to questions (default: 1)\n2. Add optional `partialCredit` field for checkbox/grid questions\n3. Calculate total score as sum of earned points / max points\n4. Display score as points and/or percentage\n5. Support partial credit for:\n   - Checkbox: points proportional to correct selections\n   - Grid: points per correct row\n   - Numeric: partial credit within wider tolerance bands\n\n**Schema changes:**\n```json\n{\n  \"type\": \"multiple_choice\",\n  \"question\": \"...\",\n  \"points\": 5,\n  \"partialCredit\": true\n}\n```\n\n**Score output:**\n```json\n{\n  \"score\": {\n    \"earned\": 35,\n    \"possible\": 50,\n    \"percentage\": 70,\n    \"correct\": 5,\n    \"total\": 7\n  }\n}\n```","labels":["phase-2","grading","google-forms"]}
{"ts":"2025-12-28T17:59:09Z","type":"closed","id":"dp-071","reason":"Implemented per-question point values and partial credit scoring"}
{"ts":"2025-12-28T17:59:18Z","type":"note","id":"dp-071","content":"**Changes to gradeQuizAttempt():**\n- Added q.points support (default 1) for per-question point values\n- Added q.partialCredit flag (default true) to control partial credit\n- Added q.toleranceBands for numeric questions with graduated partial credit\n- Each answer now includes autoGrade: { status, score, maxScore }\n- Score object now includes { earned, possible, percentage, correct, total, pending_review }\n\n**Partial credit implementation:**\n- Checkbox: (correct selections - incorrect selections) / total correct\n- Grid: proportion of correct rows\n- Matching: proportion of correct pairs\n- Ordering: proportion of items in correct position\n- Numeric: toleranceBands allow graduated scoring [{tolerance: 0.5, credit: 0.5}, ...]\n\n**UI updates:**\n- Quiz viewer shows points-based score with percentage\n- New partial status badge (amber color) shows earned/max points\n- Quiz preview shows points format when available\n\n**Schema updates:**\n- quiz.yaml: documented points, partialCredit, toleranceBands fields\n- Updated score object schema with new fields"}
{"ts":"2025-12-28T18:35:05Z","type":"created","id":"dp-072","title":"Quiz editor modal for teachers","issue_type":"feature","priority":1,"description":"Build a proper editor UI for quiz cards so teachers can create/edit quizzes in the notebook.\n\nCurrent state:\n- Quiz schema is well-defined in defaults/templates/quiz.yaml\n- Quiz viewer/taking UI works well\n- Editor falls back to raw YAML (editor.layout: yaml)\n\nNeeded editor features:\n1. Question list with add/remove/reorder (drag handles)\n2. Question type selector (dropdown)\n3. Type-specific fields:\n   - multiple_choice: options list, correct answer selector, allowMultiple toggle, display style\n   - numeric: answer, tolerance, tolerance bands for partial credit\n   - short_answer/worked: model answer, rubric/grading criteria\n   - matching: pairs editor\n   - ordering: items with correct order\n   - scale: low/high bounds, labels\n   - grid: rows/columns editors, correct answers matrix\n4. Common fields per question: points, hint, explanation\n5. Quiz metadata: title, author, topic, description\n\nUI approach:\n- Questions as expandable/collapsible sections\n- Currently-editing question expands to show all fields\n- Type change resets type-specific fields with confirmation\n- Preview button to see question as student would\n\nImplementation:\n- New editor layout: 'quiz' (in GENERIC_EDITOR section)\n- renderQuizEditor() function\n- Type-specific field renderers\n- Wire up to existing save/close flow","labels":["phase-1","quiz","editor"]}
{"ts":"2025-12-28T18:45:30Z","type":"created","id":"dp-073","title":"Quiz editor: Core infrastructure (Phase 1)","issue_type":"feature","priority":1,"description":"Implement core quiz editor with basic question types.\n\nDesign doc: dev/planning/features/quiz-editor.md\n\nDeliverables:\n1. Question list UI with add/remove/reorder (drag handles)\n2. multiple_choice type fully working:\n   - Options list editor with add/remove\n   - Correct answer selector (radio buttons)\n   - allowMultiple toggle for checkbox mode\n3. short_answer and worked types (basic text display)\n4. Common fields: question (markdown), points (number)\n5. Advanced section (collapsible): hint, explanation, modelAnswer, rubric\n6. Type change confirmation dialog\n7. getEditorFieldValue() support for questions array\n\nFiles to modify:\n- js/app.js: Add questions type handling in renderEditorField() (~300 lines)\n- defaults/templates/quiz.yaml: Change editor.layout, add fields config\n- css/app.css: Question editor styles (~100 lines)","depends_on":["dp-072"],"labels":["phase-1","quiz","editor"]}
{"ts":"2025-12-28T18:45:42Z","type":"created","id":"dp-074","title":"Quiz editor: Additional types (Phase 2)","issue_type":"feature","priority":2,"description":"Extend quiz editor with additional question types.\n\nDesign doc: dev/planning/features/quiz-editor.md\n\nDeliverables:\n1. numeric type:\n   - Answer input (number)\n   - Tolerance input\n   - Optional tolerance bands for partial credit\n2. scale type:\n   - Low/high bounds inputs\n   - Label inputs (lowLabel, highLabel)\n   - Optional correct value\n3. dropdown display mode for multiple_choice\n\nFiles to modify:\n- js/app.js: Add type-specific field renderers\n- css/app.css: Type-specific styles","depends_on":["dp-073"],"labels":["phase-2","quiz","editor"]}
{"ts":"2025-12-28T18:45:42Z","type":"created","id":"dp-075","title":"Quiz editor: Complex types (Phase 3)","issue_type":"feature","priority":2,"description":"Add editors for complex question types.\n\nDesign doc: dev/planning/features/quiz-editor.md\n\nDeliverables:\n1. matching type:\n   - Pairs editor (two-column table)\n   - Add/remove pairs\n2. ordering type:\n   - Items list showing correct order\n   - Reorderable via drag handles\n3. grid type:\n   - Rows list editor\n   - Columns list editor\n   - Correct answers matrix (click cells to toggle)\n\nFiles to modify:\n- js/app.js: Add complex type editors\n- css/app.css: Grid/matrix styles","depends_on":["dp-074"],"labels":["phase-3","quiz","editor"]}
{"ts":"2025-12-28T20:10:24Z","type":"closed","id":"dp-073","reason":"Implemented quiz editor Phase 1: questions field type, question list UI with drag reorder, multiple_choice/checkbox/dropdown types with viewer-style options editor, short_answer/worked types, collapsible advanced section (AI grading fields only for types that need it), type change with options preservation. Also split checkbox and dropdown into separate types (cleaner than allowMultiple toggle)."}
{"ts":"2025-12-28T20:10:31Z","type":"note","id":"dp-072","content":"Phase 1 complete (dp-073). Remaining: Phase 2 (dp-074) adds numeric/scale types. Phase 3 (dp-075) adds matching/ordering/grid."}
{"ts":"2025-12-28T20:10:45Z","type":"created","id":"dp-076","title":"AI grading calibration examples UI","issue_type":"feature","priority":2,"description":"Add structured UI for calibration examples in quiz questions that need AI grading (short_answer, worked).\n\nCurrent state:\n- Model Answer and Rubric fields exist as free-text markdown\n- AI grading script (dp-055) supports calibration_examples in grading context\n\nEnhancement:\n- Add 'Grading Examples' section to AI-graded question types\n- Each example: sample answer, score, feedback\n- Helps AI grade consistently with teacher expectations\n- More user-friendly than embedding examples in rubric text\n\nUI design:\n- Collapsible 'Grading Examples' section below Model Answer/Rubric\n- Add/remove example rows\n- Each row: Answer (textarea), Score (number), Feedback (text)\n\nRelated: dp-055 (grading infrastructure)","labels":["phase-2","quiz","editor","grading"]}
{"ts":"2025-12-29T18:29:46Z","type":"closed","id":"dp-074","reason":"Implemented numeric and scale question type editors: numeric type with answer/tolerance/partial-credit-bands UI, scale type with low/high bounds and labels. Also fixed viewer and grading for checkbox/dropdown as separate types (from Phase 1 split)."}
{"ts":"2025-12-29T18:29:53Z","type":"note","id":"dp-072","content":"Phase 2 complete (dp-074). Remaining: Phase 3 (dp-075) adds matching/ordering/grid type editors."}
{"ts":"2025-12-29T18:45:09Z","type":"closed","id":"dp-075","reason":"Implemented grid question type editor with rows/columns list editors and clickable matrix for correct answers. Deprecated and removed matching and ordering types (not supported by Google Forms). Quiz editor now covers: multiple_choice, checkbox, dropdown, short_answer, worked, numeric, scale, grid."}
{"ts":"2025-12-29T18:45:16Z","type":"closed","id":"dp-072","reason":"Quiz editor complete. All supported question types have structured editors: multiple_choice, checkbox, dropdown (options with correct answer selection), short_answer/worked (AI grading fields), numeric (answer + tolerance), scale (bounds + labels), grid (rows/columns + correct answer matrix). Matching and ordering types were removed (not supported by Google Forms)."}
{"ts":"2025-12-29T19:15:06Z","type":"created","id":"dp-077","title":"Quiz card mode: template vs interactive","issue_type":"feature","priority":2,"description":"Design question: Quiz cards currently conflate quiz definition and quiz instance.\n\n**Problem:**\n- For 1-1 tutoring: viewer is interactive (student answers, gets feedback) - this works\n- For bulk grading: quiz card is a template, responses live in separate response cards\n- If someone answers a 'bulk' quiz in viewer, those answers are orphaned\n\n**Proposed solution:**\nAdd `usage: 'template' | 'interactive'` field to quiz schema.\n\nTemplate mode:\n- Viewer shows questions read-only (preview mode)\n- No Submit button, no answer inputs\n- Badge shows 'Template - responses collected via Google Forms'\n- Used when quiz will be distributed for bulk collection\n\nInteractive mode (default):\n- Current behavior for 1-1 tutoring\n- Viewer allows answering, shows feedback\n- Responses stored in quiz card itself\n\n**UI changes needed:**\n- Add usage field to quiz editor (dropdown or toggle)\n- Viewer adapts based on mode\n- Possibly show linked response count for template quizzes\n\n**Open question:**\nShould 1-1 tutoring also separate definition from instance? Could have quiz-template + personal quiz-attempt cards even for 1-1 use. More consistent but adds complexity.","labels":["quiz","design"]}
{"ts":"2025-12-29T19:20:36Z","type":"closed","id":"dp-058","reason":"Implemented ExportForm.gs with exportFormToJSON function that maps Google Forms question types to quiz schema. Handles: multiple_choice, checkbox, dropdown, short_answer, worked, scale, grid. Converts unsupported types (date/time) to short_answer with warnings. Added exportForm entry point to Code.gs and updated README with usage docs."}
{"ts":"2025-12-29T19:22:46Z","type":"closed","id":"dp-059","reason":"Implemented ImportQuiz.gs with createFromJSON and updateFromJSON functions. Maps quiz schema to Google Forms: multiple_choice\u2192radio, checkbox\u2192checkbox, dropdown\u2192list, short_answer\u2192text, worked\u2192paragraph, numeric\u2192text (with warning), scale\u2192scale, grid\u2192grid. Added createForm and updateForm entry points to Code.gs. Updated README with usage docs and type mapping tables."}
{"ts":"2025-12-29T19:26:37Z","type":"created","id":"dp-078","title":"Add date/time question types for Google Forms compatibility","issue_type":"feature","priority":3,"description":"Add date, time, datetime question types to quiz schema for complete Google Forms round-trip compatibility.\n\nCurrently these types convert to short_answer with a warning, which loses type information on re-export.\n\n**Schema additions:**\n- date: { includeYear?: boolean }\n- time: { includeDuration?: boolean }\n- datetime: combination\n\n**UI needed:**\n- Date picker input in quiz viewer\n- Time picker input\n- Editor field configuration\n\n**Grading considerations:**\n- Exact match vs flexible parsing (Dec 7 vs 12/7 vs 2024-12-07)\n- Time zones for datetime\n- Range tolerance (within X days/hours)\n\n**Priority:** Low - these are rare in typical knowledge quizzes, more common in surveys/registration forms.","labels":["quiz","google-forms","enhancement"]}
{"ts":"2025-12-29T20:16:36Z","type":"created","id":"dp-079","title":"Refactor Apps Script to thin wrapper (move translation to notebook JS)","issue_type":"task","priority":2,"description":"Currently ExportForm.gs and ImportQuiz.gs translate between Google Forms API types and our quiz schema (e.g., PARAGRAPH_TEXT \u2192 'worked', LIST \u2192 'dropdown'). This means users need to update their Apps Script copy if our schema changes.\n\n**Proposed change:**\nMake Apps Script a thin wrapper that exports/imports a faithful JSON representation of Google Forms' native structure. Move all translation logic to notebook JavaScript.\n\n**Benefits:**\n- Apps Script becomes very stable (just mirrors Forms API)\n- Users rarely/never need to update their copy\n- Translation logic lives in notebook code we control and auto-updates\n- Easier to maintain and test\n\n**Tasks:**\n1. Design a Forms-native JSON schema that faithfully represents Google Forms items\n2. Refactor ExportForm.gs to output Forms-native JSON (no quiz schema knowledge)\n3. Refactor ImportQuiz.gs to accept Forms-native JSON\n4. Add translation functions to notebook JS (Forms JSON \u2194 quiz schema)\n5. Update documentation","labels":["google-forms"]}
{"ts":"2025-12-29T20:17:12Z","type":"created","id":"dp-080","title":"Set up canonical Apps Script project with copy link for users","issue_type":"task","priority":2,"description":"Replace the current clasp-based setup with a simpler copy-link workflow.\n\n**Current situation:**\nUsers must install clasp, login, create project, push code, deploy, authorize - complex multi-step process with CLI issues.\n\n**Proposed workflow:**\n1. Maintain a canonical Apps Script project (one-time setup by maintainer)\n2. Share with 'Anyone with link can view'\n3. Users visit copy URL \u2192 get their own copy \u2192 authorize \u2192 done\n\n**Tasks:**\n1. Create standalone Apps Script project in maintainer's Google account\n2. Copy all .gs files into it and verify it works\n3. Set sharing to 'Anyone with link can view'\n4. Get the copy URL: https://script.google.com/d/SCRIPT_ID/copy\n5. Update README.md:\n   - Add simple 'Quick Start' section with copy link\n   - Keep clasp instructions as 'Developer Setup' for contributors\n   - Remove clasp as primary onboarding path\n\n**Copy link benefits:**\n- Zero CLI tools required\n- One-click to get own copy\n- Works for non-technical users\n- No npm/node dependency\n\n**Limitation:** Users won't auto-update when we change the script. After dp-079 (thin wrapper refactor), this should be rare.\n\n**Depends on:** dp-079 (thin wrapper refactor should happen first so script is stable before publishing)","labels":["documentation"]}
{"ts":"2025-12-29T21:27:24Z","type":"closed","id":"dp-079","reason":"Superseded: switching from Apps Script to Google Forms REST API. See dp-081."}
{"ts":"2025-12-29T21:27:25Z","type":"closed","id":"dp-080","reason":"Superseded: switching from Apps Script to Google Forms REST API. See dp-081."}
{"ts":"2025-12-29T21:27:41Z","type":"created","id":"dp-081","title":"Implement forms-bridge Node.js CLI using Google Forms REST API","issue_type":"feature","priority":1,"description":"Replace Apps Script + clasp with a Node.js CLI that uses the Google Forms REST API directly.\n\n**Why REST API over Apps Script:**\n- Simpler setup: single OAuth flow vs clasp install/login/deploy\n- More reliable: clasp run often fails with 'Script function not found'\n- Shared codebase: translation layer usable by both CLI and notebook buttons\n- Node.js: can share code with browser JS\n\n**Project structure:**\n```\ntools/forms-bridge/\n\u251c\u2500\u2500 package.json\n\u251c\u2500\u2500 cli.js                  # CLI entry point\n\u251c\u2500\u2500 lib/\n\u2502   \u251c\u2500\u2500 auth.js             # OAuth desktop flow\n\u2502   \u251c\u2500\u2500 forms-api.js        # Forms REST API calls\n\u2502   \u2514\u2500\u2500 translate.js        # Forms JSON \u2194 Quiz schema\n\u2514\u2500\u2500 README.md\n```\n\n**CLI commands:**\n- `forms-bridge auth` - One-time OAuth setup (opens browser)\n- `forms-bridge create quiz.json` - Create Google Form from quiz\n- `forms-bridge export <form-id>` - Export Form structure to JSON\n- `forms-bridge responses <form-id>` - Get responses as JSON/CSV\n\n**OAuth scopes:**\n- https://www.googleapis.com/auth/forms.body\n- https://www.googleapis.com/auth/forms.responses.readonly\n\n**Trade-off:** REST API cannot push grades back to Forms (only Apps Script can). This is acceptable - grades export to CSV for school gradebook instead.\n\n**Dependencies:** googleapis npm package, google-auth-library\n\nSee design doc: dev/planning/features/google-forms-integration.md","labels":["google-forms","phase-1"]}
{"ts":"2025-12-29T21:27:56Z","type":"note","id":"dp-064","content":"UPDATE: Now using forms-bridge CLI (dp-081) instead of clasp. Workflow remains the same but calls forms-bridge commands instead."}
{"ts":"2025-12-29T21:27:56Z","type":"note","id":"dp-065","content":"UPDATE: Now using forms-bridge CLI (dp-081) instead of clasp. Workflow remains the same but calls forms-bridge commands instead."}
{"ts":"2025-12-29T21:27:56Z","type":"note","id":"dp-066","content":"UPDATE: Grade push-back to Forms is deferred. REST API cannot update grades on existing responses. Workflow now exports grades to CSV for school gradebook instead. See design doc Grade Push-Back section."}
{"ts":"2025-12-30T18:44:39Z","type":"closed","id":"dp-081","reason":"Forms-bridge CLI feature-complete: auth, export, create, responses commands all working. Round-trip tested."}
{"ts":"2025-12-30T18:44:56Z","type":"created","id":"dp-082","title":"Response viewer with cohort summary and question-level grading","issue_type":"feature","priority":1,"description":"Implement response cards and summary viewer for quiz responses with cohort organization.\n\n**Storage structure:**\n```\nquiz-responses/\n\u251c\u2500\u2500 class-8a/                    # Subsection per cohort\n\u2502   \u251c\u2500\u2500 _summary.response.json   # Cohort summary card\n\u2502   \u251c\u2500\u2500 s001.response.json       # Individual student cards\n\u2502   \u2514\u2500\u2500 s002.response.json\n\u2514\u2500\u2500 class-8b/\n    \u2514\u2500\u2500 ...\n```\n\n**Summary card features:**\n- Cohort overview: submitted count, average score, date\n- Collapsible question sections (like Google Forms Question view)\n- Each question expands to show all student answers side-by-side\n- Auto-graded questions show % correct\n- Open-ended questions show avg score and grading status\n- \"Launch Bulk Grading\" button for AI grading integration\n\n**Individual response cards:**\n- Full student submission view\n- Shows all answers with auto-grade, Claude grade, teacher grade\n- Edit UI for teacher grade adjustments\n- Track reviewed/unreviewed status\n\n**Design rationale:**\n- Mirrors Google Forms UI teachers already know (Summary, Question, Individual views)\n- Question-level view aligns with batch grading (grade all Q3s together with same rubric)\n- Subsections per cohort handles same quiz given to multiple classes\n\nSee design doc: dev/planning/features/google-forms-integration.md (Summary Response Card section)","labels":["phase-3","grading","google-forms"]}
{"ts":"2025-12-30T22:02:29Z","type":"created","id":"dp-083","title":"Dynamic quiz summary aggregation","issue_type":"feature","priority":2,"description":"Summary cards as lightweight view definitions that compute data from response cards dynamically, with bidirectional grade sync.\n\n## Problem\nStatic summary files get out of sync with individual response cards. Manual updates are error-prone.\n\n## Proposed Solution\nSummary file stores only metadata (quizId, cohort, responsePattern), not actual answer/grade data:\n```json\n{\n  \"quizId\": \"french-gcse-comprehension\",\n  \"cohort\": \"10A Morning\",\n  \"responsePattern\": \"10a-morning/*.response.json\"\n}\n```\n\n## Implementation\n1. Add `computeSummaryData(summaryCard, allCards)` function that aggregates response data\n2. Summary viewer calls this on render (data already in memory, no filesystem watching)\n3. Grade edits in summary view trigger `saveItemToFile()` on individual response cards\n4. After save, `render()` naturally updates the summary\n\n## Benefits\n- Single source of truth (response cards)\n- Bidirectional sync is automatic (summary reads from responses, edits write to responses)\n- No file watching complexity\n- Summary file is lightweight (saved query, not data store)\n- Can still persist summary-level metadata (cohort name, etc.)","labels":["enhancement","quiz-system"]}
{"ts":"2025-12-30T22:13:54Z","type":"closed","id":"dp-083","reason":"Implemented dynamic summary aggregation. Summary cards now store only metadata (quizId, cohort) and compute all data from response cards in the same folder. Added inline grade editing in summary viewer that writes directly to response cards. Bidirectional sync is automatic - changes to response cards are reflected immediately when summary re-renders."}
{"ts":"2025-12-30T22:23:03Z","type":"created","id":"dp-084","title":"Extension registry should not be stored in settings.yaml","issue_type":"bug","priority":2,"description":"Currently, the extension registry is stored in .notebook/settings.yaml. This causes a problem: once a user saves their settings (even just to change the notebook title), the extensions are frozen and won't pick up new defaults added later.\n\nExample: Added .response-summary.json extension to defaults, but existing notebooks with saved settings didn't see it because their settings.yaml had an older copy of the extensions.\n\nOptions to consider:\n1. Don't store extensions in settings at all - always use defaults (simplest)\n2. Store only user overrides/additions, merge with defaults at runtime\n3. Separate extensions into their own file (.notebook/extensions.yaml)\n\nOption 1 is probably fine for now since extension customization is rare.","labels":["architecture"]}
{"ts":"2025-12-31T12:51:15Z","type":"created","id":"dp-085","title":"Progressive disclosure for nested directories","issue_type":"feature","priority":2,"description":"Implement collapsible subdirectories with progressive disclosure as described in dev/planning/vision/collaborative-workspaces.md.\n\n**Current state:** Sections (top-level dirs) with one level of subsections, fully expanded.\n\n**Target:**\n- Sections visible\n- First-level subdirectories visible but collapsed by default\n- Deeper levels expand on click\n- Remember expansion state per-notebook (localStorage)\n- Visual indentation for nested items\n\n**Optional enhancements:**\n- Expand all / collapse all controls\n- Breadcrumbs when deeply nested\n\nThis discourages excessive nesting while supporting it when needed. Prerequisite for teacher workspace use case.","labels":["enhancement","ui"]}
{"ts":"2025-12-31T12:51:40Z","type":"created","id":"dp-086","title":"Tag filtering for cross-cutting navigation","issue_type":"feature","priority":2,"description":"Add tag-based filtering as described in dev/planning/vision/collaborative-workspaces.md.\n\n**Current state:** Cards have a tags field with badge rendering, but no filtering or navigation.\n\n**Target:**\n- Click a tag to filter current view to items with that tag\n- Clear filter to return to full view\n\n**Open UI questions (may need design spike):**\n- Modal filtering (click tag \u2192 filtered view) vs additive (build up filters)\n- Where does tag list live? Sidebar? Top bar? Per-section?\n- How do tags interact with directory navigation?\n\n**Future enhancements:**\n- Tag sidebar/panel showing all tags with counts\n- Virtual collections based on tag queries\n- Status tags with semantic meaning (draft, reviewed, exported)","labels":["enhancement","ui"]}
{"ts":"2025-12-31T12:51:40Z","type":"created","id":"dp-087","title":"Space initialization CLI (space init)","issue_type":"feature","priority":2,"description":"Implement guided initialization for new spaces as described in dev/planning/vision/collaborative-workspaces.md.\n\n**Concept:** Like npm init or create-react-app but for collaborative workspaces.\n\n**Example flow for teaching space:**\n- Teacher name, subject, school year\n- Classes to set up (names, student counts)\n- Import student rosters (CSV upload or skip)\n- Google Forms integration (OAuth or skip)\n- API keys for AI grading (enter or skip)\n\n**What gets generated:**\n- .notebook/settings.yaml with theme, sections\n- .notebook/theme.css (domain-appropriate)\n- CLAUDE.md personalized with class names, workflow instructions\n- Directory structure for classes\n- External roster/secrets storage (~/.spaces/)\n\n**Key principles:**\n- Secrets stay external (git-safe)\n- Progressive setup (skip and configure later)\n- Sensible defaults based on template\n\n**Implementation options:**\n- CLI wizard with interactive prompts\n- Browser wizard (first-run modal)\n- Hybrid approach\n\nDepends on renaming decision (dp-088) for final command name.","labels":["enhancement","cli"]}
{"ts":"2025-12-31T12:51:40Z","type":"created","id":"dp-088","title":"Complete teacher workspace example","issue_type":"task","priority":2,"description":"Build out a realistic teacher workspace example to validate the architecture as described in dev/planning/vision/collaborative-workspaces.md.\n\n**Current state:** examples/tutor-notebook exists with basic quiz functionality and french-gcse demo.\n\n**Target:** A comprehensive teacher workspace demonstrating:\n- Multiple classes with nested structure\n- Quizzes, responses, summaries\n- Lesson plans (may need template)\n- Student progress tracking\n- Realistic CLAUDE.md with teaching workflows\n- Custom skills for grading, report generation\n\nThis serves as the proving ground for:\n- Progressive disclosure navigation (dp-085)\n- Tag filtering (dp-086)\n- Framework + application architecture\n\nShould be realistic enough that a teacher could fork it.","labels":["documentation","example"]}
{"ts":"2025-12-31T12:52:06Z","type":"created","id":"dp-089","title":"Decide on project renaming/rebranding","issue_type":"task","priority":3,"description":"Research Notebook no longer captures the scope. Need to decide on new name as discussed in dev/planning/vision/collaborative-workspaces.md.\n\n**Current direction:** 'Space' theme playing on coworking spaces.\n\n**Options considered:**\n- [Domain] Space (Research Space, Teaching Space) - framework is 'Space', apps are domain-specific\n- Cowork - explicit collaboration\n- Studio - creative, professional\n- Project Notebook - generic but bland\n\n**Decision criteria:**\n- Captures human-AI collaboration\n- Works for framework + application model\n- Not overused (workspace, canvas)\n- Clear value proposition\n\n**Timing:** Defer until teacher workspace is proven. When we have 2-3 domain examples working, the right name may become clearer.\n\n**Implications:**\n- CLI command name (notebook \u2192 space?)\n- Repo rename\n- Documentation updates\n- Example notebook names","labels":["decision","branding"]}
{"ts":"2025-12-31T12:52:06Z","type":"created","id":"dp-090","title":"JavaScript template extensions for custom card types","issue_type":"feature","priority":4,"description":"Allow power users to define custom dynamic card types via JavaScript as described in dev/planning/vision/collaborative-workspaces.md.\n\n**Current state:** Card types defined by YAML templates. Some types (quiz-response-summary) require JS in core for dynamic behavior.\n\n**Target:** Templates can reference JS files for custom viewer/editor rendering:\n```yaml\n# report-card.template.yaml\nviewer:\n  layout: custom\n  script: report-card-viewer.js\n```\n\n**Benefits:**\n- System built from primitives users can extend\n- Domain-specific types without core changes\n- Inspectable (templates are just files)\n\n**Reality check:** Few users will create custom types, but architecture remains valuable for clean separation.\n\n**Priority:** Backlog - current template system handles most needs. Implement when a concrete use case demands it.","labels":["enhancement","architecture"]}
{"ts":"2025-12-31T12:52:06Z","type":"created","id":"dp-091","title":"Document framework + application architecture","issue_type":"task","priority":3,"description":"Document the two-layer model described in dev/planning/vision/collaborative-workspaces.md for contributors and power users.\n\n**Framework layer:**\n- Card rendering, viewing, editing\n- Filesystem sync, directory navigation\n- Template system, extension registry\n- Generic UI components\n\n**Application layer:**\n- Custom card types\n- Default styling/theme\n- Cookie-cutter directory layout\n- Template CLAUDE.md\n- Custom skills\n- Default permissions, API keys, MCP access\n\n**Documentation should cover:**\n- How to create a new application template\n- What files define an application\n- How CLAUDE.md customizes behavior\n- How skills integrate\n- Example: anatomy of the Teacher Classbook application\n\nDepends on teacher workspace example (dp-088) being complete enough to document.","labels":["documentation"]}
{"ts":"2025-12-31T12:52:16Z","type":"updated","id":"dp-087","depends_on":["dp-089"],"reason":"Added dependencies: dp-089"}
{"ts":"2025-12-31T12:52:16Z","type":"updated","id":"dp-091","depends_on":["dp-088"],"reason":"Added dependencies: dp-088"}
{"ts":"2025-12-31T14:33:09Z","type":"created","id":"dp-092","title":"Self-contained card type modules","issue_type":"task","priority":2,"description":"Extract card types into self-contained module folders (template.yaml + styles.css + optional index.js) to create a clear framework/extension boundary. Benefits: easier to understand individual card types, enables domain-specific bundles, less forbidding than sprawling core. See vision doc section 'Future: Self-Contained Card Type Modules'.","depends_on":["dp-088"],"labels":["architecture","future"]}
{"ts":"2025-12-31T14:44:58Z","type":"note","id":"dp-085","content":"Implementation complete. Changes made:\n1. loadSectionItems now supports arbitrary directory depth (builds full subdirPath)\n2. Added expandedSubdirs state management with localStorage persistence\n3. New buildSubdirTree() function converts flat items to hierarchical tree\n4. New renderSubdirNode() renders collapsible subdirectory nodes with toggle\n5. CSS added for .subdir-node, .subdir-header, .subdir-toggle with depth-based indentation\n6. Added escapeJsAttr() helper for safe onclick handlers\n7. Test structure created in examples/demo-classroom with 3-level nesting"}
{"ts":"2025-12-31T14:45:29Z","type":"closed","id":"dp-085","reason":"Done - Implemented progressive disclosure for nested directories. Subdirectories now render as collapsible nodes at arbitrary depth, collapsed by default, with expansion state persisted per-notebook."}
{"ts":"2025-12-31T14:51:00Z","type":"created","id":"dp-093","title":"Unify section and _subdir into single path field","issue_type":"task","priority":2,"description":"Refactor the current section + _subdir split into a unified path approach. Currently cards have separate 'section' (top-level only) and '_subdir' (nested path) fields. With progressive disclosure supporting arbitrary depth, this distinction is awkward.\n\nProposed: Replace with single '_path' field storing full relative path from notebook root (e.g., 'research/responses/batch1'). Derive section (first segment) when needed for UI features like visibility toggle, rename, delete.\n\nChanges needed:\n- Rename _subdir to _path, store full path\n- Update loadSectionItems to build full path\n- Update editor section/location selector\n- Update saveCard path handling\n- Keep section.id as 'section-{firstSegment}' for compatibility\n\nBenefits: Simpler mental model, cleaner editor UX, aligns with filesystem reality.","depends_on":["dp-085"],"labels":["architecture","cleanup"]}
{"ts":"2025-12-31T15:36:27Z","type":"closed","id":"dp-093","reason":"Done - replaced _subdir with unified _path field storing full path from notebook root. Added getSubdirFromPath/getSectionFromPath helpers. Updated loading, saving, editor, rendering, and sorting code."}
{"ts":"2025-12-31T15:52:36Z","type":"updated","id":"dp-092","depends_on":[],"reason":"Removed dependencies: dp-088"}
{"ts":"2025-12-31T15:52:36Z","type":"updated","id":"dp-088","depends_on":["dp-092"],"reason":"Added dependencies: dp-092"}
{"ts":"2025-12-31T16:02:42Z","type":"created","id":"dp-094","title":"Create js/framework.js utility module","issue_type":"task","priority":2,"description":"Create ES module exporting framework utilities for card type modules to import:\n- escapeHtml, truncateText, formatDate\n- findCardById, findCardsByType, getSection\n- marked (re-export), hljs (re-export)\n- saveCard, refreshViewer\n\nThis is Phase 1a of dp-092 (card type modules). See dev/planning/architecture/card-type-modules.md","depends_on":["dp-092"]}
{"ts":"2025-12-31T16:02:50Z","type":"created","id":"dp-095","title":"Add card-types/ directory structure and module loader","issue_type":"task","priority":2,"description":"Create the card-types/ directory structure and loadCardTypeModules() function:\n\n1. Create card-types/ directory with index.json manifest\n2. Add loadCardTypeModules() to TEMPLATE_SYSTEM section:\n   - Fetch manifest from /card-types/index.json\n   - For each module, fetch template.yaml, styles.css, index.js\n   - Register template in templateRegistry\n   - Inject CSS into <style id=\"card-type-styles\"> with @layer templates\n   - Dynamic import JS modules, register in cardTypeModules map\n3. Update fetchDefaultTemplates() to use new loader\n\nThis is Phase 1b of dp-092. See dev/planning/architecture/card-type-modules.md","depends_on":["dp-094"]}
{"ts":"2025-12-31T16:03:01Z","type":"created","id":"dp-096","title":"Extract simple card types (note, bookmark, image)","issue_type":"task","priority":2,"description":"Extract card types that have NO custom JS - just template.yaml + styles.css:\n\n- note: template.yaml + styles.css\n- bookmark: template.yaml + styles.css  \n- image: template.yaml + styles.css\n\nFor each:\n1. Move template from defaults/templates/X.yaml to card-types/X/template.yaml\n2. Extract CSS from app.css @layer templates blocks to card-types/X/styles.css\n3. Verify loading works via the new module loader\n\nThis validates CSS extraction and loading without JS complexity. Phase 2 of dp-092.","depends_on":["dp-095"]}
{"ts":"2025-12-31T16:03:01Z","type":"created","id":"dp-097","title":"Create render function registry for card type dispatch","issue_type":"task","priority":2,"description":"Create registry-based dispatch for custom render functions:\n\n1. Create cardTypeRenderers map: { 'quiz-response-summary': { preview: fn, viewer: fn } }\n2. Update renderCardPreview() to check registry before switch statement\n3. Update renderViewerContent() similarly\n4. Module loader should register functions from index.js exports into this map\n\nThis enables card type JS modules to provide custom renderers. Phase 3 of dp-092.","depends_on":["dp-095"]}
{"ts":"2025-12-31T16:03:13Z","type":"created","id":"dp-098","title":"Extract code card type module","issue_type":"task","priority":2,"description":"Extract code card type to card-types/code/:\n\n- template.yaml (from defaults/templates/)\n- styles.css (from app.css @layer templates)\n- index.js if needed for Pyodide integration hooks\n\nNote: Most Pyodide logic may stay in core since it's runtime infrastructure, not card-specific rendering. Evaluate what belongs in the module vs core.\n\nPhase 4a of dp-092.","depends_on":["dp-097"]}
{"ts":"2025-12-31T16:03:13Z","type":"created","id":"dp-099","title":"Extract quiz card type module","issue_type":"task","priority":2,"description":"Extract quiz card type to card-types/quiz/:\n\n- template.yaml\n- styles.css\n- index.js with renderQuizPreview(), renderQuizViewer(), quiz-specific actions\n\nFunctions to extract (~200 lines):\n- renderQuizPreview()\n- renderQuizViewer() \n- Quiz editor actions\n\nPhase 4b of dp-092.","depends_on":["dp-097"]}
{"ts":"2025-12-31T16:03:13Z","type":"created","id":"dp-100","title":"Extract quiz-response card type module","issue_type":"task","priority":2,"description":"Extract quiz-response card type to card-types/quiz-response/:\n\n- template.yaml\n- styles.css  \n- index.js with renderQuizResponsePreview(), renderQuizResponseViewer(), grading logic\n\nFunctions to extract (~300 lines):\n- renderQuizResponsePreview()\n- renderQuizResponseViewer()\n- Grade editing/submission handlers\n\nPhase 4c of dp-092.","depends_on":["dp-097"]}
{"ts":"2025-12-31T16:03:26Z","type":"created","id":"dp-101","title":"Extract quiz-response-summary card type module","issue_type":"task","priority":2,"description":"Extract quiz-response-summary card type to card-types/quiz-response-summary/:\n\n- template.yaml\n- styles.css\n- index.js with all summary rendering and grading UI logic\n\nFunctions to extract (~500 lines):\n- computeSummaryData()\n- renderQuizResponseSummaryPreview()\n- renderQuizResponseSummaryViewer()\n- renderSummaryQuestionSection()\n- renderSummaryAnswerRow()\n- submitSummaryGrade()\n- approveSummaryClaudeGrade()\n- openResponseFromSummary()\n- refreshSummaryViewer()\n\nThis is the most complex extraction. Phase 4d of dp-092.","depends_on":["dp-097"]}
{"ts":"2025-12-31T16:03:26Z","type":"created","id":"dp-102","title":"Add instance override resolution for card types","issue_type":"task","priority":2,"description":"Enable workspace instances to override card types:\n\n1. Update loader to check .notebook/card-types/X/ first (via filesystem API)\n2. Merge with core modules (instance wins for same-named type)\n3. Add 'Modified from default' indicator for customized types in system UI\n\nResolution order: .notebook/card-types/X/ \u2192 card-types/X/\n\nPhase 5 of dp-092.","depends_on":["dp-100"]}
{"ts":"2025-12-31T16:03:26Z","type":"created","id":"dp-103","title":"Cleanup: finalize card type module migration","issue_type":"task","priority":2,"description":"Final cleanup after all card types extracted:\n\n1. Delete defaults/templates/*.yaml (moved to card-types/)\n2. Remove extracted CSS from app.css (~1900 lines)\n3. Remove extracted JS functions from app.js\n4. Update CLAUDE.md documentation for new architecture\n5. Update generate_index.py if needed for new file locations\n\nPhase 6 of dp-092.","depends_on":["dp-101"]}
{"ts":"2025-12-31T16:03:42Z","type":"updated","id":"dp-103","depends_on":[],"reason":"Removed dependencies: dp-101"}
{"ts":"2025-12-31T16:03:42Z","type":"updated","id":"dp-103","depends_on":["dp-102"],"reason":"Added dependencies: dp-102"}
{"ts":"2025-12-31T16:03:49Z","type":"note","id":"dp-092","content":"Implementation broken into sub-issues:\n- dp-094: Create js/framework.js\n- dp-095: Module loader + directory structure\n- dp-096: Extract simple card types (note, bookmark, image)\n- dp-097: Render function registry\n- dp-098: Extract code card type\n- dp-099: Extract quiz card type\n- dp-100: Extract quiz-response card type\n- dp-101: Extract quiz-response-summary card type\n- dp-102: Instance override resolution\n- dp-103: Final cleanup\n\nDesign doc: dev/planning/architecture/card-type-modules.md"}
{"ts":"2025-12-31T16:56:11Z","type":"closed","id":"dp-094","reason":"Created js/framework.js with exports for card type modules. Added window.notebook API registration in app.js."}
{"ts":"2025-12-31T16:59:10Z","type":"closed","id":"dp-095","reason":"Added card-types/ directory with index.json manifest, loadCardTypeModules() function, CSS injection via injectCardTypeStyles(), and dynamic ES module imports. Integrated with fetchDefaultTemplates() so card-types take precedence. Added getCardTypeModule to window.notebook and framework.js."}
{"ts":"2025-12-31T17:01:50Z","type":"closed","id":"dp-096","reason":"Extracted note, bookmark, and image card types to card-types/ directory. Each has template.yaml, note and bookmark have styles.css. Updated card-types/index.json manifest and removed these from defaults/templates/index.json."}
{"ts":"2025-12-31T17:05:28Z","type":"closed","id":"dp-097","reason":"Created cardTypeRenderers registry map, updated renderCardPreview() and renderViewerContent() to check registry before switch statements, updated module loader to register render functions from index.js exports (renderPreview, renderViewer). Added getCardTypeRenderer to window.notebook API."}
{"ts":"2025-12-31T17:12:57Z","type":"closed","id":"dp-098","reason":"Extracted code card type to card-types/code/ with template.yaml and styles.css. No index.js needed as generic split-pane renderers handle code fields via type checking."}
{"ts":"2025-12-31T17:17:01Z","type":"closed","id":"dp-099","reason":"Extracted quiz card type to card-types/quiz/ with template.yaml and styles.css (~800 lines of CSS). Render functions remain in app.js for now due to complexity - they work via existing switch statement dispatch."}
{"ts":"2025-12-31T17:18:50Z","type":"closed","id":"dp-100","reason":"Extracted quiz-response card type to card-types/quiz-response/ with template.yaml and styles.css (~450 lines). Render functions remain in app.js."}
{"ts":"2025-12-31T17:20:36Z","type":"closed","id":"dp-101","reason":"Extracted quiz-response-summary card type to card-types/quiz-response-summary/ with template.yaml and styles.css (~380 lines). Render functions remain in app.js due to complexity."}
{"ts":"2025-12-31T17:24:33Z","type":"created","id":"dp-104","title":"Extract card-type JavaScript to module index.js files","issue_type":"task","priority":2,"description":"Extract card-type-specific JavaScript from app.js to index.js files in each module.\n\n**quiz** (~600 lines):\n- renderQuizPreview(), renderQuizViewer()\n- renderQuizQuestion(), renderQuizAnswerArea()\n- Interaction handlers: selectQuizOption, toggleQuizCheckbox, updateQuizAnswer, selectScaleOption, selectGridOption\n- submitQuiz(), retakeQuiz(), gradeQuizAttempt(), saveQuizAttempt(), submitQuizReview()\n\n**quiz-response** (~300 lines):\n- renderQuizResponsePreview(), renderQuizResponseViewer()\n- renderTeacherGradeUI()\n- Grade submission handlers\n\n**quiz-response-summary** (~500 lines):\n- computeSummaryData()\n- renderQuizResponseSummaryPreview(), renderQuizResponseSummaryViewer()\n- renderSummaryQuestionSection(), renderSummaryAnswerRow()\n- submitSummaryGrade(), approveSummaryClaudeGrade()\n- openResponseFromSummary(), refreshSummaryViewer()\n\n**Pattern**: Modules export renderPreview/renderViewer functions. Event handlers need to be registered on window.* for onclick attributes to work.\n\nDepends on framework.js providing necessary utilities (escapeHtml, findCardById, saveCard, etc.).","depends_on":["dp-101"]}
{"ts":"2025-12-31T17:26:09Z","type":"note","id":"dp-104","content":"Also include code card JavaScript: runViewerCode() and runEditorCode() - these are card-type specific 'Run' button handlers that execute Python code. Design doc missed this."}
{"ts":"2025-12-31T17:43:04Z","type":"closed","id":"dp-103","reason":"Completed: deleted 7 migrated templates from defaults/templates/, removed 1842 lines of CSS from app.css (4060\u21922218, 45% reduction), updated CLAUDE.md documentation"}
{"ts":"2025-12-31T17:43:20Z","type":"note","id":"dp-092","content":"Phase 1 complete: All 7 card types extracted to card-types/ with template.yaml and styles.css. Cleanup done (dp-103). Remaining: dp-102 (instance overrides) and dp-104 (JS extraction) are enhancements for later."}
{"ts":"2025-12-31T18:03:53Z","type":"note","id":"dp-104","content":"Implemented quiz, quiz-response, quiz-response-summary modules. Code card functions (runViewerCode, runEditorCode) kept in app.js since they're tightly integrated with Pyodide runtime infrastructure - not card-type-specific UI but global execution infrastructure."}
{"ts":"2025-12-31T18:53:32Z","type":"closed","id":"dp-104","reason":"--reason"}
{"ts":"2025-12-31T19:24:10Z","type":"note","id":"dp-084","content":"REVISED PLAN: Card types should own their extensions. (1) Each template.yaml declares extensions section (2) Settings gets card_types list (optional, defaults to all) (3) Loader builds extensionRegistry dynamically from enabled types (4) Remove getDefaultExtensionRegistry() (5) Deprecate hidden_templates. Implementation: Add extensions to 7 card-type templates, update loadCardTypeModules() to aggregate with conflict detection, remove extensions from SETTINGS_SCHEMA."}
{"ts":"2025-12-31T19:35:43Z","type":"closed","id":"dp-084","reason":"--note"}
{"ts":"2025-12-31T19:39:38Z","type":"note","id":"dp-084","content":"BUG FIX: loadFromFilesystem() was calling loadExtensionRegistry() before loadTemplates(). Since cardTypeExtensions is populated by loadCardTypeModules() (called via loadTemplates \u2192 fetchDefaultTemplates), the extension registry was empty. Fixed by swapping the order."}
{"ts":"2026-01-01T12:09:30Z","type":"created","id":"dp-105","title":"Lazy-load card types based on settings","issue_type":"task","priority":2,"description":"Add enabled_templates setting to control which card types are available per-notebook, with lazy loading for modularity. Default: note, bookmark, code. In-use types auto-enabled. New 'templates' editor field type with checkboxes.","labels":["enhancement"]}
{"ts":"2026-01-01T12:30:15Z","type":"closed","id":"dp-105","reason":"implemented"}
